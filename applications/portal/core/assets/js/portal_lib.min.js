(function(){function n(n,t){return n.set(t[0],t[1]),n}function t(n,t){return n.add(t),n}function r(n,t,r){switch(r.length){case 0:return n.call(t);case 1:return n.call(t,r[0]);case 2:return n.call(t,r[0],r[1]);case 3:return n.call(t,r[0],r[1],r[2])}return n.apply(t,r)}function e(n,t,r,e){for(var u=-1,o=n.length;++u<o;){var i=n[u];t(e,i,r(i),n)}return e}function u(n,t){for(var r=-1,e=n.length;++r<e&&!1!==t(n[r],r,n););return n}function o(n,t){for(var r=-1,e=n.length;++r<e;)if(!t(n[r],r,n))return!1;return!0}function i(n,t){for(var r=-1,e=n.length,u=-1,o=[];++r<e;){var i=n[r];t(i,r,n)&&(o[++u]=i)}return o}function f(n,t){return!!n.length&&-1<d(n,t,0)}function c(n,t,r){for(var e=-1,u=n.length;++e<u;)if(r(t,n[e]))return!0;return!1}function a(n,t){for(var r=-1,e=n.length,u=Array(e);++r<e;)u[r]=t(n[r],r,n);return u}function l(n,t){for(var r=-1,e=t.length,u=n.length;++r<e;)n[u+r]=t[r];return n}function s(n,t,r,e){var u=-1,o=n.length;for(e&&o&&(r=n[++u]);++u<o;)r=t(r,n[u],u,n);return r}function h(n,t,r,e){var u=n.length;for(e&&u&&(r=n[--u]);u--;)r=t(r,n[u],u,n);return r}function p(n,t){for(var r=-1,e=n.length;++r<e;)if(t(n[r],r,n))return!0;return!1}function _(n,t,r){for(var e=-1,u=n.length;++e<u;){var o=n[e],i=t(o);if(null!=i&&(f===Z?i===i:r(i,f)))var f=i,c=o}return c}function g(n,t,r,e){var u;return r(n,function(n,r,o){return t(n,r,o)?(u=e?r:n,!1):void 0}),u}function v(n,t,r){for(var e=n.length,u=r?e:-1;r?u--:++u<e;)if(t(n[u],u,n))return u;return-1}function d(n,t,r){if(t!==t)return B(n,r);--r;for(var e=n.length;++r<e;)if(n[r]===t)return r;return-1}function y(n,t,r,e,u){return u(n,function(n,u,o){r=e?(e=!1,n):t(r,n,u,o)}),r}function b(n,t){var r=n.length;for(n.sort(t);r--;)n[r]=n[r].c;return n}function x(n,t){for(var r,e=-1,u=n.length;++e<u;){var o=t(n[e]);o!==Z&&(r=r===Z?o:r+o)}return r}function m(n,t){for(var r=-1,e=Array(n);++r<n;)e[r]=t(r);return e}function j(n,t){return a(t,function(t){return[t,n[t]]})}function w(n){return function(t){return n(t)}}function A(n,t){return a(t,function(t){return n[t]})}function O(n,t){for(var r=-1,e=n.length;++r<e&&-1<d(t,n[r],0););return r}function k(n,t){for(var r=n.length;r--&&-1<d(t,n[r],0););return r}function E(n){return n&&n.Object===Object?n:null}function I(n,t){if(n!==t){var r=null===n,e=n===Z,u=n===n,o=null===t,i=t===Z,f=t===t;if(n>t&&!o||!u||r&&!i&&f||e&&f)return 1;if(t>n&&!r||!f||o&&!e&&u||i&&u)return-1}return 0}function S(n){return Un[n]}function R(n){return zn[n]}function W(n){return"\\"+$n[n]}function B(n,t,r){var e=n.length;for(t+=r?0:-1;r?t--:++t<e;){var u=n[t];if(u!==u)return t}return-1}function C(n){var t=!1;if(null!=n&&"function"!=typeof n.toString)try{t=!!(n+"")}catch(r){}return t}function U(n,t){return n="number"==typeof n||yn.test(n)?+n:-1,n>-1&&0==n%1&&(null==t?9007199254740991:t)>n}function z(n){for(var t,r=[];!(t=n.next()).done;)r.push(t.value);return r}function M(n){var t=-1,r=Array(n.size);return n.forEach(function(n,e){r[++t]=[e,n]}),r}function L(n,t){for(var r=-1,e=n.length,u=-1,o=[];++r<e;){var i=n[r];(i===t||"__lodash_placeholder__"===i)&&(n[r]="__lodash_placeholder__",o[++u]=r)}return o}function $(n){var t=-1,r=Array(n.size);return n.forEach(function(n){r[++t]=n}),r}function F(n){if(!n||!En.test(n))return n.length;for(var t=kn.lastIndex=0;kn.test(n);)t++;return t}function N(n){return Mn[n]}function D(E){function yn(n){if(we(n)&&!Zo(n)&&!(n instanceof An)){if(n instanceof wn)return n;if(lu.call(n,"__wrapped__"))return Pr(n)}return new wn(n)}function jn(){}function wn(n,t){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=Z}function An(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Un(){}function zn(n){var t=-1,r=n?n.length:0;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}function Mn(n){var t=-1,r=n?n.length:0;for(this.__data__=new zn;++t<r;)this.push(n[t])}function Ln(n,t){var r=n.__data__;return $r(t)?(r=r.__data__,"__lodash_hash_undefined__"===("string"==typeof t?r.string:r.hash)[t]):r.has(t)}function $n(n){var t=-1,r=n?n.length:0;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}function Dn(n,t){var r=Pn(n,t);return 0>r?!1:(r==n.length-1?n.pop():Iu.call(n,r,1),!0)}function Zn(n,t){var r=Pn(n,t);return 0>r?Z:n[r][1]}function Pn(n,t){for(var r=n.length;r--;)if(pe(n[r][0],t))return r;return-1}function Tn(n,t,r){var e=Pn(n,t);0>e?n.push([t,r]):n[e][1]=r}function Kn(n,t,r,e){return n===Z||pe(n,cu[r])&&!lu.call(e,r)?t:n}function Gn(n,t,r){(r!==Z&&!pe(n[t],r)||"number"==typeof t&&r===Z&&!(t in n))&&(n[t]=r)}function Yn(n,t,r){var e=n[t];lu.call(n,t)&&pe(e,r)&&(r!==Z||t in n)||(n[t]=r)}function Hn(n,t,r,e){return Hu(n,function(n,u,o){t(e,n,r(n),o)}),e}function Qn(n,t){return n&&nr(t,De(t),n)}function Xn(n,t){for(var r=-1,e=null==n,u=t.length,o=Array(u);++r<u;)o[r]=e?Z:$e(n,t[r]);return o}function nt(n){return de(n)?n:[]}function tt(n){return"function"==typeof n?n:Ye}function rt(n){return Zo(n)?n:qr(n)}function et(n,t,r){return n===n&&(r!==Z&&(n=n>r?r:n),t!==Z&&(n=t>n?t:n)),n}function ut(n,t,r,e,o,i){var f;if(r&&(f=o?r(n,e,o,i):r(n)),f!==Z)return f;if(!je(n))return n;if(e=Zo(n)){if(f=Br(n),!t)return Xt(n,f)}else{var c=Rr(n),a="[object Function]"==c||"[object GeneratorFunction]"==c;if(qo(n))return Jt(n,t);if("[object Object]"==c||"[object Arguments]"==c||a&&!o){if(C(n))return o?n:{};if(f=Cr(a?{}:n),!t)return rr(n,Qn(f,n))}else{if(!Cn[c])return o?n:{};f=Ur(n,c,t)}}return i||(i=new $n),(o=i.get(n))?o:(i.set(n,f),(e?u:pt)(n,function(e,u){Yn(f,u,ut(e,t,r,u,n,i))}),e?f:rr(n,f))}function ot(n){var t=De(n),r=t.length;return function(e){if(null==e)return!r;for(var u=r;u--;){var o=t[u],i=n[o],f=e[o];if(f===Z&&!(o in Object(e))||!i(f))return!1}return!0}}function it(n){return je(n)?Ou(n):{}}function ft(n,t,r){if("function"!=typeof n)throw new iu("Expected a function");return Eu(function(){n.apply(Z,r)},t)}function ct(n,t,r,e){var u=-1,o=f,i=!0,l=n.length,s=[],h=t.length;if(!l)return s;r&&(t=a(t,w(r))),e?(o=c,i=!1):t.length>=200&&(o=Ln,i=!1,t=new Mn(t));n:for(;++u<l;){var p=n[u],_=r?r(p):p;if(i&&_===_){for(var g=h;g--;)if(t[g]===_)continue n;s.push(p)}else o(t,_,e)||s.push(p)}return s}function at(n,t){var r=!0;return Hu(n,function(n,e,u){return r=!!t(n,e,u)}),r}function lt(n,t){var r=[];return Hu(n,function(n,e,u){t(n,e,u)&&r.push(n)}),r}function st(n,t,r,e){e||(e=[]);for(var u=-1,o=n.length;++u<o;){var i=n[u];t>0&&de(i)&&(r||Zo(i)||ge(i))?t>1?st(i,t-1,r,e):l(e,i):r||(e[e.length]=i)}return e}function ht(n,t){return null==n?n:Xu(n,t,Ze)}function pt(n,t){return n&&Xu(n,t,De)}function _t(n,t){return n&&no(n,t,De)}function gt(n,t){return i(t,function(t){return be(n[t])})}function vt(n,t){t=Lr(t,n)?[t+""]:rt(t);for(var r=0,e=t.length;null!=n&&e>r;)n=n[t[r++]];return r&&r==e?n:Z}function dt(n,t){return lu.call(n,t)||"object"==typeof n&&t in n&&null===ju(n)}function yt(n,t){return t in Object(n)}function bt(n,t,r){for(var e=r?c:f,u=n.length,o=u,i=Array(u),l=[];o--;){var s=n[o];o&&t&&(s=a(s,w(t))),i[o]=r||!t&&120>s.length?Z:new Mn(o&&s)}var s=n[0],h=-1,p=s.length,_=i[0];n:for(;++h<p;){var g=s[h],v=t?t(g):g;if(_?!Ln(_,v):!e(l,v,r)){for(o=u;--o;){var d=i[o];if(d?!Ln(d,v):!e(n[o],v,r))continue n}_&&_.push(v),l.push(g)}}return l}function xt(n,t,r,e){return pt(n,function(n,u,o){t(e,r(n),u,o)}),e}function mt(n,t,e){return Lr(t,n)||(t=rt(t),n=Zr(n,t),t=Vr(t)),t=null==n?n:n[t],null==t?Z:r(t,n,e)}function jt(n,t,r,e,u){if(n===t)return!0;if(null==n||null==t||!je(n)&&!we(t))return n!==n&&t!==t;n:{var o=Zo(n),i=Zo(t),f="[object Array]",c="[object Array]";o||(f=Rr(n),"[object Arguments]"==f?f="[object Object]":"[object Object]"!=f&&(o=Re(n))),i||(c=Rr(t),"[object Arguments]"==c?c="[object Object]":"[object Object]"!=c&&Re(t));var a="[object Object]"==f&&!C(n),i="[object Object]"==c&&!C(t),c=f==c;if(!c||o||a){if(!(2&e)&&(f=a&&lu.call(n,"__wrapped__"),i=i&&lu.call(t,"__wrapped__"),f||i)){n=jt(f?n.value():n,i?t.value():t,r,e,u);break n}c?(u||(u=new $n),n=(o?jr:Ar)(n,t,jt,r,e,u)):n=!1}else n=wr(n,t,f,jt,r,e)}return n}function wt(n,t,r,e){var u=r.length,o=u,i=!e;if(null==n)return!o;for(n=Object(n);u--;){var f=r[u];if(i&&f[2]?f[1]!==n[f[0]]:!(f[0]in n))return!1}for(;++u<o;){var f=r[u],c=f[0],a=n[c],l=f[1];if(i&&f[2]){if(a===Z&&!(c in n))return!1}else if(f=new $n,c=e?e(a,l,c,n,t,f):Z,c===Z?!jt(l,a,e,3,f):!c)return!1}return!0}function At(n){var t=typeof n;return"function"==t?n:null==n?Ye:"object"==t?Zo(n)?It(n[0],n[1]):Et(n):nu(n)}function Ot(n){n=null==n?n:Object(n);var t,r=[];for(t in n)r.push(t);return r}function kt(n,t){var r=-1,e=ve(n)?Array(n.length):[];return Hu(n,function(n,u,o){e[++r]=t(n,u,o)}),e}function Et(n){var t=Er(n);if(1==t.length&&t[0][2]){var r=t[0][0],e=t[0][1];return function(n){return null==n?!1:n[r]===e&&(e!==Z||r in Object(n))}}return function(r){return r===n||wt(r,n,t)}}function It(n,t){return function(r){var e=$e(r,n);return e===Z&&e===t?Ne(r,n):jt(t,e,Z,3)}}function St(n,t,r,e,o){if(n!==t){var i=Zo(t)||Re(t)?Z:Ze(t);u(i||t,function(u,f){if(i&&(f=u,u=t[f]),je(u)){o||(o=new $n);var c=f,a=o,l=n[c],s=t[c],h=a.get(s);if(!h){var h=e?e(l,s,c+"",n,t,a):Z,p=h===Z;p&&(h=s,Zo(s)||Re(s)?Zo(l)?h=l:de(l)?h=Xt(l):(p=!1,h=ut(s,!0)):ke(s)||ge(s)?ge(l)?h=Me(l):!je(l)||r&&be(l)?(p=!1,h=ut(s,!0)):h=l:p=!1),a.set(s,h),p&&St(h,s,r,e,a)}Gn(n,c,h)}else c=e?e(n[f],u,f+"",n,t,o):Z,c===Z&&(c=u),Gn(n,f,c)})}}function Rt(n,t,r){var e=-1,u=kr();return t=a(t.length?t:Array(1),function(n){return u(n)}),n=kt(n,function(n,r,u){return{a:a(t,function(t){return t(n)}),b:++e,c:n}}),b(n,function(n,t){var e;n:{e=-1;for(var u=n.a,o=t.a,i=u.length,f=r.length;++e<i;){var c=I(u[e],o[e]);if(c){if(e>=f){e=c;break n}e=c*("desc"==r[e]?-1:1);break n}}e=n.b-t.b}return e})}function Wt(n,t){return n=Object(n),s(t,function(t,r){return r in n&&(t[r]=n[r]),t},{})}function Bt(n,t){var r={};return ht(n,function(n,e){t(n,e)&&(r[e]=n)}),r}function Ct(n){return function(t){return null==t?Z:t[n]}}function Ut(n){return function(t){return vt(t,n)}}function zt(n,t,r){var e=-1,u=t.length,o=n;for(r&&(o=a(n,function(n){return r(n)}));++e<u;)for(var i=0,f=t[e],f=r?r(f):f;-1<(i=d(o,f,i));)o!==n&&Iu.call(o,i,1),Iu.call(n,i,1);return n}function Mt(n,t){for(var r=n?t.length:0,e=r-1;r--;){var u=t[r];if(e==r||u!=o){var o=u;if(U(u))Iu.call(n,u,1);else if(Lr(u,n))delete n[u];else{var u=rt(u),i=Zr(n,u);null!=i&&delete i[Vr(u)]}}}return n}function Lt(n,t){return n+Ru(Lu()*(t-n+1))}function $t(n,t,r,e){t=Lr(t,n)?[t+""]:rt(t);for(var u=-1,o=t.length,i=o-1,f=n;null!=f&&++u<o;){var c=t[u];if(je(f)){var a=r;if(u!=i){var l=f[c],a=e?e(l,c,f):Z;a===Z&&(a=null==l?U(t[u+1])?[]:{}:l)}Yn(f,c,a)}f=f[c]}return n}function Ft(n,t,r){var e=-1,u=n.length;for(0>t&&(t=-t>u?0:u+t),r=r>u?u:r,0>r&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0,r=Array(u);++e<u;)r[e]=n[e+t];return r}function Nt(n,t){var r;return Hu(n,function(n,e,u){return r=t(n,e,u),!r}),!!r}function Dt(n,t,r){var e=0,u=n?n.length:e;if("number"==typeof t&&t===t&&2147483647>=u){for(;u>e;){var o=e+u>>>1,i=n[o];(r?t>=i:t>i)&&null!==i?e=o+1:u=o}return u}return Zt(n,t,Ye,r)}function Zt(n,t,r,e){t=r(t);for(var u=0,o=n?n.length:0,i=t!==t,f=null===t,c=t===Z;o>u;){var a=Ru((u+o)/2),l=r(n[a]),s=l!==Z,h=l===l;(i?h||e:f?h&&s&&(e||null!=l):c?h&&(e||s):null==l?0:e?t>=l:t>l)?u=a+1:o=a}return zu(o,4294967294)}function qt(n,t){for(var r=0,e=n.length,u=n[0],o=t?t(u):u,i=o,f=0,c=[u];++r<e;)u=n[r],o=t?t(u):u,pe(o,i)||(i=o,c[++f]=u);return c}function Pt(n,t,r){var e=-1,u=f,o=n.length,i=!0,a=[],l=a;if(r)i=!1,u=c;else if(200>o)l=t?[]:a;else{if(u=t?null:ro(n))return $(u);i=!1,u=Ln,l=new Mn}n:for(;++e<o;){var s=n[e],h=t?t(s):s;if(i&&h===h){for(var p=l.length;p--;)if(l[p]===h)continue n;t&&l.push(h),a.push(s)}else u(l,h,r)||(l!==a&&l.push(h),a.push(s))}return a}function Tt(n,t,r,e){for(var u=n.length,o=e?u:-1;(e?o--:++o<u)&&t(n[o],o,n););return r?Ft(n,e?0:o,e?o+1:u):Ft(n,e?o+1:0,e?u:o)}function Kt(n,t){var r=n;return r instanceof An&&(r=r.value()),s(t,function(n,t){return t.func.apply(t.thisArg,l([n],t.args))},r)}function Gt(n,t,r){for(var e=-1,u=n.length;++e<u;)var o=o?l(ct(o,n[e],t,r),ct(n[e],o,t,r)):n[e];return o&&o.length?Pt(o,t,r):[]}function Vt(n,t,r){for(var e=-1,u=n.length,o=t.length,i={};++e<u;)r(i,n[e],o>e?t[e]:Z);return i}function Jt(n,t){if(t)return n.slice();var r=new n.constructor(n.length);return n.copy(r),r}function Yt(n){var t=new n.constructor(n.byteLength);return new bu(t).set(new bu(n)),t}function Ht(n,t,r,e){var u=-1,o=n.length,i=r.length,f=-1,c=t.length,a=Uu(o-i,0),l=Array(c+a);for(e=!e;++f<c;)l[f]=t[f];for(;++u<i;)(e||o>u)&&(l[r[u]]=n[u]);for(;a--;)l[f++]=n[u++];return l}function Qt(n,t,r,e){var u=-1,o=n.length,i=-1,f=r.length,c=-1,a=t.length,l=Uu(o-f,0),s=Array(l+a);for(e=!e;++u<l;)s[u]=n[u];for(l=u;++c<a;)s[l+c]=t[c];for(;++i<f;)(e||o>u)&&(s[l+r[i]]=n[u++]);return s}function Xt(n,t){var r=-1,e=n.length;for(t||(t=Array(e));++r<e;)t[r]=n[r];return t}function nr(n,t,r){return tr(n,t,r)}function tr(n,t,r,e){r||(r={});for(var u=-1,o=t.length;++u<o;){var i=t[u],f=e?e(r[i],n[i],i,r,n):n[i];Yn(r,i,f)}return r}function rr(n,t){return nr(n,oo(n),t)}function er(n,t){return function(r,u){var o=Zo(r)?e:Hn,i=t?t():{};return o(r,n,kr(u),i)}}function ur(n){return he(function(t,r){var e=-1,u=r.length,o=u>1?r[u-1]:Z,i=u>2?r[2]:Z,o="function"==typeof o?(u--,o):Z;for(i&&Mr(r[0],r[1],i)&&(o=3>u?Z:o,u=1),t=Object(t);++e<u;)(i=r[e])&&n(t,i,e,o);return t})}function or(n,t){return function(r,e){if(null==r)return r;if(!ve(r))return n(r,e);for(var u=r.length,o=t?u:-1,i=Object(r);(t?o--:++o<u)&&!1!==e(i[o],o,i););return r}}function ir(n){return function(t,r,e){var u=-1,o=Object(t);e=e(t);for(var i=e.length;i--;){var f=e[n?i:++u];if(!1===r(o[f],f,o))break}return t}}function fr(n,t,r){function e(){return(this&&this!==Vn&&this instanceof e?o:n).apply(u?r:this,arguments)}var u=1&t,o=lr(n);return e}function cr(n){return function(t){t=Le(t);var r=En.test(t)?t.match(kn):Z,e=r?r[0]:t.charAt(0);return t=r?r.slice(1).join(""):t.slice(1),e[n]()+t}}function ar(n){return function(t){return s(Ve(Ke(t)),n,"")}}function lr(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=it(n.prototype),t=n.apply(r,t);return je(t)?t:r}}function sr(n,t,e){function u(){for(var i=arguments.length,f=Array(i),c=i,a=Sr(u);c--;)f[c]=arguments[c];return c=3>i&&f[0]!==a&&f[i-1]!==a?[]:L(f,a),i-=c.length,e>i?br(n,t,pr,u.placeholder,Z,f,c,Z,Z,e-i):r(this&&this!==Vn&&this instanceof u?o:n,this,f)}var o=lr(n);return u}function hr(n){return he(function(t){t=st(t,1);var r=t.length,e=r,u=wn.prototype.thru;for(n&&t.reverse();e--;){var o=t[e];if("function"!=typeof o)throw new iu("Expected a function");if(u&&!i&&"wrapper"==Or(o))var i=new wn([],!0)}for(e=i?e:r;++e<r;)var o=t[e],u=Or(o),f="wrapper"==u?eo(o):Z,i=f&&Fr(f[0])&&424==f[1]&&!f[4].length&&1==f[9]?i[Or(f[0])].apply(i,f[3]):1==o.length&&Fr(o)?i[u]():i.thru(o);return function(){var n=arguments,e=n[0];if(i&&1==n.length&&Zo(e)&&e.length>=200)return i.plant(e).value();for(var u=0,n=r?t[u].apply(this,n):e;++u<r;)n=t[u].call(this,n);return n}})}function pr(n,t,r,e,u,o,i,f,c,a){function l(){for(var d=arguments.length,y=d,b=Array(d);y--;)b[y]=arguments[y];if(_){var x,m=Sr(l),y=b.length;for(x=0;y--;)b[y]===m&&x++}if(e&&(b=Ht(b,e,u,_)),o&&(b=Qt(b,o,i,_)),d-=x,_&&a>d)return m=L(b,m),br(n,t,pr,l.placeholder,r,b,m,f,c,a-d);if(m=h?r:this,y=p?m[n]:n,d=b.length,f){x=b.length;for(var j=zu(f.length,x),w=Xt(b);j--;){var A=f[j];b[j]=U(A,x)?w[A]:Z}}else g&&d>1&&b.reverse();return s&&d>c&&(b.length=c),this&&this!==Vn&&this instanceof l&&(y=v||lr(y)),y.apply(m,b)}var s=128&t,h=1&t,p=2&t,_=24&t,g=512&t,v=p?Z:lr(n);return l}function _r(n,t){return function(r,e){return xt(r,n,t(e),{})}}function gr(n){return he(function(t){return t=a(st(t,1),kr()),he(function(e){var u=this;return n(t,function(n){return r(n,u,e)})})})}function vr(n,t,r){return t=Ce(t),n=F(n),t&&t>n?(t-=n,r=r===Z?" ":r+"",n=Ge(r,Su(t/F(r))),En.test(r)?n.match(kn).slice(0,t).join(""):n.slice(0,t)):""}function dr(n,t,e,u){function o(){for(var t=-1,c=arguments.length,a=-1,l=u.length,s=Array(l+c),h=this&&this!==Vn&&this instanceof o?f:n;++a<l;)s[a]=u[a];for(;c--;)s[a++]=arguments[++t];return r(h,i?e:this,s)}var i=1&t,f=lr(n);return o}function yr(n){return function(t,r,e){e&&"number"!=typeof e&&Mr(t,r,e)&&(r=e=Z),t=ze(t),t=t===t?t:0,r===Z?(r=t,t=0):r=ze(r)||0,e=e===Z?r>t?1:-1:ze(e)||0;var u=-1;r=Uu(Su((r-t)/(e||1)),0);for(var o=Array(r);r--;)o[n?r:++u]=t,t+=e;return o}}function br(n,t,r,e,u,o,i,f,c,a){var l=8&t;f=f?Xt(f):Z;var s=l?i:Z;i=l?Z:i;var h=l?o:Z;return o=l?Z:o,t=(t|(l?32:64))&~(l?64:32),4&t||(t&=-4),t=[n,t,u,h,s,o,i,f,c,a],r=r.apply(Z,t),Fr(n)&&io(r,t),r.placeholder=e,r}function xr(n){var t=uu[n];return function(n,r){if(n=ze(n),r=Ce(r)){var e=(Le(n)+"e").split("e"),e=t(e[0]+"e"+(+e[1]+r)),e=(Le(e)+"e").split("e");return+(e[0]+"e"+(+e[1]-r))}return t(n)}}function mr(n,t,r,e,u,o,i,f){var c=2&t;if(!c&&"function"!=typeof n)throw new iu("Expected a function");var a=e?e.length:0;if(a||(t&=-97,e=u=Z),i=i===Z?i:Uu(Ce(i),0),f=f===Z?f:Ce(f),a-=u?u.length:0,64&t){var l=e,s=u;e=u=Z}var h=c?Z:eo(n);return o=[n,t,r,e,u,l,s,o,i,f],h&&(r=o[1],n=h[1],t=r|n,e=128==n&&8==r||128==n&&256==r&&h[8]>=o[7].length||384==n&&h[8]>=h[7].length&&8==r,131>t||e)&&(1&n&&(o[2]=h[2],t|=1&r?0:4),(r=h[3])&&(e=o[3],o[3]=e?Ht(e,r,h[4]):Xt(r),o[4]=e?L(o[3],"__lodash_placeholder__"):Xt(h[4])),(r=h[5])&&(e=o[5],o[5]=e?Qt(e,r,h[6]):Xt(r),o[6]=e?L(o[5],"__lodash_placeholder__"):Xt(h[6])),(r=h[7])&&(o[7]=Xt(r)),128&n&&(o[8]=null==o[8]?h[8]:zu(o[8],h[8])),null==o[9]&&(o[9]=h[9]),o[0]=h[0],o[1]=t),n=o[0],t=o[1],r=o[2],e=o[3],u=o[4],f=o[9]=null==o[9]?c?0:n.length:Uu(o[9]-a,0),!f&&24&t&&(t&=-25),c=t&&1!=t?8==t||16==t?sr(n,t,f):32!=t&&33!=t||u.length?pr.apply(Z,o):dr(n,t,r,e):fr(n,t,r),(h?to:io)(c,o)}function jr(n,t,r,e,u,o){var i=-1,f=2&u,c=1&u,a=n.length,l=t.length;if(!(a==l||f&&l>a))return!1;if(l=o.get(n))return l==t;for(l=!0,o.set(n,t);++i<a;){var s=n[i],h=t[i];if(e)var _=f?e(h,s,i,t,n,o):e(s,h,i,n,t,o);if(_!==Z){if(_)continue;l=!1;break}if(c){if(!p(t,function(n){return s===n||r(s,n,e,u,o)})){l=!1;break}}else if(s!==h&&!r(s,h,e,u,o)){l=!1;break}}return o["delete"](n),l}function wr(n,t,r,e,u,o){switch(r){case"[object ArrayBuffer]":if(n.byteLength!=t.byteLength||!e(new bu(n),new bu(t)))break;return!0;case"[object Boolean]":case"[object Date]":return+n==+t;case"[object Error]":return n.name==t.name&&n.message==t.message;case"[object Number]":return n!=+n?t!=+t:n==+t;case"[object RegExp]":case"[object String]":return n==t+"";case"[object Map]":var i=M;case"[object Set]":return i||(i=$),(2&o||n.size==t.size)&&e(i(n),i(t),u,1|o);case"[object Symbol]":return!!yu&&Vu.call(n)==Vu.call(t)}return!1}function Ar(n,t,r,e,u,o){var i=2&u,f=De(n),c=f.length,a=De(t).length;if(c!=a&&!i)return!1;for(var l=c;l--;){var s=f[l];if(!(i?s in t:dt(t,s)))return!1}if(a=o.get(n))return a==t;a=!0,o.set(n,t);for(var h=i;++l<c;){var s=f[l],p=n[s],_=t[s];if(e)var g=i?e(_,p,s,t,n,o):e(p,_,s,n,t,o);if(g===Z?p!==_&&!r(p,_,e,u,o):!g){a=!1;break}h||(h="constructor"==s)}return a&&!h&&(r=n.constructor,e=t.constructor,r!=e&&"constructor"in n&&"constructor"in t&&!("function"==typeof r&&r instanceof r&&"function"==typeof e&&e instanceof e)&&(a=!1)),o["delete"](n),a}function Or(n){for(var t=n.name+"",r=Yu[t],e=lu.call(Yu,t)?r.length:0;e--;){var u=r[e],o=u.func;if(null==o||o==n)return u.name}return t}function kr(){var n=yn.iteratee||He,n=n===He?At:n;return arguments.length?n(arguments[0],arguments[1]):n}function Er(n){n=qe(n);for(var t=n.length;t--;){var r,e=n[t];r=n[t][1],r=r===r&&!je(r),e[2]=r}return n}function Ir(n,t){var r=null==n?Z:n[t];return Ae(r)?r:Z}function Sr(n){return(lu.call(yn,"placeholder")?yn:n).placeholder}function Rr(n){return pu.call(n)}function Wr(n,t,r){if(null==n)return!1;var e=r(n,t);return e||Lr(t)||(t=rt(t),n=Zr(n,t),null!=n&&(t=Vr(t),e=r(n,t))),r=n?n.length:Z,e||!!r&&me(r)&&U(t,r)&&(Zo(n)||Ie(n)||ge(n))}function Br(n){var t=n.length,r=n.constructor(t);return t&&"string"==typeof n[0]&&lu.call(n,"index")&&(r.index=n.index,r.input=n.input),r}function Cr(n){return be(n.constructor)&&!Nr(n)?it(ju(n)):{}}function Ur(r,e,u){var o=r.constructor;switch(e){case"[object ArrayBuffer]":return Yt(r);case"[object Boolean]":case"[object Date]":return new o(+r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return e=r.buffer,u=u?Yt(e):e,new r.constructor(u,r.byteOffset,r.length);case"[object Map]":return u=r.constructor,s(M(r),n,new u);case"[object Number]":case"[object String]":return new o(r);case"[object RegExp]":return u=new r.constructor(r.source,hn.exec(r)),u.lastIndex=r.lastIndex,u;case"[object Set]":return u=r.constructor,s($(r),t,new u);case"[object Symbol]":return yu?Object(Vu.call(r)):{}}}function zr(n){var t=n?n.length:Z;return me(t)&&(Zo(n)||Ie(n)||ge(n))?m(t,String):null}function Mr(n,t,r){if(!je(r))return!1;var e=typeof t;return("number"==e?ve(r)&&U(t,r.length):"string"==e&&t in r)?pe(r[t],n):!1}function Lr(n,t){return"number"==typeof n?!0:!Zo(n)&&(rn.test(n)||!tn.test(n)||null!=t&&n in Object(t))}function $r(n){var t=typeof n;return"number"==t||"boolean"==t||"string"==t&&"__proto__"!=n||null==n}function Fr(n){var t=Or(n),r=yn[t];return"function"==typeof r&&t in An.prototype?n===r?!0:(t=eo(r),!!t&&n===t[0]):!1}function Nr(n){var t=n&&n.constructor,t=be(t)&&t.prototype||cu;return n===t}function Dr(n,t,r,e,u,o){return je(n)&&je(t)&&(o.set(t,n),St(n,t,Z,Dr,o)),n}function Zr(n,t){return 1==t.length?n:$e(n,Ft(t,0,-1))}function qr(n){var t=[];return Le(n).replace(en,function(n,r,e,u){t.push(e?u.replace(ln,"$1"):r||n)}),t}function Pr(n){if(n instanceof An)return n.clone();var t=new wn(n.__wrapped__,n.__chain__);return t.__actions__=Xt(n.__actions__),t.__index__=n.__index__,t.__values__=n.__values__,t}function Tr(n,t,r){var e=n?n.length:0;return e?(t=r||t===Z?1:Ce(t),Ft(n,0>t?0:t,e)):[]}function Kr(n,t,r){var e=n?n.length:0;return e?(t=r||t===Z?1:Ce(t),t=e-t,Ft(n,0,0>t?0:t)):[]}function Gr(n){return n?n[0]:Z}function Vr(n){var t=n?n.length:0;return t?n[t-1]:Z}function Jr(n,t){return n&&n.length&&t&&t.length?zt(n,t):n}function Yr(n){return n?$u.call(n):n}function Hr(n){if(!n||!n.length)return[];var t=0;return n=i(n,function(n){return de(n)?(t=Uu(n.length,t),!0):void 0}),m(t,function(t){return a(n,Ct(t))})}function Qr(n,t){if(!n||!n.length)return[];var e=Hr(n);return null==t?e:a(e,function(n){return r(t,Z,n)})}function Xr(n){return n=yn(n),n.__chain__=!0,n}function ne(n,t){return t(n)}function te(){return this}function re(n,t){return"function"==typeof t&&Zo(n)?u(n,t):Hu(n,tt(t))}function ee(n,t){var r;if("function"==typeof t&&Zo(n)){for(r=n.length;r--&&!1!==t(n[r],r,n););r=n}else r=Qu(n,tt(t));return r}function ue(n,t){return(Zo(n)?a:kt)(n,kr(t,3))}function oe(n,t){var r=-1,e=Be(n),u=e.length,o=u-1;for(t=et(Ce(t),0,u);++r<t;){var u=Lt(r,o),i=e[u];e[u]=e[r],e[r]=i}return e.length=t,e}function ie(n,t,r){return t=r?Z:t,t=n&&null==t?n.length:t,mr(n,128,Z,Z,Z,Z,t)}function fe(n,t){var r;if("function"!=typeof t)throw new iu("Expected a function");return n=Ce(n),function(){return 0<--n&&(r=t.apply(this,arguments)),1>=n&&(t=Z),r}}function ce(n,t,r){return t=r?Z:t,n=mr(n,8,Z,Z,Z,Z,Z,t),n.placeholder=ce.placeholder,n}function ae(n,t,r){return t=r?Z:t,n=mr(n,16,Z,Z,Z,Z,Z,t),n.placeholder=ae.placeholder,n}function le(n,t,r){function e(){p&&xu(p),a&&xu(a),g=0,c=a=h=p=_=Z}function u(t,r){r&&xu(r),a=p=_=Z,t&&(g=Co(),l=n.apply(h,c),p||a||(c=h=Z))}function o(){var n=t-(Co()-s);0>=n||n>t?u(_,a):p=Eu(o,n)}function i(){u(y,p)}function f(){if(c=arguments,s=Co(),h=this,_=y&&(p||!v),!1===d)var r=v&&!p;else{g||a||v||(g=s);var e=d-(s-g),u=(0>=e||e>d)&&(v||a);u?(a&&(a=xu(a)),g=s,l=n.apply(h,c)):a||(a=Eu(i,e))}return u&&p?p=xu(p):p||t===d||(p=Eu(o,t)),r&&(u=!0,l=n.apply(h,c)),!u||p||a||(c=h=Z),l}var c,a,l,s,h,p,_,g=0,v=!1,d=!1,y=!0;if("function"!=typeof n)throw new iu("Expected a function");return t=ze(t)||0,je(r)&&(v=!!r.leading,d="maxWait"in r&&Uu(ze(r.maxWait)||0,t),y="trailing"in r?!!r.trailing:y),f.cancel=e,f.flush=function(){return(p&&_||a&&y)&&(l=n.apply(h,c)),e(),l},f}function se(n,t){if("function"!=typeof n||t&&"function"!=typeof t)throw new iu("Expected a function");var r=function(){var e=arguments,u=t?t.apply(this,e):e[0],o=r.cache;return o.has(u)?o.get(u):(e=n.apply(this,e),r.cache=o.set(u,e),e)};return r.cache=new se.Cache,r}function he(n,t){if("function"!=typeof n)throw new iu("Expected a function");return t=Uu(t===Z?n.length-1:Ce(t),0),function(){for(var e=arguments,u=-1,o=Uu(e.length-t,0),i=Array(o);++u<o;)i[u]=e[t+u];switch(t){case 0:return n.call(this,i);case 1:return n.call(this,e[0],i);case 2:return n.call(this,e[0],e[1],i)}for(o=Array(t+1),u=-1;++u<t;)o[u]=e[u];return o[t]=i,r(n,this,o)}}function pe(n,t){return n===t||n!==n&&t!==t}function _e(n,t){return n>t}function ge(n){return de(n)&&lu.call(n,"callee")&&(!ku.call(n,"callee")||"[object Arguments]"==pu.call(n))}function ve(n){return null!=n&&!("function"==typeof n&&be(n))&&me(uo(n))}function de(n){return we(n)&&ve(n)}function ye(n){return we(n)?"[object Error]"==pu.call(n)||"string"==typeof n.message&&"string"==typeof n.name:!1}function be(n){return n=je(n)?pu.call(n):"","[object Function]"==n||"[object GeneratorFunction]"==n}function xe(n){return"number"==typeof n&&n==Ce(n)}function me(n){return"number"==typeof n&&n>-1&&0==n%1&&9007199254740991>=n}function je(n){var t=typeof n;return!!n&&("object"==t||"function"==t)}function we(n){return!!n&&"object"==typeof n}function Ae(n){return null==n?!1:be(n)?gu.test(au.call(n)):we(n)&&(C(n)?gu:vn).test(n)}function Oe(n){return"number"==typeof n||we(n)&&"[object Number]"==pu.call(n)}function ke(n){return!we(n)||"[object Object]"!=pu.call(n)||C(n)?!1:(n=ju(n),null===n?!0:(n=n.constructor,"function"==typeof n&&n instanceof n&&au.call(n)==hu))}function Ee(n){return je(n)&&"[object RegExp]"==pu.call(n)}function Ie(n){return"string"==typeof n||!Zo(n)&&we(n)&&"[object String]"==pu.call(n)}function Se(n){return"symbol"==typeof n||we(n)&&"[object Symbol]"==pu.call(n)}function Re(n){return we(n)&&me(n.length)&&!!Bn[pu.call(n)]}function We(n,t){return t>n}function Be(n){if(!n)return[];if(ve(n))return Ie(n)?n.match(kn):Xt(n);if(Au&&n[Au])return z(n[Au]());var t=Rr(n);return("[object Map]"==t?M:"[object Set]"==t?$:Pe)(n)}function Ce(n){if(!n)return 0===n?n:0;if(n=ze(n),n===q||n===-q)return 1.7976931348623157e308*(0>n?-1:1);var t=n%1;return n===n?t?n-t:n:0}function Ue(n){return n?et(Ce(n),0,4294967295):0}function ze(n){if(je(n)&&(n=be(n.valueOf)?n.valueOf():n,n=je(n)?n+"":n),"string"!=typeof n)return 0===n?n:+n;n=n.replace(fn,"");var t=gn.test(n);return t||dn.test(n)?Nn(n.slice(2),t?2:8):_n.test(n)?P:+n}function Me(n){return nr(n,Ze(n))}function Le(n){if("string"==typeof n)return n;if(null==n)return"";if(Se(n))return yu?Ju.call(n):"";var t=n+"";return"0"==t&&1/n==-q?"-0":t}function $e(n,t,r){return n=null==n?Z:vt(n,t),n===Z?r:n}function Fe(n,t){return Wr(n,t,dt)}function Ne(n,t){return Wr(n,t,yt)}function De(n){var t=Nr(n);if(!t&&!ve(n))return Cu(Object(n));var r,e=zr(n),u=!!e,e=e||[],o=e.length;for(r in n)!dt(n,r)||u&&("length"==r||U(r,o))||t&&"constructor"==r||e.push(r);return e}function Ze(n){for(var t=-1,r=Nr(n),e=Ot(n),u=e.length,o=zr(n),i=!!o,o=o||[],f=o.length;++t<u;){var c=e[t];i&&("length"==c||U(c,f))||"constructor"==c&&(r||!lu.call(n,c))||o.push(c)}return o}function qe(n){return j(n,De(n))}function Pe(n){return n?A(n,De(n)):[]}function Te(n){return ci(Le(n).toLowerCase())}function Ke(n){return(n=Le(n))&&n.replace(bn,S).replace(On,"")}function Ge(n,t){n=Le(n),t=Ce(t);var r="";if(!n||1>t||t>9007199254740991)return r;do t%2&&(r+=n),t=Ru(t/2),n+=n;while(t);return r}function Ve(n,t,r){return n=Le(n),t=r?Z:t,t===Z&&(t=Rn.test(n)?Sn:In),n.match(t)||[]}function Je(n){return function(){return n}}function Ye(n){return n}function He(n){return At("function"==typeof n?n:ut(n,!0))}function Qe(n,t,r){var e=De(t),o=gt(t,e);null!=r||je(t)&&(o.length||!e.length)||(r=t,t=n,n=this,o=gt(t,De(t)));var i=je(r)&&"chain"in r?r.chain:!0,f=be(n);return u(o,function(r){var e=t[r];n[r]=e,f&&(n.prototype[r]=function(){var t=this.__chain__;if(i||t){var r=n(this.__wrapped__);return(r.__actions__=Xt(this.__actions__)).push({func:e,args:arguments,thisArg:n}),r.__chain__=t,r}return e.apply(n,l([this.value()],arguments))})}),n}function Xe(){}function nu(n){return Lr(n)?Ct(n):Ut(n)}function tu(n){return n&&n.length?x(n,Ye):0}E=E?Jn.defaults({},E,Jn.pick(Vn,Wn)):Vn;var ru=E.Date,eu=E.Error,uu=E.Math,ou=E.RegExp,iu=E.TypeError,fu=E.Array.prototype,cu=E.Object.prototype,au=E.Function.prototype.toString,lu=cu.hasOwnProperty,su=0,hu=au.call(Object),pu=cu.toString,_u=Vn._,gu=ou("^"+au.call(lu).replace(un,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vu=qn?E.Buffer:Z,du=E.Reflect,yu=E.Symbol,bu=E.Uint8Array,xu=E.clearTimeout,mu=du?du.enumerate:Z,ju=Object.getPrototypeOf,wu=Object.getOwnPropertySymbols,Au="symbol"==typeof(Au=yu&&yu.iterator)?Au:Z,Ou=Object.create,ku=cu.propertyIsEnumerable,Eu=E.setTimeout,Iu=fu.splice,Su=uu.ceil,Ru=uu.floor,Wu=E.isFinite,Bu=fu.join,Cu=Object.keys,Uu=uu.max,zu=uu.min,Mu=E.parseInt,Lu=uu.random,$u=fu.reverse,Fu=Ir(E,"Map"),Nu=Ir(E,"Set"),Du=Ir(E,"WeakMap"),Zu=Ir(Object,"create"),qu=Du&&new Du,Pu=Fu?au.call(Fu):"",Tu=Nu?au.call(Nu):"",Ku=Du?au.call(Du):"",Gu=yu?yu.prototype:Z,Vu=yu?Gu.valueOf:Z,Ju=yu?Gu.toString:Z,Yu={};yn.templateSettings={escape:Q,evaluate:X,interpolate:nn,variable:"",imports:{_:yn}};var Hu=or(pt),Qu=or(_t,!0),Xu=ir(),no=ir(!0);mu&&!ku.call({valueOf:1},"valueOf")&&(Ot=function(n){return z(mu(n))});var to=qu?function(n,t){return qu.set(n,t),n}:Ye,ro=Nu&&2===new Nu([1,2]).size?function(n){return new Nu(n)}:Xe,eo=qu?function(n){return qu.get(n)}:Xe,uo=Ct("length"),oo=wu||function(){return[]};(Fu&&"[object Map]"!=Rr(new Fu)||Nu&&"[object Set]"!=Rr(new Nu)||Du&&"[object WeakMap]"!=Rr(new Du))&&(Rr=function(n){var t=pu.call(n);if(n="[object Object]"==t?n.constructor:null,n="function"==typeof n?au.call(n):"")switch(n){case Pu:return"[object Map]";case Tu:return"[object Set]";case Ku:return"[object WeakMap]"}return t});var io=function(){var n=0,t=0;return function(r,e){var u=Co(),o=16-(u-t);if(t=u,o>0){if(150<=++n)return r}else n=0;return to(r,e)}}(),fo=he(function(n,t){Zo(n)||(n=null==n?[]:[Object(n)]),t=st(t,1);for(var r=n,e=t,u=-1,o=r.length,i=-1,f=e.length,c=Array(o+f);++u<o;)c[u]=r[u];for(;++i<f;)c[u++]=e[i];return c}),co=he(function(n,t){return de(n)?ct(n,st(t,1,!0)):[]}),ao=he(function(n,t){var r=Vr(t);return de(r)&&(r=Z),de(n)?ct(n,st(t,1,!0),kr(r)):[]}),lo=he(function(n,t){var r=Vr(t);return de(r)&&(r=Z),de(n)?ct(n,st(t,1,!0),Z,r):[]}),so=he(function(n){var t=a(n,nt);return t.length&&t[0]===n[0]?bt(t):[]}),ho=he(function(n){var t=Vr(n),r=a(n,nt);return t===Vr(r)?t=Z:r.pop(),r.length&&r[0]===n[0]?bt(r,kr(t)):[]}),po=he(function(n){var t=Vr(n),r=a(n,nt);return t===Vr(r)?t=Z:r.pop(),r.length&&r[0]===n[0]?bt(r,Z,t):[]}),_o=he(Jr),go=he(function(n,t){t=a(st(t,1),String);var r=Xn(n,t);return Mt(n,t.sort(I)),r}),vo=he(function(n){return Pt(st(n,1,!0))}),yo=he(function(n){var t=Vr(n);return de(t)&&(t=Z),Pt(st(n,1,!0),kr(t))}),bo=he(function(n){var t=Vr(n);return de(t)&&(t=Z),Pt(st(n,1,!0),Z,t)}),xo=he(function(n,t){return de(n)?ct(n,t):[]}),mo=he(function(n){return Gt(i(n,de))}),jo=he(function(n){var t=Vr(n);return de(t)&&(t=Z),Gt(i(n,de),kr(t))}),wo=he(function(n){var t=Vr(n);return de(t)&&(t=Z),Gt(i(n,de),Z,t)}),Ao=he(Hr),Oo=he(function(n){var t=n.length,t=t>1?n[t-1]:Z,t="function"==typeof t?(n.pop(),t):Z;return Qr(n,t)}),ko=he(function(n){n=st(n,1);var t=n.length,r=t?n[0]:0,e=this.__wrapped__,u=function(t){return Xn(t,n)};return 1>=t&&!this.__actions__.length&&e instanceof An&&U(r)?(e=e.slice(r,+r+(t?1:0)),
e.__actions__.push({func:ne,args:[u],thisArg:Z}),new wn(e,this.__chain__).thru(function(n){return t&&!n.length&&n.push(Z),n})):this.thru(u)}),Eo=er(function(n,t,r){lu.call(n,r)?++n[r]:n[r]=1}),Io=er(function(n,t,r){lu.call(n,r)?n[r].push(t):n[r]=[t]}),So=he(function(n,t,e){var u=-1,o="function"==typeof t,i=Lr(t),f=ve(n)?Array(n.length):[];return Hu(n,function(n){var c=o?t:i&&null!=n?n[t]:Z;f[++u]=c?r(c,n,e):mt(n,t,e)}),f}),Ro=er(function(n,t,r){n[r]=t}),Wo=er(function(n,t,r){n[r?0:1].push(t)},function(){return[[],[]]}),Bo=he(function(n,t){if(null==n)return[];var r=t.length;return r>1&&Mr(n,t[0],t[1])?t=[]:r>2&&Mr(t[0],t[1],t[2])&&(t.length=1),Rt(n,st(t,1),[])}),Co=ru.now,Uo=he(function(n,t,r){var e=1;if(r.length)var u=L(r,Sr(Uo)),e=32|e;return mr(n,e,t,r,u)}),zo=he(function(n,t,r){var e=3;if(r.length)var u=L(r,Sr(zo)),e=32|e;return mr(t,e,n,r,u)}),Mo=he(function(n,t){return ft(n,1,t)}),Lo=he(function(n,t,r){return ft(n,ze(t)||0,r)}),$o=he(function(n,t){t=a(st(t,1),kr());var e=t.length;return he(function(u){for(var o=-1,i=zu(u.length,e);++o<i;)u[o]=t[o].call(this,u[o]);return r(n,this,u)})}),Fo=he(function(n,t){var r=L(t,Sr(Fo));return mr(n,32,Z,t,r)}),No=he(function(n,t){var r=L(t,Sr(No));return mr(n,64,Z,t,r)}),Do=he(function(n,t){return mr(n,256,Z,Z,Z,st(t,1))}),Zo=Array.isArray,qo=vu?function(n){return n instanceof vu}:Je(!1),Po=ur(function(n,t){nr(t,De(t),n)}),To=ur(function(n,t){nr(t,Ze(t),n)}),Ko=ur(function(n,t,r,e){tr(t,Ze(t),n,e)}),Go=ur(function(n,t,r,e){tr(t,De(t),n,e)}),Vo=he(function(n,t){return Xn(n,st(t,1))}),Jo=he(function(n){return n.push(Z,Kn),r(Ko,Z,n)}),Yo=he(function(n){return n.push(Z,Dr),r(ti,Z,n)}),Ho=_r(function(n,t,r){n[t]=r},Je(Ye)),Qo=_r(function(n,t,r){lu.call(n,t)?n[t].push(r):n[t]=[r]},kr),Xo=he(mt),ni=ur(function(n,t,r){St(n,t,r)}),ti=ur(function(n,t,r,e){St(n,t,r,e)}),ri=he(function(n,t){return null==n?{}:(t=a(st(t,1),String),Wt(n,ct(Ze(n),t)))}),ei=he(function(n,t){return null==n?{}:Wt(n,st(t,1))}),ui=ar(function(n,t,r){return t=t.toLowerCase(),n+(r?Te(t):t)}),oi=ar(function(n,t,r){return n+(r?"-":"")+t.toLowerCase()}),ii=ar(function(n,t,r){return n+(r?" ":"")+t.toLowerCase()}),fi=cr("toLowerCase"),ci=cr("toUpperCase"),ai=ar(function(n,t,r){return n+(r?"_":"")+t.toLowerCase()}),li=ar(function(n,t,r){return n+(r?" ":"")+Te(t)}),si=ar(function(n,t,r){return n+(r?" ":"")+t.toUpperCase()}),hi=he(function(n,t){try{return r(n,Z,t)}catch(e){return ye(e)?e:new eu(e)}}),pi=he(function(n,t){return u(st(t,1),function(t){n[t]=Uo(n[t],n)}),n}),_i=hr(),gi=hr(!0),vi=he(function(n,t){return function(r){return mt(r,n,t)}}),di=he(function(n,t){return function(r){return mt(n,r,t)}}),yi=gr(a),bi=gr(o),xi=gr(p),mi=yr(),ji=yr(!0),wi=xr("ceil"),Ai=xr("floor"),Oi=xr("round");return yn.prototype=jn.prototype,wn.prototype=it(jn.prototype),wn.prototype.constructor=wn,An.prototype=it(jn.prototype),An.prototype.constructor=An,Un.prototype=Zu?Zu(null):cu,zn.prototype.clear=function(){this.__data__={hash:new Un,map:Fu?new Fu:[],string:new Un}},zn.prototype["delete"]=function(n){var t=this.__data__;return $r(n)?(t="string"==typeof n?t.string:t.hash,(Zu?t[n]!==Z:lu.call(t,n))&&delete t[n]):Fu?t.map["delete"](n):Dn(t.map,n)},zn.prototype.get=function(n){var t=this.__data__;return $r(n)?(t="string"==typeof n?t.string:t.hash,Zu?(n=t[n],n="__lodash_hash_undefined__"===n?Z:n):n=lu.call(t,n)?t[n]:Z,n):Fu?t.map.get(n):Zn(t.map,n)},zn.prototype.has=function(n){var t=this.__data__;return $r(n)?(t="string"==typeof n?t.string:t.hash,n=Zu?t[n]!==Z:lu.call(t,n)):n=Fu?t.map.has(n):-1<Pn(t.map,n),n},zn.prototype.set=function(n,t){var r=this.__data__;return $r(n)?("string"==typeof n?r.string:r.hash)[n]=Zu&&t===Z?"__lodash_hash_undefined__":t:Fu?r.map.set(n,t):Tn(r.map,n,t),this},Mn.prototype.push=function(n){var t=this.__data__;$r(n)?(t=t.__data__,("string"==typeof n?t.string:t.hash)[n]="__lodash_hash_undefined__"):t.set(n,"__lodash_hash_undefined__")},$n.prototype.clear=function(){this.__data__={array:[],map:null}},$n.prototype["delete"]=function(n){var t=this.__data__,r=t.array;return r?Dn(r,n):t.map["delete"](n)},$n.prototype.get=function(n){var t=this.__data__,r=t.array;return r?Zn(r,n):t.map.get(n)},$n.prototype.has=function(n){var t=this.__data__,r=t.array;return r?-1<Pn(r,n):t.map.has(n)},$n.prototype.set=function(n,t){var r=this.__data__,e=r.array;return e&&(199>e.length?Tn(e,n,t):(r.array=null,r.map=new zn(e))),(r=r.map)&&r.set(n,t),this},se.Cache=zn,yn.after=function(n,t){if("function"!=typeof t)throw new iu("Expected a function");return n=Ce(n),function(){return 1>--n?t.apply(this,arguments):void 0}},yn.ary=ie,yn.assign=Po,yn.assignIn=To,yn.assignInWith=Ko,yn.assignWith=Go,yn.at=Vo,yn.before=fe,yn.bind=Uo,yn.bindAll=pi,yn.bindKey=zo,yn.castArray=function(){if(!arguments.length)return[];var n=arguments[0];return Zo(n)?n:[n]},yn.chain=Xr,yn.chunk=function(n,t){t=Uu(Ce(t),0);var r=n?n.length:0;if(!r||1>t)return[];for(var e=0,u=-1,o=Array(Su(r/t));r>e;)o[++u]=Ft(n,e,e+=t);return o},yn.compact=function(n){for(var t=-1,r=n?n.length:0,e=-1,u=[];++t<r;){var o=n[t];o&&(u[++e]=o)}return u},yn.concat=fo,yn.cond=function(n){var t=n?n.length:0,e=kr();return n=t?a(n,function(n){if("function"!=typeof n[1])throw new iu("Expected a function");return[e(n[0]),n[1]]}):[],he(function(e){for(var u=-1;++u<t;){var o=n[u];if(r(o[0],this,e))return r(o[1],this,e)}})},yn.conforms=function(n){return ot(ut(n,!0))},yn.constant=Je,yn.countBy=Eo,yn.create=function(n,t){var r=it(n);return t?Qn(r,t):r},yn.curry=ce,yn.curryRight=ae,yn.debounce=le,yn.defaults=Jo,yn.defaultsDeep=Yo,yn.defer=Mo,yn.delay=Lo,yn.difference=co,yn.differenceBy=ao,yn.differenceWith=lo,yn.drop=Tr,yn.dropRight=Kr,yn.dropRightWhile=function(n,t){return n&&n.length?Tt(n,kr(t,3),!0,!0):[]},yn.dropWhile=function(n,t){return n&&n.length?Tt(n,kr(t,3),!0):[]},yn.fill=function(n,t,r,e){var u=n?n.length:0;if(!u)return[];for(r&&"number"!=typeof r&&Mr(n,t,r)&&(r=0,e=u),u=n.length,r=Ce(r),0>r&&(r=-r>u?0:u+r),e=e===Z||e>u?u:Ce(e),0>e&&(e+=u),e=r>e?0:Ue(e);e>r;)n[r++]=t;return n},yn.filter=function(n,t){return(Zo(n)?i:lt)(n,kr(t,3))},yn.flatMap=function(n,t){return st(ue(n,t),1)},yn.flatten=function(n){return n&&n.length?st(n,1):[]},yn.flattenDeep=function(n){return n&&n.length?st(n,q):[]},yn.flattenDepth=function(n,t){return n&&n.length?(t=t===Z?1:Ce(t),st(n,t)):[]},yn.flip=function(n){return mr(n,512)},yn.flow=_i,yn.flowRight=gi,yn.fromPairs=function(n){for(var t=-1,r=n?n.length:0,e={};++t<r;){var u=n[t];e[u[0]]=u[1]}return e},yn.functions=function(n){return null==n?[]:gt(n,De(n))},yn.functionsIn=function(n){return null==n?[]:gt(n,Ze(n))},yn.groupBy=Io,yn.initial=function(n){return Kr(n,1)},yn.intersection=so,yn.intersectionBy=ho,yn.intersectionWith=po,yn.invert=Ho,yn.invertBy=Qo,yn.invokeMap=So,yn.iteratee=He,yn.keyBy=Ro,yn.keys=De,yn.keysIn=Ze,yn.map=ue,yn.mapKeys=function(n,t){var r={};return t=kr(t,3),pt(n,function(n,e,u){r[t(n,e,u)]=n}),r},yn.mapValues=function(n,t){var r={};return t=kr(t,3),pt(n,function(n,e,u){r[e]=t(n,e,u)}),r},yn.matches=function(n){return Et(ut(n,!0))},yn.matchesProperty=function(n,t){return It(n,ut(t,!0))},yn.memoize=se,yn.merge=ni,yn.mergeWith=ti,yn.method=vi,yn.methodOf=di,yn.mixin=Qe,yn.negate=function(n){if("function"!=typeof n)throw new iu("Expected a function");return function(){return!n.apply(this,arguments)}},yn.nthArg=function(n){return n=Ce(n),function(){return arguments[n]}},yn.omit=ri,yn.omitBy=function(n,t){return t=kr(t),Bt(n,function(n,r){return!t(n,r)})},yn.once=function(n){return fe(2,n)},yn.orderBy=function(n,t,r,e){return null==n?[]:(Zo(t)||(t=null==t?[]:[t]),r=e?Z:r,Zo(r)||(r=null==r?[]:[r]),Rt(n,t,r))},yn.over=yi,yn.overArgs=$o,yn.overEvery=bi,yn.overSome=xi,yn.partial=Fo,yn.partialRight=No,yn.partition=Wo,yn.pick=ei,yn.pickBy=function(n,t){return null==n?{}:Bt(n,kr(t))},yn.property=nu,yn.propertyOf=function(n){return function(t){return null==n?Z:vt(n,t)}},yn.pull=_o,yn.pullAll=Jr,yn.pullAllBy=function(n,t,r){return n&&n.length&&t&&t.length?zt(n,t,kr(r)):n},yn.pullAt=go,yn.range=mi,yn.rangeRight=ji,yn.rearg=Do,yn.reject=function(n,t){var r=Zo(n)?i:lt;return t=kr(t,3),r(n,function(n,r,e){return!t(n,r,e)})},yn.remove=function(n,t){var r=[];if(!n||!n.length)return r;var e=-1,u=[],o=n.length;for(t=kr(t,3);++e<o;){var i=n[e];t(i,e,n)&&(r.push(i),u.push(e))}return Mt(n,u),r},yn.rest=he,yn.reverse=Yr,yn.sampleSize=oe,yn.set=function(n,t,r){return null==n?n:$t(n,t,r)},yn.setWith=function(n,t,r,e){return e="function"==typeof e?e:Z,null==n?n:$t(n,t,r,e)},yn.shuffle=function(n){return oe(n,4294967295)},yn.slice=function(n,t,r){var e=n?n.length:0;return e?(r&&"number"!=typeof r&&Mr(n,t,r)?(t=0,r=e):(t=null==t?0:Ce(t),r=r===Z?e:Ce(r)),Ft(n,t,r)):[]},yn.sortBy=Bo,yn.sortedUniq=function(n){return n&&n.length?qt(n):[]},yn.sortedUniqBy=function(n,t){return n&&n.length?qt(n,kr(t)):[]},yn.split=function(n,t,r){return Le(n).split(t,r)},yn.spread=function(n,t){if("function"!=typeof n)throw new iu("Expected a function");return t=t===Z?0:Uu(Ce(t),0),he(function(e){var u=e[t];return e=e.slice(0,t),u&&l(e,u),r(n,this,e)})},yn.tail=function(n){return Tr(n,1)},yn.take=function(n,t,r){return n&&n.length?(t=r||t===Z?1:Ce(t),Ft(n,0,0>t?0:t)):[]},yn.takeRight=function(n,t,r){var e=n?n.length:0;return e?(t=r||t===Z?1:Ce(t),t=e-t,Ft(n,0>t?0:t,e)):[]},yn.takeRightWhile=function(n,t){return n&&n.length?Tt(n,kr(t,3),!1,!0):[]},yn.takeWhile=function(n,t){return n&&n.length?Tt(n,kr(t,3)):[]},yn.tap=function(n,t){return t(n),n},yn.throttle=function(n,t,r){var e=!0,u=!0;if("function"!=typeof n)throw new iu("Expected a function");return je(r)&&(e="leading"in r?!!r.leading:e,u="trailing"in r?!!r.trailing:u),le(n,t,{leading:e,maxWait:t,trailing:u})},yn.thru=ne,yn.toArray=Be,yn.toPairs=qe,yn.toPairsIn=function(n){return j(n,Ze(n))},yn.toPath=function(n){return Zo(n)?a(n,String):qr(n)},yn.toPlainObject=Me,yn.transform=function(n,t,r){var e=Zo(n)||Re(n);if(t=kr(t,4),null==r)if(e||je(n)){var o=n.constructor;r=e?Zo(n)?new o:[]:be(o)?it(ju(n)):{}}else r={};return(e?u:pt)(n,function(n,e,u){return t(r,n,e,u)}),r},yn.unary=function(n){return ie(n,1)},yn.union=vo,yn.unionBy=yo,yn.unionWith=bo,yn.uniq=function(n){return n&&n.length?Pt(n):[]},yn.uniqBy=function(n,t){return n&&n.length?Pt(n,kr(t)):[]},yn.uniqWith=function(n,t){return n&&n.length?Pt(n,Z,t):[]},yn.unset=function(n,t){var r;if(null==n)r=!0;else{r=n;var e=t,e=Lr(e,r)?[e+""]:rt(e);r=Zr(r,e),e=Vr(e),r=null!=r&&Fe(r,e)?delete r[e]:!0}return r},yn.unzip=Hr,yn.unzipWith=Qr,yn.values=Pe,yn.valuesIn=function(n){return null==n?[]:A(n,Ze(n))},yn.without=xo,yn.words=Ve,yn.wrap=function(n,t){return t=null==t?Ye:t,Fo(t,n)},yn.xor=mo,yn.xorBy=jo,yn.xorWith=wo,yn.zip=Ao,yn.zipObject=function(n,t){return Vt(n||[],t||[],Yn)},yn.zipObjectDeep=function(n,t){return Vt(n||[],t||[],$t)},yn.zipWith=Oo,yn.extend=To,yn.extendWith=Ko,Qe(yn,yn),yn.add=function(n,t){var r;return n===Z&&t===Z?0:(n!==Z&&(r=n),t!==Z&&(r=r===Z?t:r+t),r)},yn.attempt=hi,yn.camelCase=ui,yn.capitalize=Te,yn.ceil=wi,yn.clamp=function(n,t,r){return r===Z&&(r=t,t=Z),r!==Z&&(r=ze(r),r=r===r?r:0),t!==Z&&(t=ze(t),t=t===t?t:0),et(ze(n),t,r)},yn.clone=function(n){return ut(n)},yn.cloneDeep=function(n){return ut(n,!0)},yn.cloneDeepWith=function(n,t){return ut(n,!0,t)},yn.cloneWith=function(n,t){return ut(n,!1,t)},yn.deburr=Ke,yn.endsWith=function(n,t,r){n=Le(n),t="string"==typeof t?t:t+"";var e=n.length;return r=r===Z?e:et(Ce(r),0,e),r-=t.length,r>=0&&n.indexOf(t,r)==r},yn.eq=pe,yn.escape=function(n){return(n=Le(n))&&H.test(n)?n.replace(J,R):n},yn.escapeRegExp=function(n){return(n=Le(n))&&on.test(n)?n.replace(un,"\\$&"):n},yn.every=function(n,t,r){var e=Zo(n)?o:at;return r&&Mr(n,t,r)&&(t=Z),e(n,kr(t,3))},yn.find=function(n,t){if(t=kr(t,3),Zo(n)){var r=v(n,t);return r>-1?n[r]:Z}return g(n,t,Hu)},yn.findIndex=function(n,t){return n&&n.length?v(n,kr(t,3)):-1},yn.findKey=function(n,t){return g(n,kr(t,3),pt,!0)},yn.findLast=function(n,t){if(t=kr(t,3),Zo(n)){var r=v(n,t,!0);return r>-1?n[r]:Z}return g(n,t,Qu)},yn.findLastIndex=function(n,t){return n&&n.length?v(n,kr(t,3),!0):-1},yn.findLastKey=function(n,t){return g(n,kr(t,3),_t,!0)},yn.floor=Ai,yn.forEach=re,yn.forEachRight=ee,yn.forIn=function(n,t){return null==n?n:Xu(n,tt(t),Ze)},yn.forInRight=function(n,t){return null==n?n:no(n,tt(t),Ze)},yn.forOwn=function(n,t){return n&&pt(n,tt(t))},yn.forOwnRight=function(n,t){return n&&_t(n,tt(t))},yn.get=$e,yn.gt=_e,yn.gte=function(n,t){return n>=t},yn.has=Fe,yn.hasIn=Ne,yn.head=Gr,yn.identity=Ye,yn.includes=function(n,t,r,e){return n=ve(n)?n:Pe(n),r=r&&!e?Ce(r):0,e=n.length,0>r&&(r=Uu(e+r,0)),Ie(n)?e>=r&&-1<n.indexOf(t,r):!!e&&-1<d(n,t,r)},yn.indexOf=function(n,t,r){var e=n?n.length:0;return e?(r=Ce(r),0>r&&(r=Uu(e+r,0)),d(n,t,r)):-1},yn.inRange=function(n,t,r){return t=ze(t)||0,r===Z?(r=t,t=0):r=ze(r)||0,n=ze(n),n>=zu(t,r)&&n<Uu(t,r)},yn.invoke=Xo,yn.isArguments=ge,yn.isArray=Zo,yn.isArrayBuffer=function(n){return we(n)&&"[object ArrayBuffer]"==pu.call(n)},yn.isArrayLike=ve,yn.isArrayLikeObject=de,yn.isBoolean=function(n){return!0===n||!1===n||we(n)&&"[object Boolean]"==pu.call(n)},yn.isBuffer=qo,yn.isDate=function(n){return we(n)&&"[object Date]"==pu.call(n)},yn.isElement=function(n){return!!n&&1===n.nodeType&&we(n)&&!ke(n)},yn.isEmpty=function(n){if(ve(n)&&(Zo(n)||Ie(n)||be(n.splice)||ge(n)))return!n.length;for(var t in n)if(lu.call(n,t))return!1;return!0},yn.isEqual=function(n,t){return jt(n,t)},yn.isEqualWith=function(n,t,r){var e=(r="function"==typeof r?r:Z)?r(n,t):Z;return e===Z?jt(n,t,r):!!e},yn.isError=ye,yn.isFinite=function(n){return"number"==typeof n&&Wu(n)},yn.isFunction=be,yn.isInteger=xe,yn.isLength=me,yn.isMap=function(n){return we(n)&&"[object Map]"==Rr(n)},yn.isMatch=function(n,t){return n===t||wt(n,t,Er(t))},yn.isMatchWith=function(n,t,r){return r="function"==typeof r?r:Z,wt(n,t,Er(t),r)},yn.isNaN=function(n){return Oe(n)&&n!=+n},yn.isNative=Ae,yn.isNil=function(n){return null==n},yn.isNull=function(n){return null===n},yn.isNumber=Oe,yn.isObject=je,yn.isObjectLike=we,yn.isPlainObject=ke,yn.isRegExp=Ee,yn.isSafeInteger=function(n){return xe(n)&&n>=-9007199254740991&&9007199254740991>=n},yn.isSet=function(n){return we(n)&&"[object Set]"==Rr(n)},yn.isString=Ie,yn.isSymbol=Se,yn.isTypedArray=Re,yn.isUndefined=function(n){return n===Z},yn.isWeakMap=function(n){return we(n)&&"[object WeakMap]"==Rr(n)},yn.isWeakSet=function(n){return we(n)&&"[object WeakSet]"==pu.call(n)},yn.join=function(n,t){return n?Bu.call(n,t):""},yn.kebabCase=oi,yn.last=Vr,yn.lastIndexOf=function(n,t,r){var e=n?n.length:0;if(!e)return-1;var u=e;if(r!==Z&&(u=Ce(r),u=(0>u?Uu(e+u,0):zu(u,e-1))+1),t!==t)return B(n,u,!0);for(;u--;)if(n[u]===t)return u;return-1},yn.lowerCase=ii,yn.lowerFirst=fi,yn.lt=We,yn.lte=function(n,t){return t>=n},yn.max=function(n){return n&&n.length?_(n,Ye,_e):Z},yn.maxBy=function(n,t){return n&&n.length?_(n,kr(t),_e):Z},yn.mean=function(n){return tu(n)/(n?n.length:0)},yn.min=function(n){return n&&n.length?_(n,Ye,We):Z},yn.minBy=function(n,t){return n&&n.length?_(n,kr(t),We):Z},yn.noConflict=function(){return Vn._===this&&(Vn._=_u),this},yn.noop=Xe,yn.now=Co,yn.pad=function(n,t,r){n=Le(n),t=Ce(t);var e=F(n);return t&&t>e?(e=(t-e)/2,t=Ru(e),e=Su(e),vr("",t,r)+n+vr("",e,r)):n},yn.padEnd=function(n,t,r){return n=Le(n),n+vr(n,t,r)},yn.padStart=function(n,t,r){return n=Le(n),vr(n,t,r)+n},yn.parseInt=function(n,t,r){return r||null==t?t=0:t&&(t=+t),n=Le(n).replace(fn,""),Mu(n,t||(pn.test(n)?16:10))},yn.random=function(n,t,r){if(r&&"boolean"!=typeof r&&Mr(n,t,r)&&(t=r=Z),r===Z&&("boolean"==typeof t?(r=t,t=Z):"boolean"==typeof n&&(r=n,n=Z)),n===Z&&t===Z?(n=0,t=1):(n=ze(n)||0,t===Z?(t=n,n=0):t=ze(t)||0),n>t){var e=n;n=t,t=e}return r||n%1||t%1?(r=Lu(),zu(n+r*(t-n+Fn("1e-"+((r+"").length-1))),t)):Lt(n,t)},yn.reduce=function(n,t,r){var e=Zo(n)?s:y,u=3>arguments.length;return e(n,kr(t,4),r,u,Hu)},yn.reduceRight=function(n,t,r){var e=Zo(n)?h:y,u=3>arguments.length;return e(n,kr(t,4),r,u,Qu)},yn.repeat=Ge,yn.replace=function(){var n=arguments,t=Le(n[0]);return 3>n.length?t:t.replace(n[1],n[2])},yn.result=function(n,t,r){if(Lr(t,n))e=null==n?Z:n[t];else{t=rt(t);var e=$e(n,t);n=Zr(n,t)}return e===Z&&(e=r),be(e)?e.call(n):e},yn.round=Oi,yn.runInContext=D,yn.sample=function(n){n=ve(n)?n:Pe(n);var t=n.length;return t>0?n[Lt(0,t-1)]:Z},yn.size=function(n){if(null==n)return 0;if(ve(n)){var t=n.length;return t&&Ie(n)?F(n):t}return De(n).length},yn.snakeCase=ai,yn.some=function(n,t,r){var e=Zo(n)?p:Nt;return r&&Mr(n,t,r)&&(t=Z),e(n,kr(t,3))},yn.sortedIndex=function(n,t){return Dt(n,t)},yn.sortedIndexBy=function(n,t,r){return Zt(n,t,kr(r))},yn.sortedIndexOf=function(n,t){var r=n?n.length:0;if(r){var e=Dt(n,t);if(r>e&&pe(n[e],t))return e}return-1},yn.sortedLastIndex=function(n,t){return Dt(n,t,!0)},yn.sortedLastIndexBy=function(n,t,r){return Zt(n,t,kr(r),!0)},yn.sortedLastIndexOf=function(n,t){if(n&&n.length){var r=Dt(n,t,!0)-1;if(pe(n[r],t))return r}return-1},yn.startCase=li,yn.startsWith=function(n,t,r){return n=Le(n),r=et(Ce(r),0,n.length),n.lastIndexOf(t,r)==r},yn.subtract=function(n,t){var r;return n===Z&&t===Z?0:(n!==Z&&(r=n),t!==Z&&(r=r===Z?t:r-t),r)},yn.sum=tu,yn.sumBy=function(n,t){return n&&n.length?x(n,kr(t)):0},yn.template=function(n,t,r){var e=yn.templateSettings;r&&Mr(n,t,r)&&(t=Z),n=Le(n),t=Ko({},t,e,Kn),r=Ko({},t.imports,e.imports,Kn);var u,o,i=De(r),f=A(r,i),c=0;r=t.interpolate||xn;var a="__p+='";r=ou((t.escape||xn).source+"|"+r.source+"|"+(r===nn?sn:xn).source+"|"+(t.evaluate||xn).source+"|$","g");var l="sourceURL"in t?"//# sourceURL="+t.sourceURL+"\n":"";if(n.replace(r,function(t,r,e,i,f,l){return e||(e=i),a+=n.slice(c,l).replace(mn,W),r&&(u=!0,a+="'+__e("+r+")+'"),f&&(o=!0,a+="';"+f+";\n__p+='"),e&&(a+="'+((__t=("+e+"))==null?'':__t)+'"),c=l+t.length,t}),a+="';",(t=t.variable)||(a="with(obj){"+a+"}"),a=(o?a.replace(T,""):a).replace(K,"$1").replace(G,"$1;"),a="function("+(t||"obj")+"){"+(t?"":"obj||(obj={});")+"var __t,__p=''"+(u?",__e=_.escape":"")+(o?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+a+"return __p}",t=hi(function(){return Function(i,l+"return "+a).apply(Z,f)}),t.source=a,ye(t))throw t;return t},yn.times=function(n,t){if(n=Ce(n),1>n||n>9007199254740991)return[];var r=4294967295,e=zu(n,4294967295);for(t=tt(t),n-=4294967295,e=m(e,t);++r<n;)t(r);return e},yn.toInteger=Ce,yn.toLength=Ue,yn.toLower=function(n){return Le(n).toLowerCase()},yn.toNumber=ze,yn.toSafeInteger=function(n){return et(Ce(n),-9007199254740991,9007199254740991)},yn.toString=Le,yn.toUpper=function(n){return Le(n).toUpperCase()},yn.trim=function(n,t,r){return(n=Le(n))?r||t===Z?n.replace(fn,""):(t+="")?(n=n.match(kn),t=t.match(kn),n.slice(O(n,t),k(n,t)+1).join("")):n:n},yn.trimEnd=function(n,t,r){return(n=Le(n))?r||t===Z?n.replace(an,""):(t+="")?(n=n.match(kn),n.slice(0,k(n,t.match(kn))+1).join("")):n:n},yn.trimStart=function(n,t,r){return(n=Le(n))?r||t===Z?n.replace(cn,""):(t+="")?(n=n.match(kn),n.slice(O(n,t.match(kn))).join("")):n:n},yn.truncate=function(n,t){var r=30,e="...";if(je(t))var u="separator"in t?t.separator:u,r="length"in t?Ce(t.length):r,e="omission"in t?Le(t.omission):e;n=Le(n);var o=n.length;if(En.test(n))var i=n.match(kn),o=i.length;if(r>=o)return n;if(o=r-F(e),1>o)return e;if(r=i?i.slice(0,o).join(""):n.slice(0,o),u===Z)return r+e;if(i&&(o+=r.length-o),Ee(u)){if(n.slice(o).search(u)){var f=r;for(u.global||(u=ou(u.source,Le(hn.exec(u))+"g")),u.lastIndex=0;i=u.exec(f);)var c=i.index;r=r.slice(0,c===Z?o:c)}}else n.indexOf(u,o)!=o&&(u=r.lastIndexOf(u),u>-1&&(r=r.slice(0,u)));return r+e},yn.unescape=function(n){return(n=Le(n))&&Y.test(n)?n.replace(V,N):n},yn.uniqueId=function(n){var t=++su;return Le(n)+t},yn.upperCase=si,yn.upperFirst=ci,yn.each=re,yn.eachRight=ee,yn.first=Gr,Qe(yn,function(){var n={};return pt(yn,function(t,r){lu.call(yn.prototype,r)||(n[r]=t)}),n}(),{chain:!1}),yn.VERSION="4.5.1",u("bind bindKey curry curryRight partial partialRight".split(" "),function(n){yn[n].placeholder=yn}),u(["drop","take"],function(n,t){An.prototype[n]=function(r){var e=this.__filtered__;if(e&&!t)return new An(this);r=r===Z?1:Uu(Ce(r),0);var u=this.clone();return e?u.__takeCount__=zu(r,u.__takeCount__):u.__views__.push({size:zu(r,4294967295),type:n+(0>u.__dir__?"Right":"")}),u},An.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse()}}),u(["filter","map","takeWhile"],function(n,t){var r=t+1,e=1==r||3==r;An.prototype[n]=function(n){var t=this.clone();return t.__iteratees__.push({iteratee:kr(n,3),type:r}),t.__filtered__=t.__filtered__||e,t}}),u(["head","last"],function(n,t){var r="take"+(t?"Right":"");An.prototype[n]=function(){return this[r](1).value()[0]}}),u(["initial","tail"],function(n,t){var r="drop"+(t?"":"Right");An.prototype[n]=function(){return this.__filtered__?new An(this):this[r](1)}}),An.prototype.compact=function(){return this.filter(Ye)},An.prototype.find=function(n){return this.filter(n).head()},An.prototype.findLast=function(n){return this.reverse().find(n)},An.prototype.invokeMap=he(function(n,t){return"function"==typeof n?new An(this):this.map(function(r){return mt(r,n,t)})}),An.prototype.reject=function(n){return n=kr(n,3),this.filter(function(t){return!n(t)})},An.prototype.slice=function(n,t){n=Ce(n);var r=this;return r.__filtered__&&(n>0||0>t)?new An(r):(0>n?r=r.takeRight(-n):n&&(r=r.drop(n)),t!==Z&&(t=Ce(t),r=0>t?r.dropRight(-t):r.take(t-n)),r)},An.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},An.prototype.toArray=function(){return this.take(4294967295)},pt(An.prototype,function(n,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),e=/^(?:head|last)$/.test(t),u=yn[e?"take"+("last"==t?"Right":""):t],o=e||/^find/.test(t);u&&(yn.prototype[t]=function(){var t=this.__wrapped__,i=e?[1]:arguments,f=t instanceof An,c=i[0],a=f||Zo(t),s=function(n){return n=u.apply(yn,l([n],i)),e&&h?n[0]:n};a&&r&&"function"==typeof c&&1!=c.length&&(f=a=!1);var h=this.__chain__,p=!!this.__actions__.length,c=o&&!h,f=f&&!p;return!o&&a?(t=f?t:new An(this),t=n.apply(t,i),t.__actions__.push({func:ne,args:[s],thisArg:Z}),new wn(t,h)):c&&f?n.apply(this,i):(t=this.thru(s),c?e?t.value()[0]:t.value():t)})}),u("pop push shift sort splice unshift".split(" "),function(n){var t=fu[n],r=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",e=/^(?:pop|shift)$/.test(n);yn.prototype[n]=function(){var n=arguments;return e&&!this.__chain__?t.apply(this.value(),n):this[r](function(r){return t.apply(r,n)})}}),pt(An.prototype,function(n,t){var r=yn[t];if(r){var e=r.name+"";(Yu[e]||(Yu[e]=[])).push({name:t,func:r})}}),Yu[pr(Z,2).name]=[{name:"wrapper",func:Z}],An.prototype.clone=function(){var n=new An(this.__wrapped__);return n.__actions__=Xt(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=Xt(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=Xt(this.__views__),n},An.prototype.reverse=function(){if(this.__filtered__){var n=new An(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n},An.prototype.value=function(){var n,t=this.__wrapped__.value(),r=this.__dir__,e=Zo(t),u=0>r,o=e?t.length:0;n=0;for(var i=o,f=this.__views__,c=-1,a=f.length;++c<a;){var l=f[c],s=l.size;switch(l.type){case"drop":n+=s;break;case"dropRight":i-=s;break;case"take":i=zu(i,n+s);break;case"takeRight":n=Uu(n,i-s)}}if(n={start:n,end:i},i=n.start,f=n.end,n=f-i,u=u?f:i-1,i=this.__iteratees__,f=i.length,c=0,a=zu(n,this.__takeCount__),!e||200>o||o==n&&a==n)return Kt(t,this.__actions__);e=[];n:for(;n--&&a>c;){for(u+=r,o=-1,l=t[u];++o<f;){var h=i[o],s=h.type,h=h.iteratee(l);if(2==s)l=h;else if(!h){if(1==s)continue n;break n}}e[c++]=l}return e},yn.prototype.at=ko,yn.prototype.chain=function(){return Xr(this)},yn.prototype.commit=function(){return new wn(this.value(),this.__chain__)},yn.prototype.flatMap=function(n){return this.map(n).flatten()},yn.prototype.next=function(){this.__values__===Z&&(this.__values__=Be(this.value()));var n=this.__index__>=this.__values__.length,t=n?Z:this.__values__[this.__index__++];return{done:n,value:t}},yn.prototype.plant=function(n){for(var t,r=this;r instanceof jn;){var e=Pr(r);e.__index__=0,e.__values__=Z,t?u.__wrapped__=e:t=e;var u=e,r=r.__wrapped__}return u.__wrapped__=n,t},yn.prototype.reverse=function(){var n=this.__wrapped__;return n instanceof An?(this.__actions__.length&&(n=new An(this)),n=n.reverse(),n.__actions__.push({func:ne,args:[Yr],thisArg:Z}),new wn(n,this.__chain__)):this.thru(Yr)},yn.prototype.toJSON=yn.prototype.valueOf=yn.prototype.value=function(){return Kt(this.__wrapped__,this.__actions__)},Au&&(yn.prototype[Au]=te),yn}var Z,q=1/0,P=NaN,T=/\b__p\+='';/g,K=/\b(__p\+=)''\+/g,G=/(__e\(.*?\)|\b__t\))\+'';/g,V=/&(?:amp|lt|gt|quot|#39|#96);/g,J=/[&<>"'`]/g,Y=RegExp(V.source),H=RegExp(J.source),Q=/<%-([\s\S]+?)%>/g,X=/<%([\s\S]+?)%>/g,nn=/<%=([\s\S]+?)%>/g,tn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rn=/^\w*$/,en=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,un=/[\\^$.*+?()[\]{}|]/g,on=RegExp(un.source),fn=/^\s+|\s+$/g,cn=/^\s+/,an=/\s+$/,ln=/\\(\\)?/g,sn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,hn=/\w*$/,pn=/^0x/i,_n=/^[-+]0x[0-9a-f]+$/i,gn=/^0b[01]+$/i,vn=/^\[object .+?Constructor\]$/,dn=/^0o[0-7]+$/i,yn=/^(?:0|[1-9]\d*)$/,bn=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,xn=/($^)/,mn=/['\n\r\u2028\u2029\\]/g,jn="[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?(?:\\u200d(?:[^\\ud800-\\udfff]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?)*",wn="(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])"+jn,An="(?:[^\\ud800-\\udfff][\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]?|[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\ud800-\\udfff])",On=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]","g"),kn=RegExp("\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|"+An+jn,"g"),En=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),In=/[a-zA-Z0-9]+/g,Sn=RegExp(["[A-Z\\xc0-\\xd6\\xd8-\\xde]?[a-z\\xdf-\\xf6\\xf8-\\xff]+(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2018\\u2019\\u201c\\u201d \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde]|$)|(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2018\\u2019\\u201c\\u201d \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2018\\u2019\\u201c\\u201d \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde](?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2018\\u2019\\u201c\\u201d \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])|$)|[A-Z\\xc0-\\xd6\\xd8-\\xde]?(?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2018\\u2019\\u201c\\u201d \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+|[A-Z\\xc0-\\xd6\\xd8-\\xde]+|\\d+",wn].join("|"),"g"),Rn=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Wn="Array Buffer Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Map Math Object Reflect RegExp Set String Symbol TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap _ clearTimeout isFinite parseInt setTimeout".split(" "),Bn={};Bn["[object Float32Array]"]=Bn["[object Float64Array]"]=Bn["[object Int8Array]"]=Bn["[object Int16Array]"]=Bn["[object Int32Array]"]=Bn["[object Uint8Array]"]=Bn["[object Uint8ClampedArray]"]=Bn["[object Uint16Array]"]=Bn["[object Uint32Array]"]=!0,Bn["[object Arguments]"]=Bn["[object Array]"]=Bn["[object ArrayBuffer]"]=Bn["[object Boolean]"]=Bn["[object Date]"]=Bn["[object Error]"]=Bn["[object Function]"]=Bn["[object Map]"]=Bn["[object Number]"]=Bn["[object Object]"]=Bn["[object RegExp]"]=Bn["[object Set]"]=Bn["[object String]"]=Bn["[object WeakMap]"]=!1;var Cn={};Cn["[object Arguments]"]=Cn["[object Array]"]=Cn["[object ArrayBuffer]"]=Cn["[object Boolean]"]=Cn["[object Date]"]=Cn["[object Float32Array]"]=Cn["[object Float64Array]"]=Cn["[object Int8Array]"]=Cn["[object Int16Array]"]=Cn["[object Int32Array]"]=Cn["[object Map]"]=Cn["[object Number]"]=Cn["[object Object]"]=Cn["[object RegExp]"]=Cn["[object Set]"]=Cn["[object String]"]=Cn["[object Symbol]"]=Cn["[object Uint8Array]"]=Cn["[object Uint8ClampedArray]"]=Cn["[object Uint16Array]"]=Cn["[object Uint32Array]"]=!0,Cn["[object Error]"]=Cn["[object Function]"]=Cn["[object WeakMap]"]=!1;var Un={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},zn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Mn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Ln={"function":!0,object:!0},$n={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Fn=parseFloat,Nn=parseInt,Dn=Ln[typeof exports]&&exports&&!exports.nodeType?exports:Z,Zn=Ln[typeof module]&&module&&!module.nodeType?module:Z,qn=Zn&&Zn.exports===Dn?Dn:Z,Pn=E(Dn&&Zn&&"object"==typeof global&&global),Tn=E(Ln[typeof self]&&self),Kn=E(Ln[typeof window]&&window),Gn=E(Ln[typeof this]&&this),Vn=Pn||Kn!==(Gn&&Gn.window)&&Kn||Tn||Gn||Function("return this")(),Jn=D();(Kn||Tn||{})._=Jn,"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return Jn}):Dn&&Zn?(qn&&((Zn.exports=Jn)._=Jn),Dn._=Jn):Vn._=Jn}).call(this),function(window,angular,undefined){"use strict";(function(){angular.module("uiGmapgoogle-maps.providers",[]),angular.module("uiGmapgoogle-maps.wrapped",[]),angular.module("uiGmapgoogle-maps.extensions",["uiGmapgoogle-maps.wrapped","uiGmapgoogle-maps.providers"]),angular.module("uiGmapgoogle-maps.directives.api.utils",["uiGmapgoogle-maps.extensions"]),angular.module("uiGmapgoogle-maps.directives.api.managers",[]),angular.module("uiGmapgoogle-maps.directives.api.options",["uiGmapgoogle-maps.directives.api.utils"]),angular.module("uiGmapgoogle-maps.directives.api.options.builders",[]),angular.module("uiGmapgoogle-maps.directives.api.models.child",["uiGmapgoogle-maps.directives.api.utils","uiGmapgoogle-maps.directives.api.options","uiGmapgoogle-maps.directives.api.options.builders"]),angular.module("uiGmapgoogle-maps.directives.api.models.parent",["uiGmapgoogle-maps.directives.api.managers","uiGmapgoogle-maps.directives.api.models.child","uiGmapgoogle-maps.providers"]),angular.module("uiGmapgoogle-maps.directives.api",["uiGmapgoogle-maps.directives.api.models.parent"]),angular.module("uiGmapgoogle-maps",["uiGmapgoogle-maps.directives.api","uiGmapgoogle-maps.providers"])}).call(this),function(){angular.module("uiGmapgoogle-maps.providers").factory("uiGmapMapScriptLoader",["$q","uiGmapuuid",function($q,uuid){
var getScriptUrl,includeScript,isGoogleMapsLoaded,scriptId;return scriptId=void 0,getScriptUrl=function(options){return options.china?"http://maps.google.cn/maps/api/js?":"auto"===options.transport?"//maps.googleapis.com/maps/api/js?":options.transport+"://maps.googleapis.com/maps/api/js?"},includeScript=function(options){var omitOptions,query,script;return omitOptions=["transport","isGoogleMapsForWork","china"],options.isGoogleMapsForWork&&omitOptions.push("key"),query=_.map(_.omit(options,omitOptions),function(v,k){return k+"="+v}),scriptId&&document.getElementById(scriptId).remove(),query=query.join("&"),script=document.createElement("script"),script.id=scriptId="ui_gmap_map_load_"+uuid.generate(),script.type="text/javascript",script.src=getScriptUrl(options)+query,document.body.appendChild(script)},isGoogleMapsLoaded=function(){return angular.isDefined(window.google)&&angular.isDefined(window.google.maps)},{load:function(options){var deferred,randomizedFunctionName;return deferred=$q.defer(),isGoogleMapsLoaded()?(deferred.resolve(window.google.maps),deferred.promise):(randomizedFunctionName=options.callback="onGoogleMapsReady"+Math.round(1e3*Math.random()),window[randomizedFunctionName]=function(){window[randomizedFunctionName]=null,deferred.resolve(window.google.maps)},window.navigator.connection&&window.Connection&&window.navigator.connection.type===window.Connection.NONE?document.addEventListener("online",function(){return isGoogleMapsLoaded()?void 0:includeScript(options)}):includeScript(options),deferred.promise)}}}]).provider("uiGmapGoogleMapApi",function(){return this.options={transport:"https",isGoogleMapsForWork:!1,china:!1,v:"3",libraries:"",language:"en",sensor:"false"},this.configure=function(options){angular.extend(this.options,options)},this.$get=["uiGmapMapScriptLoader",function(_this){return function(loader){return loader.load(_this.options)}}(this)],this})}.call(this),function(){angular.module("uiGmapgoogle-maps.extensions").service("uiGmapExtendGWin",function(){return{init:_.once(function(){return google||("undefined"!=typeof google&&null!==google?google.maps:void 0)||null!=google.maps.InfoWindow?(google.maps.InfoWindow.prototype._open=google.maps.InfoWindow.prototype.open,google.maps.InfoWindow.prototype._close=google.maps.InfoWindow.prototype.close,google.maps.InfoWindow.prototype._isOpen=!1,google.maps.InfoWindow.prototype.open=function(map,anchor,recurse){null==recurse&&(this._isOpen=!0,this._open(map,anchor,!0))},google.maps.InfoWindow.prototype.close=function(recurse){null==recurse&&(this._isOpen=!1,this._close(!0))},google.maps.InfoWindow.prototype.isOpen=function(val){return null==val&&(val=void 0),null==val?this._isOpen:this._isOpen=val},window.InfoBox&&(window.InfoBox.prototype._open=window.InfoBox.prototype.open,window.InfoBox.prototype._close=window.InfoBox.prototype.close,window.InfoBox.prototype._isOpen=!1,window.InfoBox.prototype.open=function(map,anchor){this._isOpen=!0,this._open(map,anchor)},window.InfoBox.prototype.close=function(){this._isOpen=!1,this._close()},window.InfoBox.prototype.isOpen=function(val){return null==val&&(val=void 0),null==val?this._isOpen:this._isOpen=val}),window.MarkerLabel_?window.MarkerLabel_.prototype.setContent=function(){var content;content=this.marker_.get("labelContent"),content&&!_.isEqual(this.oldContent,content)&&("undefined"==typeof(null!=content?content.nodeType:void 0)?(this.labelDiv_.innerHTML=content,this.eventDiv_.innerHTML=this.labelDiv_.innerHTML,this.oldContent=content):(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(content),content=content.cloneNode(!0),this.labelDiv_.innerHTML="",this.eventDiv_.appendChild(content),this.oldContent=content))}:void 0):void 0})}})}.call(this),function(){angular.module("uiGmapgoogle-maps.extensions").service("uiGmapLodash",function(){return this.intersectionObjects=function(array1,array2,comparison){var res;return null==comparison&&(comparison=void 0),res=_.map(array1,function(_this){return function(obj1){return _.find(array2,function(obj2){return null!=comparison?comparison(obj1,obj2):_.isEqual(obj1,obj2)})}}(this)),_.filter(res,function(o){return null!=o})},this.containsObject=_.includeObject=function(obj,target,comparison){return null==comparison&&(comparison=void 0),null===obj?!1:_.any(obj,function(_this){return function(value){return null!=comparison?comparison(value,target):_.isEqual(value,target)}}(this))},this.differenceObjects=function(array1,array2,comparison){return null==comparison&&(comparison=void 0),_.filter(array1,function(_this){return function(value){return!_this.containsObject(array2,value,comparison)}}(this))},this.withoutObjects=this.differenceObjects,this.indexOfObject=function(array,item,comparison,isSorted){var i,length;if(null==array)return-1;if(i=0,length=array.length,isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,length+isSorted):isSorted}for(;length>i;){if(null!=comparison){if(comparison(array[i],item))return i}else if(_.isEqual(array[i],item))return i;i++}return-1},this.isNullOrUndefined=function(thing){return _.isNull(thing||_.isUndefined(thing))},this})}.call(this),function(){angular.module("uiGmapgoogle-maps.extensions").factory("uiGmapString",function(){return function(str){return this.contains=function(value,fromIndex){return-1!==str.indexOf(value,fromIndex)},this}})}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmap_sync",[function(){return{fakePromise:function(){var _cb;return _cb=void 0,{then:function(cb){return _cb=cb},resolve:function(){return _cb.apply(void 0,arguments)}}}}}]).service("uiGmap_async",["$timeout","uiGmapPromise","uiGmapLogger","$q","uiGmapDataStructures","uiGmapGmapUtil",function($timeout,uiGmapPromise,$log,$q,uiGmapDataStructures,uiGmapGmapUtil){var ExposedPromise,PromiseQueueManager,SniffedPromise,_getArrayAndKeys,_getIterateeValue,defaultChunkSize,doChunk,doSkippPromise,each,errorObject,isInProgress,kickPromise,logTryCatch,managePromiseQueue,map,maybeCancelPromises,promiseStatus,promiseTypes,tryCatch;return promiseTypes=uiGmapPromise.promiseTypes,isInProgress=uiGmapPromise.isInProgress,promiseStatus=uiGmapPromise.promiseStatus,ExposedPromise=uiGmapPromise.ExposedPromise,SniffedPromise=uiGmapPromise.SniffedPromise,kickPromise=function(sniffedPromise,cancelCb){var promise;return promise=sniffedPromise.promise(),promise.promiseType=sniffedPromise.promiseType,promise.$$state&&$log.debug("promiseType: "+promise.promiseType+", state: "+promiseStatus(promise.$$state.status)),promise.cancelCb=cancelCb,promise},doSkippPromise=function(sniffedPromise,lastPromise){return sniffedPromise.promiseType===promiseTypes.create&&lastPromise.promiseType!==promiseTypes["delete"]&&lastPromise.promiseType!==promiseTypes.init?($log.debug("lastPromise.promiseType "+lastPromise.promiseType+", newPromiseType: "+sniffedPromise.promiseType+", SKIPPED MUST COME AFTER DELETE ONLY"),!0):!1},maybeCancelPromises=function(queue,sniffedPromise,lastPromise){var first;return sniffedPromise.promiseType===promiseTypes["delete"]&&lastPromise.promiseType!==promiseTypes["delete"]&&null!=lastPromise.cancelCb&&_.isFunction(lastPromise.cancelCb)&&isInProgress(lastPromise)&&($log.debug("promiseType: "+sniffedPromise.promiseType+", CANCELING LAST PROMISE type: "+lastPromise.promiseType),lastPromise.cancelCb("cancel safe"),first=queue.peek(),null!=first&&isInProgress(first))?first.hasOwnProperty("cancelCb")&&_.isFunction(first.cancelCb)?($log.debug("promiseType: "+first.promiseType+", CANCELING FIRST PROMISE type: "+first.promiseType),first.cancelCb("cancel safe")):$log.warn("first promise was not cancelable"):void 0},PromiseQueueManager=function(existingPiecesObj,sniffedPromise,cancelCb){var lastPromise,newPromise;if(existingPiecesObj.existingPieces){if(lastPromise=_.last(existingPiecesObj.existingPieces._content),doSkippPromise(sniffedPromise,lastPromise))return;return maybeCancelPromises(existingPiecesObj.existingPieces,sniffedPromise,lastPromise),newPromise=ExposedPromise(lastPromise["finally"](function(){return kickPromise(sniffedPromise,cancelCb)})),newPromise.cancelCb=cancelCb,newPromise.promiseType=sniffedPromise.promiseType,existingPiecesObj.existingPieces.enqueue(newPromise),lastPromise["finally"](function(){return existingPiecesObj.existingPieces.dequeue()})}return existingPiecesObj.existingPieces=new uiGmapDataStructures.Queue,existingPiecesObj.existingPieces.enqueue(kickPromise(sniffedPromise,cancelCb))},managePromiseQueue=function(objectToLock,promiseType,msg,cancelCb,fnPromise){var cancelLogger;return null==msg&&(msg=""),cancelLogger=function(msg){return $log.debug(msg+": "+msg),null!=cancelCb&&_.isFunction(cancelCb)?cancelCb(msg):void 0},PromiseQueueManager(objectToLock,SniffedPromise(fnPromise,promiseType),cancelLogger)},defaultChunkSize=80,errorObject={value:null},tryCatch=function(fn,ctx,args){var e;try{return fn.apply(ctx,args)}catch(_error){return e=_error,errorObject.value=e,errorObject}},logTryCatch=function(fn,ctx,deferred,args){var msg,result;return result=tryCatch(fn,ctx,args),result===errorObject&&(msg="error within chunking iterator: "+errorObject.value,$log.error(msg),deferred.reject(msg)),"cancel safe"===result?!1:!0},_getIterateeValue=function(collection,array,index){var _isArray,valOrKey;return _isArray=collection===array,valOrKey=array[index],_isArray?valOrKey:collection[valOrKey]},_getArrayAndKeys=function(collection,keys,bailOutCb,cb){var array;return angular.isArray(collection)?array=collection:(array=keys?keys:Object.keys(_.omit(collection,["length","forEach","map"])),keys=array),null==cb&&(cb=bailOutCb),angular.isArray(array)&&(void 0===array||(null!=array?array.length:void 0)<=0)&&cb!==bailOutCb?bailOutCb():cb(array,keys)},doChunk=function(collection,chunkSizeOrDontChunk,pauseMilli,chunkCb,pauseCb,overallD,index,_keys){return _getArrayAndKeys(collection,_keys,function(array,keys){var cnt,i,keepGoing,val;for(cnt=chunkSizeOrDontChunk&&chunkSizeOrDontChunk<array.length?chunkSizeOrDontChunk:array.length,i=index,keepGoing=!0;keepGoing&&cnt--&&i<(array?array.length:i+1);)val=_getIterateeValue(collection,array,i),keepGoing=angular.isFunction(val)?!0:logTryCatch(chunkCb,void 0,overallD,[val,i]),++i;if(array){if(!(keepGoing&&i<array.length))return overallD.resolve();if(index=i,chunkSizeOrDontChunk)return null!=pauseCb&&_.isFunction(pauseCb)&&logTryCatch(pauseCb,void 0,overallD,[]),$timeout(function(){return doChunk(collection,chunkSizeOrDontChunk,pauseMilli,chunkCb,pauseCb,overallD,index,keys)},pauseMilli,!1)}})},each=function(collection,chunk,chunkSizeOrDontChunk,pauseCb,index,pauseMilli,_keys){var error,overallD,ret;return null==chunkSizeOrDontChunk&&(chunkSizeOrDontChunk=defaultChunkSize),null==index&&(index=0),null==pauseMilli&&(pauseMilli=1),ret=void 0,overallD=uiGmapPromise.defer(),ret=overallD.promise,pauseMilli?_getArrayAndKeys(collection,_keys,function(){return overallD.resolve(),ret},function(array,keys){return doChunk(collection,chunkSizeOrDontChunk,pauseMilli,chunk,pauseCb,overallD,index,keys),ret}):(error="pause (delay) must be set from _async!",$log.error(error),overallD.reject(error),ret)},map=function(collection,iterator,chunkSizeOrDontChunk,pauseCb,index,pauseMilli,_keys){var results;return results=[],_getArrayAndKeys(collection,_keys,function(){return uiGmapPromise.resolve(results)},function(array,keys){return each(collection,function(o){return results.push(iterator(o))},chunkSizeOrDontChunk,pauseCb,index,pauseMilli,keys).then(function(){return results})})},{each:each,map:map,managePromiseQueue:managePromiseQueue,promiseLock:managePromiseQueue,defaultChunkSize:defaultChunkSize,chunkSizeFrom:function(fromSize,ret){return null==ret&&(ret=void 0),_.isNumber(fromSize)&&(ret=fromSize),(uiGmapGmapUtil.isFalse(fromSize)||fromSize===!1)&&(ret=!1),ret}}}])}.call(this),function(){var indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapBaseObject",function(){var BaseObject,baseObjectKeywords;return baseObjectKeywords=["extended","included"],BaseObject=function(){function BaseObject(){}return BaseObject.extend=function(obj){var key,ref,value;for(key in obj)value=obj[key],indexOf.call(baseObjectKeywords,key)<0&&(this[key]=value);return null!=(ref=obj.extended)&&ref.apply(this),this},BaseObject.include=function(obj){var key,ref,value;for(key in obj)value=obj[key],indexOf.call(baseObjectKeywords,key)<0&&(this.prototype[key]=value);return null!=(ref=obj.included)&&ref.apply(this),this},BaseObject}()})}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapChildEvents",function(){return{onChildCreation:function(child){}}})}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapCtrlHandle",["$q",function($q){var CtrlHandle;return CtrlHandle={handle:function($scope,$element){return $scope.$on("$destroy",function(){return CtrlHandle.handle($scope)}),$scope.deferred=$q.defer(),{getScope:function(){return $scope}}},mapPromise:function(scope,ctrl){var mapScope;return mapScope=ctrl.getScope(),mapScope.deferred.promise.then(function(map){return scope.map=map}),mapScope.deferred.promise}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapEventsHelper",["uiGmapLogger",function($log){var _getEventsObj,_hasEvents;return _hasEvents=function(obj){return angular.isDefined(obj.events)&&null!=obj.events&&angular.isObject(obj.events)},_getEventsObj=function(scope,model){return _hasEvents(scope)?scope:_hasEvents(model)?model:void 0},{setEvents:function(gObject,scope,model,ignores){var eventObj;return eventObj=_getEventsObj(scope,model),null!=eventObj?_.compact(_.map(eventObj.events,function(eventHandler,eventName){var doIgnore;return ignores&&(doIgnore=_(ignores).contains(eventName)),eventObj.events.hasOwnProperty(eventName)&&angular.isFunction(eventObj.events[eventName])&&!doIgnore?google.maps.event.addListener(gObject,eventName,function(){return scope.$evalAsync||(scope.$evalAsync=function(){}),scope.$evalAsync(eventHandler.apply(scope,[gObject,eventName,model,arguments]))}):void 0})):void 0},removeEvents:function(listeners){return listeners?listeners.forEach(function(l){return l?google.maps.event.removeListener(l):void 0}):void 0}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapFitHelper",["uiGmapLogger","uiGmap_async",function($log,_async){return{fit:function(gMarkers,gMap){var bounds,everSet;return gMap&&gMarkers&&gMarkers.length>0&&(bounds=new google.maps.LatLngBounds,everSet=!1,gMarkers.forEach(function(_this){return function(gMarker){return gMarker?(everSet||(everSet=!0),bounds.extend(gMarker.getPosition())):void 0}}(this)),everSet)?gMap.fitBounds(bounds):void 0}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapGmapUtil",["uiGmapLogger","$compile",function(Logger,$compile){var _isFalse,_isTruthy,getCoords,getLatitude,getLongitude,validateCoords;return _isTruthy=function(value,bool,optionsArray){return value===bool||-1!==optionsArray.indexOf(value)},_isFalse=function(value){return _isTruthy(value,!1,["false","FALSE",0,"n","N","no","NO"])},getLatitude=function(value){return Array.isArray(value)&&2===value.length?value[1]:angular.isDefined(value.type)&&"Point"===value.type?value.coordinates[1]:value.latitude},getLongitude=function(value){return Array.isArray(value)&&2===value.length?value[0]:angular.isDefined(value.type)&&"Point"===value.type?value.coordinates[0]:value.longitude},getCoords=function(value){return value?Array.isArray(value)&&2===value.length?new google.maps.LatLng(value[1],value[0]):angular.isDefined(value.type)&&"Point"===value.type?new google.maps.LatLng(value.coordinates[1],value.coordinates[0]):new google.maps.LatLng(value.latitude,value.longitude):void 0},validateCoords=function(coords){if(angular.isUndefined(coords))return!1;if(_.isArray(coords)){if(2===coords.length)return!0}else if(null!=coords&&(null!=coords?coords.type:void 0)&&"Point"===coords.type&&_.isArray(coords.coordinates)&&2===coords.coordinates.length)return!0;return coords&&angular.isDefined((null!=coords?coords.latitude:void 0)&&angular.isDefined(null!=coords?coords.longitude:void 0))?!0:!1},{setCoordsFromEvent:function(prevValue,newLatLon){return prevValue?(Array.isArray(prevValue)&&2===prevValue.length?(prevValue[1]=newLatLon.lat(),prevValue[0]=newLatLon.lng()):angular.isDefined(prevValue.type)&&"Point"===prevValue.type?(prevValue.coordinates[1]=newLatLon.lat(),prevValue.coordinates[0]=newLatLon.lng()):(prevValue.latitude=newLatLon.lat(),prevValue.longitude=newLatLon.lng()),prevValue):void 0},getLabelPositionPoint:function(anchor){var xPos,yPos;return void 0===anchor?void 0:(anchor=/^([-\d\.]+)\s([-\d\.]+)$/.exec(anchor),xPos=parseFloat(anchor[1]),yPos=parseFloat(anchor[2]),null!=xPos&&null!=yPos?new google.maps.Point(xPos,yPos):void 0)},createWindowOptions:function(gMarker,scope,content,defaults){var options;return null!=content&&null!=defaults&&null!=$compile?(options=angular.extend({},defaults,{content:this.buildContent(scope,defaults,content),position:null!=defaults.position?defaults.position:angular.isObject(gMarker)?gMarker.getPosition():getCoords(scope.coords)}),null!=gMarker&&null==(null!=options?options.pixelOffset:void 0)&&(null==options.boxClass||(options.pixelOffset={height:0,width:-2})),options):defaults?defaults:(Logger.error("infoWindow defaults not defined"),content?void 0:Logger.error("infoWindow content not defined"))},buildContent:function(scope,defaults,content){var parsed,ret;return null!=defaults.content?ret=defaults.content:null!=$compile?(content=content.replace(/^\s+|\s+$/g,""),parsed=""===content?"":$compile(content)(scope),parsed.length>0&&(ret=parsed[0])):ret=content,ret},defaultDelay:50,isTrue:function(value){return _isTruthy(value,!0,["true","TRUE",1,"y","Y","yes","YES"])},isFalse:_isFalse,isFalsy:function(value){return _isTruthy(value,!1,[void 0,null])||_isFalse(value)},getCoords:getCoords,validateCoords:validateCoords,equalCoords:function(coord1,coord2){return getLatitude(coord1)===getLatitude(coord2)&&getLongitude(coord1)===getLongitude(coord2)},validatePath:function(path){var array,i,polygon,trackMaxVertices;if(i=0,angular.isUndefined(path.type)){if(!Array.isArray(path)||path.length<2)return!1;for(;i<path.length;){if(!(angular.isDefined(path[i].latitude)&&angular.isDefined(path[i].longitude)||"function"==typeof path[i].lat&&"function"==typeof path[i].lng))return!1;i++}return!0}if(angular.isUndefined(path.coordinates))return!1;if("Polygon"===path.type){if(path.coordinates[0].length<4)return!1;array=path.coordinates[0]}else if("MultiPolygon"===path.type){if(trackMaxVertices={max:0,index:0},_.forEach(path.coordinates,function(polygon,index){return polygon[0].length>this.max?(this.max=polygon[0].length,this.index=index):void 0},trackMaxVertices),polygon=path.coordinates[trackMaxVertices.index],array=polygon[0],array.length<4)return!1}else{if("LineString"!==path.type)return!1;if(path.coordinates.length<2)return!1;array=path.coordinates}for(;i<array.length;){if(2!==array[i].length)return!1;i++}return!0},convertPathPoints:function(path){var array,i,latlng,result,trackMaxVertices;if(i=0,result=new google.maps.MVCArray,angular.isUndefined(path.type))for(;i<path.length;)angular.isDefined(path[i].latitude)&&angular.isDefined(path[i].longitude)?latlng=new google.maps.LatLng(path[i].latitude,path[i].longitude):"function"==typeof path[i].lat&&"function"==typeof path[i].lng&&(latlng=path[i]),result.push(latlng),i++;else for("Polygon"===path.type?array=path.coordinates[0]:"MultiPolygon"===path.type?(trackMaxVertices={max:0,index:0},_.forEach(path.coordinates,function(polygon,index){return polygon[0].length>this.max?(this.max=polygon[0].length,this.index=index):void 0},trackMaxVertices),array=path.coordinates[trackMaxVertices.index][0]):"LineString"===path.type&&(array=path.coordinates);i<array.length;)result.push(new google.maps.LatLng(array[i][1],array[i][0])),i++;return result},extendMapBounds:function(map,points){var bounds,i;for(bounds=new google.maps.LatLngBounds,i=0;i<points.length;)bounds.extend(points.getAt(i)),i++;return map.fitBounds(bounds)},getPath:function(object,key){var obj;return null!=key&&_.isString(key)?(obj=object,_.each(key.split("."),function(value){return obj?obj=obj[value]:void 0}),obj):key},validateBoundPoints:function(bounds){return angular.isUndefined(bounds.sw.latitude)||angular.isUndefined(bounds.sw.longitude)||angular.isUndefined(bounds.ne.latitude)||angular.isUndefined(bounds.ne.longitude)?!1:!0},convertBoundPoints:function(bounds){var result;return result=new google.maps.LatLngBounds(new google.maps.LatLng(bounds.sw.latitude,bounds.sw.longitude),new google.maps.LatLng(bounds.ne.latitude,bounds.ne.longitude))},fitMapBounds:function(map,bounds){return map.fitBounds(bounds)}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapIsReady",["$q","$timeout",function($q,$timeout){var _checkIfReady,_ctr,_currentCheckNum,_maxCtrChecks,_promises,_proms;return _ctr=0,_proms=[],_currentCheckNum=1,_maxCtrChecks=50,_promises=function(){return $q.all(_proms)},_checkIfReady=function(deferred,expectedInstances){return $timeout(function(){return _currentCheckNum>=_maxCtrChecks&&deferred.reject("Your maps are not found we have checked the maximum amount of times. :)"),_currentCheckNum+=1,_ctr!==expectedInstances?_checkIfReady(deferred,expectedInstances):deferred.resolve(_promises())},100)},{spawn:function(){var d;return d=$q.defer(),_proms.push(d.promise),_ctr+=1,{instance:_ctr,deferred:d}},promises:_promises,instances:function(){return _ctr},promise:function(expectedInstances){var d;return null==expectedInstances&&(expectedInstances=1),d=$q.defer(),_checkIfReady(d,expectedInstances),d.promise},reset:function(){_ctr=0,_proms.length=0},decrement:function(){_ctr>0&&(_ctr-=1),_proms.length&&(_proms.length-=1)}}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapLinked",["uiGmapBaseObject",function(BaseObject){var Linked;return Linked=function(superClass){function Linked(scope,element,attrs,ctrls){this.scope=scope,this.element=element,this.attrs=attrs,this.ctrls=ctrls}return extend(Linked,superClass),Linked}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapLogger",["$log",function($log){var LEVELS,Logger,log,maybeExecLevel;return LEVELS={log:1,info:2,debug:3,warn:4,error:5,none:6},maybeExecLevel=function(level,current,fn){return level>=current?fn():void 0},log=function(logLevelFnName,msg){return null!=$log?$log[logLevelFnName](msg):console[logLevelFnName](msg)},new(Logger=function(){function Logger(){var logFns;this.doLog=!0,logFns={},["log","info","debug","warn","error"].forEach(function(_this){return function(level){return logFns[level]=function(msg){return _this.doLog?maybeExecLevel(LEVELS[level],_this.currentLevel,function(){return log(level,msg)}):void 0}}}(this)),this.LEVELS=LEVELS,this.currentLevel=LEVELS.error,this.log=logFns.log,this.info=logFns.info,this.debug=logFns.debug,this.warn=logFns.warn,this.error=logFns.error}return Logger.prototype.spawn=function(){return new Logger},Logger.prototype.setLog=function(someLogger){return $log=someLogger},Logger}())}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapModelKey",["uiGmapBaseObject","uiGmapGmapUtil","uiGmapPromise","$q","$timeout",function(BaseObject,GmapUtil,uiGmapPromise,$q,$timeout){var ModelKey;return ModelKey=function(superClass){function ModelKey(scope1){this.scope=scope1,this.modelsLength=bind(this.modelsLength,this),this.updateChild=bind(this.updateChild,this),this.destroy=bind(this.destroy,this),this.onDestroy=bind(this.onDestroy,this),this.setChildScope=bind(this.setChildScope,this),this.getChanges=bind(this.getChanges,this),this.getProp=bind(this.getProp,this),this.setIdKey=bind(this.setIdKey,this),this.modelKeyComparison=bind(this.modelKeyComparison,this),ModelKey.__super__.constructor.call(this),this["interface"]={},this["interface"].scopeKeys=[],this.defaultIdKey="id",this.idKey=void 0}return extend(ModelKey,superClass),ModelKey.prototype.evalModelHandle=function(model,modelKey){return null!=model&&null!=modelKey?"self"===modelKey?model:(_.isFunction(modelKey)&&(modelKey=modelKey()),GmapUtil.getPath(model,modelKey)):void 0},ModelKey.prototype.modelKeyComparison=function(model1,model2){var hasCoords,isEqual,scope;if(hasCoords=_.contains(this["interface"].scopeKeys,"coords"),(hasCoords&&null!=this.scope.coords||!hasCoords)&&(scope=this.scope),null==scope)throw"No scope set!";return hasCoords&&(isEqual=GmapUtil.equalCoords(this.evalModelHandle(model1,scope.coords),this.evalModelHandle(model2,scope.coords)),!isEqual)?isEqual:isEqual=_.every(_.without(this["interface"].scopeKeys,"coords"),function(_this){return function(k){return _this.evalModelHandle(model1,scope[k])===_this.evalModelHandle(model2,scope[k])}}(this))},ModelKey.prototype.setIdKey=function(scope){return this.idKey=null!=scope.idKey?scope.idKey:this.defaultIdKey},ModelKey.prototype.setVal=function(model,key,newValue){var thingToSet;return thingToSet=this.modelOrKey(model,key),thingToSet=newValue,model},ModelKey.prototype.modelOrKey=function(model,key){return null!=key?"self"!==key?GmapUtil.getPath(model,key):model:void 0},ModelKey.prototype.getProp=function(propName,model){return this.modelOrKey(model,propName)},ModelKey.prototype.getChanges=function(now,prev,whitelistedProps){var c,changes,prop;whitelistedProps&&(prev=_.pick(prev,whitelistedProps),now=_.pick(now,whitelistedProps)),changes={},prop={},c={};for(prop in now)prev&&prev[prop]===now[prop]||(_.isArray(now[prop])?changes[prop]=now[prop]:_.isObject(now[prop])?(c=this.getChanges(now[prop],prev?prev[prop]:null),_.isEmpty(c)||(changes[prop]=c)):changes[prop]=now[prop]);return changes},ModelKey.prototype.scopeOrModelVal=function(key,scope,model,doWrap){var maybeWrap,modelKey,modelProp,scopeProp;return null==doWrap&&(doWrap=!1),maybeWrap=function(isScope,ret,doWrap){return null==doWrap&&(doWrap=!1),doWrap?{isScope:isScope,value:ret}:ret},scopeProp=scope[key],_.isFunction(scopeProp)?maybeWrap(!0,scopeProp(model),doWrap):_.isObject(scopeProp)?maybeWrap(!0,scopeProp,doWrap):_.isString(scopeProp)?(modelKey=scopeProp,modelProp=modelKey?"self"===modelKey?model:model[modelKey]:model[key],_.isFunction(modelProp)?maybeWrap(!1,modelProp(),doWrap):maybeWrap(!1,modelProp,doWrap)):maybeWrap(!0,scopeProp,doWrap)},ModelKey.prototype.setChildScope=function(keys,childScope,model){return _.each(keys,function(_this){return function(name){var isScopeObj,newValue;return isScopeObj=_this.scopeOrModelVal(name,childScope,model,!0),null!=(null!=isScopeObj?isScopeObj.value:void 0)&&(newValue=isScopeObj.value,newValue!==childScope[name])?childScope[name]=newValue:void 0}}(this)),childScope.model=model},ModelKey.prototype.onDestroy=function(scope){},ModelKey.prototype.destroy=function(manualOverride){var ref;return null==manualOverride&&(manualOverride=!1),null==this.scope||(null!=(ref=this.scope)?ref.$$destroyed:void 0)||!this.needToManualDestroy&&!manualOverride?this.clean():this.scope.$destroy()},ModelKey.prototype.updateChild=function(child,model){return null==model[this.idKey]?void this.$log.error("Model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):child.updateModel(model)},ModelKey.prototype.modelsLength=function(arrayOrObjModels){var len,toCheck;return null==arrayOrObjModels&&(arrayOrObjModels=void 0),len=0,toCheck=arrayOrObjModels?arrayOrObjModels:this.scope.models,null==toCheck?len:len=angular.isArray(toCheck)||null!=toCheck.length?toCheck.length:Object.keys(toCheck).length},ModelKey}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapModelsWatcher",["uiGmapLogger","uiGmap_async","$q","uiGmapPromise",function(Logger,_async,$q,uiGmapPromise){return{didQueueInitPromise:function(existingPiecesObj,scope){return 0===scope.models.length?(_async.promiseLock(existingPiecesObj,uiGmapPromise.promiseTypes.init,null,null,function(_this){return function(){return uiGmapPromise.resolve()}}(this)),!0):!1},figureOutState:function(idKey,scope,childObjects,comparison,callBack){var adds,children,mappedScopeModelIds,removals,updates;return adds=[],mappedScopeModelIds={},removals=[],updates=[],scope.models.forEach(function(m){var child;return null==m[idKey]?Logger.error(" id missing for model #{m.toString()},\ncan not use do comparison/insertion"):(mappedScopeModelIds[m[idKey]]={},null==childObjects.get(m[idKey])?adds.push(m):(child=childObjects.get(m[idKey]),comparison(m,child.clonedModel)?void 0:updates.push({model:m,child:child})))}),children=childObjects.values(),children.forEach(function(c){var id;return null==c?void Logger.error("child undefined in ModelsWatcher."):null==c.model?void Logger.error("child.model undefined in ModelsWatcher."):(id=c.model[idKey],null==mappedScopeModelIds[id]?removals.push(c):void 0)}),{adds:adds,removals:removals,updates:updates}}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapPromise",["$q","$timeout","uiGmapLogger",function($q,$timeout,$log){var ExposedPromise,SniffedPromise,defer,isInProgress,isResolved,promise,promiseStatus,promiseStatuses,promiseTypes,resolve,strPromiseStatuses;return promiseTypes={create:"create",update:"update","delete":"delete",init:"init"},promiseStatuses={IN_PROGRESS:0,RESOLVED:1,REJECTED:2},strPromiseStatuses=function(){var obj;return obj={},obj[""+promiseStatuses.IN_PROGRESS]="in-progress",obj[""+promiseStatuses.RESOLVED]="resolved",obj[""+promiseStatuses.REJECTED]="rejected",obj}(),isInProgress=function(promise){return promise.$$state?promise.$$state.status===promiseStatuses.IN_PROGRESS:promise.hasOwnProperty("$$v")?void 0:!0},isResolved=function(promise){return promise.$$state?promise.$$state.status===promiseStatuses.RESOLVED:promise.hasOwnProperty("$$v")?!0:void 0},promiseStatus=function(status){return strPromiseStatuses[status]||"done w error"},ExposedPromise=function(promise){var cancelDeferred,combined,wrapped;return cancelDeferred=$q.defer(),combined=$q.all([promise,cancelDeferred.promise]),wrapped=$q.defer(),promise.then(cancelDeferred.resolve,function(){},function(notify){return cancelDeferred.notify(notify),wrapped.notify(notify)}),combined.then(function(successes){return wrapped.resolve(successes[0]||successes[1])},function(error){return wrapped.reject(error)}),wrapped.promise.cancel=function(reason){return null==reason&&(reason="canceled"),cancelDeferred.reject(reason)},wrapped.promise.notify=function(msg){return null==msg&&(msg="cancel safe"),wrapped.notify(msg),promise.hasOwnProperty("notify")?promise.notify(msg):void 0},null!=promise.promiseType&&(wrapped.promise.promiseType=promise.promiseType),wrapped.promise},SniffedPromise=function(fnPromise,promiseType){return{promise:fnPromise,promiseType:promiseType}},defer=function(){return $q.defer()},resolve=function(){var d;return d=$q.defer(),d.resolve.apply(void 0,arguments),d.promise;
},promise=function(fnToWrap){var d;return _.isFunction(fnToWrap)?(d=$q.defer(),$timeout(function(){var result;return result=fnToWrap(),d.resolve(result)}),d.promise):void $log.error("uiGmapPromise.promise() only accepts functions")},{defer:defer,promise:promise,resolve:resolve,promiseTypes:promiseTypes,isInProgress:isInProgress,isResolved:isResolved,promiseStatus:promiseStatus,ExposedPromise:ExposedPromise,SniffedPromise:SniffedPromise}}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapPropMap",function(){var PropMap;return PropMap=function(){function PropMap(){this.removeAll=bind(this.removeAll,this),this.slice=bind(this.slice,this),this.push=bind(this.push,this),this.keys=bind(this.keys,this),this.values=bind(this.values,this),this.remove=bind(this.remove,this),this.put=bind(this.put,this),this.stateChanged=bind(this.stateChanged,this),this.get=bind(this.get,this),this.length=0,this.dict={},this.didValsStateChange=!1,this.didKeysStateChange=!1,this.allVals=[],this.allKeys=[]}return PropMap.prototype.get=function(key){return this.dict[key]},PropMap.prototype.stateChanged=function(){return this.didValsStateChange=!0,this.didKeysStateChange=!0},PropMap.prototype.put=function(key,value){return null==this.get(key)&&this.length++,this.stateChanged(),this.dict[key]=value},PropMap.prototype.remove=function(key,isSafe){var value;return null==isSafe&&(isSafe=!1),isSafe&&!this.get(key)?void 0:(value=this.dict[key],delete this.dict[key],this.length--,this.stateChanged(),value)},PropMap.prototype.valuesOrKeys=function(str){var keys,vals;return null==str&&(str="Keys"),this["did"+str+"StateChange"]?(vals=[],keys=[],_.each(this.dict,function(v,k){return vals.push(v),keys.push(k)}),this.didKeysStateChange=!1,this.didValsStateChange=!1,this.allVals=vals,this.allKeys=keys,this["all"+str]):this["all"+str]},PropMap.prototype.values=function(){return this.valuesOrKeys("Vals")},PropMap.prototype.keys=function(){return this.valuesOrKeys()},PropMap.prototype.push=function(obj,key){return null==key&&(key="key"),this.put(obj[key],obj)},PropMap.prototype.slice=function(){return this.keys().map(function(_this){return function(k){return _this.remove(k)}}(this))},PropMap.prototype.removeAll=function(){return this.slice()},PropMap.prototype.each=function(cb){return _.each(this.dict,function(v,k){return cb(v)})},PropMap.prototype.map=function(cb){return _.map(this.dict,function(v,k){return cb(v)})},PropMap}()})}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapPropertyAction",["uiGmapLogger",function(Logger){var PropertyAction;return PropertyAction=function(setterFn){return this.setIfChange=function(newVal,oldVal){var callingKey;return callingKey=this.exp,_.isEqual(oldVal,newVal)?void 0:setterFn(callingKey,newVal)},this.sic=this.setIfChange,this}}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps.directives.api.managers").factory("uiGmapClustererMarkerManager",["uiGmapLogger","uiGmapFitHelper","uiGmapPropMap",function($log,FitHelper,PropMap){var ClustererMarkerManager;return ClustererMarkerManager=function(){function ClustererMarkerManager(gMap,opt_markers,opt_options,opt_events){null==opt_markers&&(opt_markers={}),this.opt_options=null!=opt_options?opt_options:{},this.opt_events=opt_events,this.checkSync=bind(this.checkSync,this),this.getGMarkers=bind(this.getGMarkers,this),this.fit=bind(this.fit,this),this.destroy=bind(this.destroy,this),this.clear=bind(this.clear,this),this.draw=bind(this.draw,this),this.removeMany=bind(this.removeMany,this),this.remove=bind(this.remove,this),this.addMany=bind(this.addMany,this),this.update=bind(this.update,this),this.add=bind(this.add,this),this.type=ClustererMarkerManager.type,this.clusterer=new NgMapMarkerClusterer(gMap,opt_markers,this.opt_options),this.propMapGMarkers=new PropMap,this.attachEvents(this.opt_events,"opt_events"),this.clusterer.setIgnoreHidden(!0),this.noDrawOnSingleAddRemoves=!0,$log.info(this)}return ClustererMarkerManager.type="ClustererMarkerManager",ClustererMarkerManager.prototype.checkKey=function(gMarker){var msg;return null==gMarker.key?(msg="gMarker.key undefined and it is REQUIRED!!",$log.error(msg)):void 0},ClustererMarkerManager.prototype.add=function(gMarker){return this.checkKey(gMarker),this.clusterer.addMarker(gMarker,this.noDrawOnSingleAddRemoves),this.propMapGMarkers.put(gMarker.key,gMarker),this.checkSync()},ClustererMarkerManager.prototype.update=function(gMarker){return this.remove(gMarker),this.add(gMarker)},ClustererMarkerManager.prototype.addMany=function(gMarkers){return gMarkers.forEach(function(_this){return function(gMarker){return _this.add(gMarker)}}(this))},ClustererMarkerManager.prototype.remove=function(gMarker){var exists;return this.checkKey(gMarker),exists=this.propMapGMarkers.get(gMarker.key),exists&&(this.clusterer.removeMarker(gMarker,this.noDrawOnSingleAddRemoves),this.propMapGMarkers.remove(gMarker.key)),this.checkSync()},ClustererMarkerManager.prototype.removeMany=function(gMarkers){return gMarkers.forEach(function(_this){return function(gMarker){return _this.remove(gMarker)}}(this))},ClustererMarkerManager.prototype.draw=function(){return this.clusterer.repaint()},ClustererMarkerManager.prototype.clear=function(){return this.removeMany(this.getGMarkers()),this.clusterer.repaint()},ClustererMarkerManager.prototype.attachEvents=function(options,optionsName){var eventHandler,eventName,results;if(angular.isDefined(options)&&null!=options&&angular.isObject(options)){results=[];for(eventName in options)eventHandler=options[eventName],options.hasOwnProperty(eventName)&&angular.isFunction(options[eventName])?($log.info(optionsName+": Attaching event: "+eventName+" to clusterer"),results.push(google.maps.event.addListener(this.clusterer,eventName,options[eventName]))):results.push(void 0);return results}},ClustererMarkerManager.prototype.clearEvents=function(options,optionsName){var eventHandler,eventName,results;if(angular.isDefined(options)&&null!=options&&angular.isObject(options)){results=[];for(eventName in options)eventHandler=options[eventName],options.hasOwnProperty(eventName)&&angular.isFunction(options[eventName])?($log.info(optionsName+": Clearing event: "+eventName+" to clusterer"),results.push(google.maps.event.clearListeners(this.clusterer,eventName))):results.push(void 0);return results}},ClustererMarkerManager.prototype.destroy=function(){return this.clearEvents(this.opt_events,"opt_events"),this.clear()},ClustererMarkerManager.prototype.fit=function(){return FitHelper.fit(this.getGMarkers(),this.clusterer.getMap())},ClustererMarkerManager.prototype.getGMarkers=function(){return this.clusterer.getMarkers().values()},ClustererMarkerManager.prototype.checkSync=function(){},ClustererMarkerManager}()}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps.directives.api.managers").factory("uiGmapMarkerManager",["uiGmapLogger","uiGmapFitHelper","uiGmapPropMap",function(Logger,FitHelper,PropMap){var MarkerManager;return MarkerManager=function(){function MarkerManager(gMap,opt_markers,opt_options){this.getGMarkers=bind(this.getGMarkers,this),this.fit=bind(this.fit,this),this.handleOptDraw=bind(this.handleOptDraw,this),this.clear=bind(this.clear,this),this.draw=bind(this.draw,this),this.removeMany=bind(this.removeMany,this),this.remove=bind(this.remove,this),this.addMany=bind(this.addMany,this),this.update=bind(this.update,this),this.add=bind(this.add,this),this.type=MarkerManager.type,this.gMap=gMap,this.gMarkers=new PropMap,this.$log=Logger,this.$log.info(this)}return MarkerManager.type="MarkerManager",MarkerManager.prototype.add=function(gMarker,optDraw){var exists,msg;if(null==optDraw&&(optDraw=!0),null==gMarker.key)throw msg="gMarker.key undefined and it is REQUIRED!!",Logger.error(msg),msg;return exists=this.gMarkers.get(gMarker.key),exists?void 0:(this.handleOptDraw(gMarker,optDraw,!0),this.gMarkers.put(gMarker.key,gMarker))},MarkerManager.prototype.update=function(gMarker,optDraw){return null==optDraw&&(optDraw=!0),this.remove(gMarker,optDraw),this.add(gMarker,optDraw)},MarkerManager.prototype.addMany=function(gMarkers){return gMarkers.forEach(function(_this){return function(gMarker){return _this.add(gMarker)}}(this))},MarkerManager.prototype.remove=function(gMarker,optDraw){return null==optDraw&&(optDraw=!0),this.handleOptDraw(gMarker,optDraw,!1),this.gMarkers.get(gMarker.key)?this.gMarkers.remove(gMarker.key):void 0},MarkerManager.prototype.removeMany=function(gMarkers){return gMarkers.forEach(function(_this){return function(marker){return _this.remove(marker)}}(this))},MarkerManager.prototype.draw=function(){var deletes;return deletes=[],this.gMarkers.each(function(_this){return function(gMarker){return gMarker.isDrawn?void 0:gMarker.doAdd?(gMarker.setMap(_this.gMap),gMarker.isDrawn=!0):deletes.push(gMarker)}}(this)),deletes.forEach(function(_this){return function(gMarker){return gMarker.isDrawn=!1,_this.remove(gMarker,!0)}}(this))},MarkerManager.prototype.clear=function(){return this.gMarkers.each(function(gMarker){return gMarker.setMap(null)}),delete this.gMarkers,this.gMarkers=new PropMap},MarkerManager.prototype.handleOptDraw=function(gMarker,optDraw,doAdd){return optDraw===!0?(doAdd?gMarker.setMap(this.gMap):gMarker.setMap(null),gMarker.isDrawn=!0):(gMarker.isDrawn=!1,gMarker.doAdd=doAdd)},MarkerManager.prototype.fit=function(){return FitHelper.fit(this.getGMarkers(),this.gMap)},MarkerManager.prototype.getGMarkers=function(){return this.gMarkers.values()},MarkerManager}()}])}.call(this),function(){angular.module("uiGmapgoogle-maps").factory("uiGmapadd-events",["$timeout",function($timeout){var addEvent,addEvents;return addEvent=function(target,eventName,handler){return google.maps.event.addListener(target,eventName,function(){return handler.apply(this,arguments),$timeout(function(){},!0)})},addEvents=function(target,eventName,handler){var remove;return handler?addEvent(target,eventName,handler):(remove=[],angular.forEach(eventName,function(_handler,key){return remove.push(addEvent(target,key,_handler))}),function(){return angular.forEach(remove,function(listener){return google.maps.event.removeListener(listener)}),remove=null})}}])}.call(this),function(){angular.module("uiGmapgoogle-maps").factory("uiGmaparray-sync",["uiGmapadd-events",function(mapEvents){return function(mapArray,scope,pathEval,pathChangedFn){var geojsonArray,geojsonHandlers,geojsonWatcher,isSetFromScope,legacyHandlers,legacyWatcher,mapArrayListener,scopePath,watchListener;return isSetFromScope=!1,scopePath=scope.$eval(pathEval),scope["static"]||(legacyHandlers={set_at:function(index){var value;if(!isSetFromScope&&(value=mapArray.getAt(index)))return value.lng&&value.lat?(scopePath[index].latitude=value.lat(),scopePath[index].longitude=value.lng()):scopePath[index]=value},insert_at:function(index){var value;if(!isSetFromScope&&(value=mapArray.getAt(index)))return value.lng&&value.lat?scopePath.splice(index,0,{latitude:value.lat(),longitude:value.lng()}):scopePath.splice(index,0,value)},remove_at:function(index){return isSetFromScope?void 0:scopePath.splice(index,1)}},"Polygon"===scopePath.type?geojsonArray=scopePath.coordinates[0]:"LineString"===scopePath.type&&(geojsonArray=scopePath.coordinates),geojsonHandlers={set_at:function(index){var value;if(!isSetFromScope&&(value=mapArray.getAt(index),value&&value.lng&&value.lat))return geojsonArray[index][1]=value.lat(),geojsonArray[index][0]=value.lng()},insert_at:function(index){var value;if(!isSetFromScope&&(value=mapArray.getAt(index),value&&value.lng&&value.lat))return geojsonArray.splice(index,0,[value.lng(),value.lat()])},remove_at:function(index){return isSetFromScope?void 0:geojsonArray.splice(index,1)}},mapArrayListener=mapEvents(mapArray,angular.isUndefined(scopePath.type)?legacyHandlers:geojsonHandlers)),legacyWatcher=function(newPath){var changed,i,l,newLength,newValue,oldArray,oldLength,oldValue;if(isSetFromScope=!0,oldArray=mapArray,changed=!1,newPath){for(i=0,oldLength=oldArray.getLength(),newLength=newPath.length,l=Math.min(oldLength,newLength),newValue=void 0;l>i;)oldValue=oldArray.getAt(i),newValue=newPath[i],"function"==typeof newValue.equals?newValue.equals(oldValue)||(oldArray.setAt(i,newValue),changed=!0):(oldValue.lat()!==newValue.latitude||oldValue.lng()!==newValue.longitude)&&(oldArray.setAt(i,new google.maps.LatLng(newValue.latitude,newValue.longitude)),changed=!0),i++;for(;newLength>i;)newValue=newPath[i],"function"==typeof newValue.lat&&"function"==typeof newValue.lng?oldArray.push(newValue):oldArray.push(new google.maps.LatLng(newValue.latitude,newValue.longitude)),changed=!0,i++;for(;oldLength>i;)oldArray.pop(),changed=!0,i++}return isSetFromScope=!1,changed?pathChangedFn(oldArray):void 0},geojsonWatcher=function(newPath){var array,changed,i,l,newLength,newValue,oldArray,oldLength,oldValue;if(isSetFromScope=!0,oldArray=mapArray,changed=!1,newPath){for("Polygon"===scopePath.type?array=newPath.coordinates[0]:"LineString"===scopePath.type&&(array=newPath.coordinates),i=0,oldLength=oldArray.getLength(),newLength=array.length,l=Math.min(oldLength,newLength),newValue=void 0;l>i;)oldValue=oldArray.getAt(i),newValue=array[i],(oldValue.lat()!==newValue[1]||oldValue.lng()!==newValue[0])&&(oldArray.setAt(i,new google.maps.LatLng(newValue[1],newValue[0])),changed=!0),i++;for(;newLength>i;)newValue=array[i],oldArray.push(new google.maps.LatLng(newValue[1],newValue[0])),changed=!0,i++;for(;oldLength>i;)oldArray.pop(),changed=!0,i++}return isSetFromScope=!1,changed?pathChangedFn(oldArray):void 0},scope["static"]||(watchListener=angular.isUndefined(scopePath.type)?scope.$watchCollection(pathEval,legacyWatcher):scope.$watch(pathEval,geojsonWatcher,!0)),function(){return mapArrayListener&&(mapArrayListener(),mapArrayListener=null),watchListener?(watchListener(),watchListener=null):void 0}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.utils").factory("uiGmapChromeFixes",["$timeout",function($timeout){return{maybeRepaint:function(el){return el?(el.style.opacity=.9,$timeout(function(){return el.style.opacity=1})):void 0}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps").service("uiGmapObjectIterators",function(){var _ignores,_iterators,_slapForEach,_slapMap;return _ignores=["length","forEach","map"],_iterators=[],_slapForEach=function(object){return object.forEach=function(cb){return _.each(_.omit(object,_ignores),function(val){return _.isFunction(val)?void 0:cb(val)})},object},_iterators.push(_slapForEach),_slapMap=function(object){return object.map=function(cb){return _.map(_.omit(object,_ignores),function(val){return _.isFunction(val)?void 0:cb(val)})},object},_iterators.push(_slapMap),{slapMap:_slapMap,slapForEach:_slapForEach,slapAll:function(object){return _iterators.forEach(function(it){return it(object)}),object}}})}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.options.builders").service("uiGmapCommonOptionsBuilder",["uiGmapBaseObject","uiGmapLogger","uiGmapModelKey",function(BaseObject,$log,ModelKey){var CommonOptionsBuilder;return CommonOptionsBuilder=function(superClass){function CommonOptionsBuilder(){return this.watchProps=bind(this.watchProps,this),this.buildOpts=bind(this.buildOpts,this),CommonOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(CommonOptionsBuilder,superClass),CommonOptionsBuilder.prototype.props=["clickable","draggable","editable","visible",{prop:"stroke",isColl:!0}],CommonOptionsBuilder.prototype.getCorrectModel=function(scope){return angular.isDefined(null!=scope?scope.model:void 0)?scope.model:scope},CommonOptionsBuilder.prototype.buildOpts=function(customOpts,cachedEval,forEachOpts){var model,opts,stroke;return null==customOpts&&(customOpts={}),null==forEachOpts&&(forEachOpts={}),this.scope?this.map?(model=this.getCorrectModel(this.scope),stroke=this.scopeOrModelVal("stroke",this.scope,model),opts=angular.extend(customOpts,this.DEFAULTS,{map:this.map,strokeColor:null!=stroke?stroke.color:void 0,strokeOpacity:null!=stroke?stroke.opacity:void 0,strokeWeight:null!=stroke?stroke.weight:void 0}),angular.forEach(angular.extend(forEachOpts,{clickable:!0,draggable:!1,editable:!1,"static":!1,fit:!1,visible:!0,zIndex:0,icons:[]}),function(_this){return function(defaultValue,key){var val;return val=cachedEval?cachedEval[key]:_this.scopeOrModelVal(key,_this.scope,model),angular.isUndefined(val)?opts[key]=defaultValue:opts[key]=model[key]}}(this)),opts["static"]&&(opts.editable=!1),opts):void $log.error("this.map not defined in CommonOptionsBuilder can not buildOpts"):void $log.error("this.scope not defined in CommonOptionsBuilder can not buildOpts")},CommonOptionsBuilder.prototype.watchProps=function(props){return null==props&&(props=this.props),props.forEach(function(_this){return function(prop){return null!=_this.attrs[prop]||null!=_this.attrs[null!=prop?prop.prop:void 0]?(null!=prop?prop.isColl:void 0)?_this.scope.$watchCollection(prop.prop,_this.setMyOptions):_this.scope.$watch(prop,_this.setMyOptions):void 0}}(this))},CommonOptionsBuilder}(ModelKey)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.options.builders").factory("uiGmapPolylineOptionsBuilder",["uiGmapCommonOptionsBuilder",function(CommonOptionsBuilder){var PolylineOptionsBuilder;return PolylineOptionsBuilder=function(superClass){function PolylineOptionsBuilder(){return PolylineOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(PolylineOptionsBuilder,superClass),PolylineOptionsBuilder.prototype.buildOpts=function(pathPoints,cachedEval){return PolylineOptionsBuilder.__super__.buildOpts.call(this,{path:pathPoints},cachedEval,{geodesic:!1})},PolylineOptionsBuilder}(CommonOptionsBuilder)}]).factory("uiGmapShapeOptionsBuilder",["uiGmapCommonOptionsBuilder",function(CommonOptionsBuilder){var ShapeOptionsBuilder;return ShapeOptionsBuilder=function(superClass){function ShapeOptionsBuilder(){return ShapeOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(ShapeOptionsBuilder,superClass),ShapeOptionsBuilder.prototype.buildOpts=function(customOpts,cachedEval,forEachOpts){var fill,model;return model=this.getCorrectModel(this.scope),fill=cachedEval?cachedEval.fill:this.scopeOrModelVal("fill",this.scope,model),customOpts=angular.extend(customOpts,{fillColor:null!=fill?fill.color:void 0,fillOpacity:null!=fill?fill.opacity:void 0}),ShapeOptionsBuilder.__super__.buildOpts.call(this,customOpts,cachedEval,forEachOpts)},ShapeOptionsBuilder}(CommonOptionsBuilder)}]).factory("uiGmapPolygonOptionsBuilder",["uiGmapShapeOptionsBuilder",function(ShapeOptionsBuilder){var PolygonOptionsBuilder;return PolygonOptionsBuilder=function(superClass){function PolygonOptionsBuilder(){return PolygonOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(PolygonOptionsBuilder,superClass),PolygonOptionsBuilder.prototype.buildOpts=function(pathPoints,cachedEval){return PolygonOptionsBuilder.__super__.buildOpts.call(this,{path:pathPoints},cachedEval,{geodesic:!1})},PolygonOptionsBuilder}(ShapeOptionsBuilder)}]).factory("uiGmapRectangleOptionsBuilder",["uiGmapShapeOptionsBuilder",function(ShapeOptionsBuilder){var RectangleOptionsBuilder;return RectangleOptionsBuilder=function(superClass){function RectangleOptionsBuilder(){return RectangleOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(RectangleOptionsBuilder,superClass),RectangleOptionsBuilder.prototype.buildOpts=function(bounds,cachedEval){return RectangleOptionsBuilder.__super__.buildOpts.call(this,{bounds:bounds},cachedEval)},RectangleOptionsBuilder}(ShapeOptionsBuilder)}]).factory("uiGmapCircleOptionsBuilder",["uiGmapShapeOptionsBuilder",function(ShapeOptionsBuilder){var CircleOptionsBuilder;return CircleOptionsBuilder=function(superClass){function CircleOptionsBuilder(){return CircleOptionsBuilder.__super__.constructor.apply(this,arguments)}return extend(CircleOptionsBuilder,superClass),CircleOptionsBuilder.prototype.buildOpts=function(center,radius,cachedEval){return CircleOptionsBuilder.__super__.buildOpts.call(this,{center:center,radius:radius},cachedEval)},CircleOptionsBuilder}(ShapeOptionsBuilder)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.options").service("uiGmapMarkerOptions",["uiGmapLogger","uiGmapGmapUtil",function($log,GmapUtil){return _.extend(GmapUtil,{createOptions:function(coords,icon,defaults,map){var opts;return null==defaults&&(defaults={}),opts=angular.extend({},defaults,{position:null!=defaults.position?defaults.position:GmapUtil.getCoords(coords),visible:null!=defaults.visible?defaults.visible:GmapUtil.validateCoords(coords)}),(null!=defaults.icon||null!=icon)&&(opts=angular.extend(opts,{icon:null!=defaults.icon?defaults.icon:icon})),null!=map&&(opts.map=map),opts},isLabel:function(options){return null==options?!1:null!=options.labelContent||null!=options.labelAnchor||null!=options.labelClass||null!=options.labelStyle||null!=options.labelVisible}})}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapBasePolyChildModel",["uiGmapLogger","$timeout","uiGmaparray-sync","uiGmapGmapUtil","uiGmapEventsHelper",function($log,$timeout,arraySync,GmapUtil,EventsHelper){return function(Builder,gFactory){var BasePolyChildModel;return BasePolyChildModel=function(superClass){function BasePolyChildModel(scope,attrs,map,defaults,model){var create;this.scope=scope,this.attrs=attrs,this.map=map,this.defaults=defaults,this.model=model,this.clean=bind(this.clean,this),this.clonedModel=_.clone(this.model,!0),this.isDragging=!1,this.internalEvents={dragend:function(_this){return function(){return _.defer(function(){return _this.isDragging=!1})}}(this),dragstart:function(_this){return function(){return _this.isDragging=!0}}(this)},create=function(_this){return function(){var maybeCachedEval,pathPoints;if(!_this.isDragging)return pathPoints=_this.convertPathPoints(_this.scope.path),null!=_this.gObject&&_this.clean(),null!=_this.scope.model&&(maybeCachedEval=_this.scope),pathPoints.length>0&&(_this.gObject=gFactory(_this.buildOpts(pathPoints,maybeCachedEval))),_this.gObject?(_this.scope.fit&&_this.extendMapBounds(_this.map,pathPoints),arraySync(_this.gObject.getPath(),_this.scope,"path",function(pathPoints){return _this.scope.fit?_this.extendMapBounds(_this.map,pathPoints):void 0}),angular.isDefined(_this.scope.events)&&angular.isObject(_this.scope.events)&&(_this.listeners=_this.model?EventsHelper.setEvents(_this.gObject,_this.scope,_this.model):EventsHelper.setEvents(_this.gObject,_this.scope,_this.scope)),_this.internalListeners=_this.model?EventsHelper.setEvents(_this.gObject,{events:_this.internalEvents},_this.model):EventsHelper.setEvents(_this.gObject,{events:_this.internalEvents},_this.scope)):void 0}}(this),create(),this.scope.$watch("path",function(_this){return function(newValue,oldValue){return _.isEqual(newValue,oldValue)&&_this.gObject?void 0:create()}}(this),!0),!this.scope["static"]&&angular.isDefined(this.scope.editable)&&this.scope.$watch("editable",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue?(newValue=!_this.isFalse(newValue),null!=(ref=_this.gObject)?ref.setEditable(newValue):void 0):void 0}}(this),!0),angular.isDefined(this.scope.draggable)&&this.scope.$watch("draggable",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue?(newValue=!_this.isFalse(newValue),null!=(ref=_this.gObject)?ref.setDraggable(newValue):void 0):void 0}}(this),!0),angular.isDefined(this.scope.visible)&&this.scope.$watch("visible",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue&&(newValue=!_this.isFalse(newValue)),null!=(ref=_this.gObject)?ref.setVisible(newValue):void 0}}(this),!0),angular.isDefined(this.scope.geodesic)&&this.scope.$watch("geodesic",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue?(newValue=!_this.isFalse(newValue),null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0):void 0}}(this),!0),angular.isDefined(this.scope.stroke)&&angular.isDefined(this.scope.stroke.weight)&&this.scope.$watch("stroke.weight",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue&&null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),angular.isDefined(this.scope.stroke)&&angular.isDefined(this.scope.stroke.color)&&this.scope.$watch("stroke.color",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue&&null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),angular.isDefined(this.scope.stroke)&&angular.isDefined(this.scope.stroke.opacity)&&this.scope.$watch("stroke.opacity",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue&&null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),angular.isDefined(this.scope.icons)&&this.scope.$watch("icons",function(_this){return function(newValue,oldValue){var ref;return newValue!==oldValue&&null!=(ref=_this.gObject)?ref.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this),!0),this.scope.$on("$destroy",function(_this){return function(){return _this.clean(),_this.scope=null}}(this)),angular.isDefined(this.scope.fill)&&angular.isDefined(this.scope.fill.color)&&this.scope.$watch("fill.color",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.gObject.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this)),angular.isDefined(this.scope.fill)&&angular.isDefined(this.scope.fill.opacity)&&this.scope.$watch("fill.opacity",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.gObject.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this)),angular.isDefined(this.scope.zIndex)&&this.scope.$watch("zIndex",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.gObject.setOptions(_this.buildOpts(_this.gObject.getPath())):void 0}}(this))}return extend(BasePolyChildModel,superClass),BasePolyChildModel.include(GmapUtil),BasePolyChildModel.prototype.clean=function(){var ref;return EventsHelper.removeEvents(this.listeners),EventsHelper.removeEvents(this.internalListeners),null!=(ref=this.gObject)&&ref.setMap(null),this.gObject=null},BasePolyChildModel}(Builder)}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api.models.child").factory("uiGmapDrawFreeHandChildModel",["uiGmapLogger","$q",function($log,$q){var drawFreeHand,freeHandMgr;return drawFreeHand=function(map,polys,enable){var move,poly;return poly=new google.maps.Polyline({map:map,clickable:!1}),move=google.maps.event.addListener(map,"mousemove",function(e){return poly.getPath().push(e.latLng)}),void google.maps.event.addListenerOnce(map,"mouseup",function(e){var path;return google.maps.event.removeListener(move),path=poly.getPath(),poly.setMap(null),polys.push(new google.maps.Polygon({map:map,path:path})),poly=null,google.maps.event.clearListeners(map.getDiv(),"mousedown"),enable()})},freeHandMgr=function(map1,defaultOptions){var disableMap,enable;return this.map=map1,defaultOptions||(defaultOptions={draggable:!0,zoomControl:!0,scrollwheel:!0,disableDoubleClickZoom:!0}),enable=function(_this){return function(){var ref;return null!=(ref=_this.deferred)&&ref.resolve(),_.defer(function(){return _this.map.setOptions(_.extend(_this.oldOptions,defaultOptions))})}}(this),disableMap=function(_this){return function(){return $log.info("disabling map move"),_this.oldOptions=map.getOptions(),_this.oldOptions.center=map.getCenter(),_this.map.setOptions({draggable:!1,zoomControl:!1,scrollwheel:!1,disableDoubleClickZoom:!1})}}(this),this.engage=function(_this){return function(polys1){return _this.polys=polys1,_this.deferred=$q.defer(),disableMap(),$log.info("DrawFreeHandChildModel is engaged (drawing)."),google.maps.event.addDomListener(_this.map.getDiv(),"mousedown",function(e){return drawFreeHand(_this.map,_this.polys,enable)}),_this.deferred.promise}}(this),this}}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.child").factory("uiGmapMarkerChildModel",["uiGmapModelKey","uiGmapGmapUtil","uiGmapLogger","uiGmapEventsHelper","uiGmapPropertyAction","uiGmapMarkerOptions","uiGmapIMarker","uiGmapMarkerManager","uiGmapPromise",function(ModelKey,GmapUtil,$log,EventsHelper,PropertyAction,MarkerOptions,IMarker,MarkerManager,uiGmapPromise){var MarkerChildModel;return MarkerChildModel=function(superClass){function MarkerChildModel(scope,model1,keys,gMap,defaults,doClick,gManager,doDrawSelf,trackModel,needRedraw){var action;this.model=model1,this.keys=keys,this.gMap=gMap,this.defaults=defaults,this.doClick=doClick,this.gManager=gManager,this.doDrawSelf=null!=doDrawSelf?doDrawSelf:!0,this.trackModel=null!=trackModel?trackModel:!0,this.needRedraw=null!=needRedraw?needRedraw:!1,this.internalEvents=bind(this.internalEvents,this),this.setLabelOptions=bind(this.setLabelOptions,this),this.setOptions=bind(this.setOptions,this),this.setIcon=bind(this.setIcon,this),this.setCoords=bind(this.setCoords,this),this.isNotValid=bind(this.isNotValid,this),this.maybeSetScopeValue=bind(this.maybeSetScopeValue,this),this.createMarker=bind(this.createMarker,this),this.setMyScope=bind(this.setMyScope,this),this.updateModel=bind(this.updateModel,this),this.handleModelChanges=bind(this.handleModelChanges,this),this.destroy=bind(this.destroy,this),this.clonedModel=_.extend({},this.model),this.deferred=uiGmapPromise.defer(),_.each(this.keys,function(_this){return function(v,k){return _this[k+"Key"]=_.isFunction(_this.keys[k])?_this.keys[k]():_this.keys[k]}}(this)),this.idKey=this.idKeyKey||"id",null!=this.model[this.idKey]&&(this.id=this.model[this.idKey]),MarkerChildModel.__super__.constructor.call(this,scope),this.scope.getGMarker=function(_this){return function(){return _this.gObject}}(this),this.firstTime=!0,this.trackModel?(this.scope.model=this.model,this.scope.$watch("model",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.handleModelChanges(newValue,oldValue):void 0}}(this),!0)):(action=new PropertyAction(function(_this){return function(calledKey,newVal){return _this.firstTime?void 0:_this.setMyScope(calledKey,scope)}}(this),!1),_.each(this.keys,function(v,k){
return scope.$watch(k,action.sic,!0)})),this.scope.$on("$destroy",function(_this){return function(){return destroy(_this)}}(this)),this.createMarker(this.model),$log.info(this)}var destroy;return extend(MarkerChildModel,superClass),MarkerChildModel.include(GmapUtil),MarkerChildModel.include(EventsHelper),MarkerChildModel.include(MarkerOptions),destroy=function(child){return null!=(null!=child?child.gObject:void 0)&&(child.removeEvents(child.externalListeners),child.removeEvents(child.internalListeners),null!=child?child.gObject:void 0)?(child.removeFromManager&&child.gManager.remove(child.gObject),child.gObject.setMap(null),child.gObject=null):void 0},MarkerChildModel.prototype.destroy=function(removeFromManager){return null==removeFromManager&&(removeFromManager=!0),this.removeFromManager=removeFromManager,this.scope.$destroy()},MarkerChildModel.prototype.handleModelChanges=function(newValue,oldValue){var changes,ctr,len;return changes=this.getChanges(newValue,oldValue,IMarker.keys),this.firstTime?void 0:(ctr=0,len=_.keys(changes).length,_.each(changes,function(_this){return function(v,k){var doDraw;return ctr+=1,doDraw=len===ctr,_this.setMyScope(k,newValue,oldValue,!1,!0,doDraw),_this.needRedraw=!0}}(this)))},MarkerChildModel.prototype.updateModel=function(model){return this.clonedModel=_.extend({},model),this.setMyScope("all",model,this.model)},MarkerChildModel.prototype.renderGMarker=function(doDraw,validCb){var coords;if(null==doDraw&&(doDraw=!0),coords=this.getProp(this.coordsKey,this.model),null!=coords){if(!this.validateCoords(coords))return void $log.debug("MarkerChild does not have coords yet. They may be defined later.");if(null!=validCb&&validCb(),doDraw&&this.gObject)return this.gManager.add(this.gObject)}else if(doDraw&&this.gObject)return this.gManager.remove(this.gObject)},MarkerChildModel.prototype.setMyScope=function(thingThatChanged,model,oldModel,isInit,doDraw){var justCreated;switch(null==oldModel&&(oldModel=void 0),null==isInit&&(isInit=!1),null==doDraw&&(doDraw=!0),null==model?model=this.model:this.model=model,this.gObject||(this.setOptions(this.scope,doDraw),justCreated=!0),thingThatChanged){case"all":return _.each(this.keys,function(_this){return function(v,k){return _this.setMyScope(k,model,oldModel,isInit,doDraw)}}(this));case"icon":return this.maybeSetScopeValue("icon",model,oldModel,this.iconKey,this.evalModelHandle,isInit,this.setIcon,doDraw);case"coords":return this.maybeSetScopeValue("coords",model,oldModel,this.coordsKey,this.evalModelHandle,isInit,this.setCoords,doDraw);case"options":if(!justCreated)return this.createMarker(model,oldModel,isInit,doDraw)}},MarkerChildModel.prototype.createMarker=function(model,oldModel,isInit,doDraw){return null==oldModel&&(oldModel=void 0),null==isInit&&(isInit=!1),null==doDraw&&(doDraw=!0),this.maybeSetScopeValue("options",model,oldModel,this.optionsKey,this.evalModelHandle,isInit,this.setOptions,doDraw),this.firstTime=!1},MarkerChildModel.prototype.maybeSetScopeValue=function(scopePropName,model,oldModel,modelKey,evaluate,isInit,gSetter,doDraw){return null==gSetter&&(gSetter=void 0),null==doDraw&&(doDraw=!0),null!=gSetter?gSetter(this.scope,doDraw):void 0},MarkerChildModel.doDrawSelf&&doDraw&&MarkerChildModel.gManager.draw(),MarkerChildModel.prototype.isNotValid=function(scope,doCheckGmarker){var hasIdenticalScopes,hasNoGmarker;return null==doCheckGmarker&&(doCheckGmarker=!0),hasNoGmarker=doCheckGmarker?void 0===this.gObject:!1,hasIdenticalScopes=this.trackModel?!1:scope.$id!==this.scope.$id,hasIdenticalScopes||hasNoGmarker},MarkerChildModel.prototype.setCoords=function(scope,doDraw){return null==doDraw&&(doDraw=!0),this.isNotValid(scope)||null==this.gObject?void 0:this.renderGMarker(doDraw,function(_this){return function(){var newGValue,newModelVal,oldGValue;return newModelVal=_this.getProp(_this.coordsKey,_this.model),newGValue=_this.getCoords(newModelVal),oldGValue=_this.gObject.getPosition(),null==oldGValue||null==newGValue||newGValue.lng()!==oldGValue.lng()||newGValue.lat()!==oldGValue.lat()?(_this.gObject.setPosition(newGValue),_this.gObject.setVisible(_this.validateCoords(newModelVal))):void 0}}(this))},MarkerChildModel.prototype.setIcon=function(scope,doDraw){return null==doDraw&&(doDraw=!0),this.isNotValid(scope)||null==this.gObject?void 0:this.renderGMarker(doDraw,function(_this){return function(){var coords,newValue,oldValue;return oldValue=_this.gObject.getIcon(),newValue=_this.getProp(_this.iconKey,_this.model),oldValue!==newValue?(_this.gObject.setIcon(newValue),coords=_this.getProp(_this.coordsKey,_this.model),_this.gObject.setPosition(_this.getCoords(coords)),_this.gObject.setVisible(_this.validateCoords(coords))):void 0}}(this))},MarkerChildModel.prototype.setOptions=function(scope,doDraw){var ref;if(null==doDraw&&(doDraw=!0),!this.isNotValid(scope,!1)){if(this.renderGMarker(doDraw,function(_this){return function(){var _options,coords,icon;return coords=_this.getProp(_this.coordsKey,_this.model),icon=_this.getProp(_this.iconKey,_this.model),_options=_this.getProp(_this.optionsKey,_this.model),_this.opts=_this.createOptions(coords,icon,_options),_this.isLabel(_this.gObject)!==_this.isLabel(_this.opts)&&null!=_this.gObject&&(_this.gManager.remove(_this.gObject),_this.gObject=void 0),null!=_this.gObject&&_this.gObject.setOptions(_this.setLabelOptions(_this.opts)),_this.gObject||(_this.isLabel(_this.opts)?_this.gObject=new MarkerWithLabel(_this.setLabelOptions(_this.opts)):_this.gObject=new google.maps.Marker(_this.opts),_.extend(_this.gObject,{model:_this.model})),_this.externalListeners&&_this.removeEvents(_this.externalListeners),_this.internalListeners&&_this.removeEvents(_this.internalListeners),_this.externalListeners=_this.setEvents(_this.gObject,_this.scope,_this.model,["dragend"]),_this.internalListeners=_this.setEvents(_this.gObject,{events:_this.internalEvents(),$evalAsync:function(){}},_this.model),null!=_this.id?_this.gObject.key=_this.id:void 0}}(this)),this.gObject&&(this.gObject.getMap()||this.gManager.type!==MarkerManager.type))this.deferred.resolve(this.gObject);else{if(!this.gObject)return this.deferred.reject("gObject is null");(null!=(ref=this.gObject)?ref.getMap():0)&&this.gManager.type===MarkerManager.type||($log.debug("gObject has no map yet"),this.deferred.resolve(this.gObject))}return this.model[this.fitKey]?this.gManager.fit():void 0}},MarkerChildModel.prototype.setLabelOptions=function(opts){return opts.labelAnchor=this.getLabelPositionPoint(opts.labelAnchor),opts},MarkerChildModel.prototype.internalEvents=function(){return{dragend:function(_this){return function(marker,eventName,model,mousearg){var events,modelToSet,newCoords;return modelToSet=_this.trackModel?_this.scope.model:_this.model,newCoords=_this.setCoordsFromEvent(_this.modelOrKey(modelToSet,_this.coordsKey),_this.gObject.getPosition()),modelToSet=_this.setVal(model,_this.coordsKey,newCoords),events=_this.scope.events,null!=(null!=events?events.dragend:void 0)&&events.dragend(marker,eventName,modelToSet,mousearg),_this.scope.$apply()}}(this),click:function(_this){return function(marker,eventName,model,mousearg){var click;return click=_.isFunction(_this.clickKey)?_this.clickKey:_this.getProp(_this.clickKey,_this.model),_this.doClick&&null!=click?_this.scope.$evalAsync(click(marker,eventName,_this.model,mousearg)):void 0}}(this)}},MarkerChildModel}(ModelKey)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolygonChildModel",["uiGmapBasePolyChildModel","uiGmapPolygonOptionsBuilder",function(BaseGen,Builder){var PolygonChildModel,base,gFactory;return gFactory=function(opts){return new google.maps.Polygon(opts)},base=new BaseGen(Builder,gFactory),PolygonChildModel=function(superClass){function PolygonChildModel(){return PolygonChildModel.__super__.constructor.apply(this,arguments)}return extend(PolygonChildModel,superClass),PolygonChildModel}(base)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolylineChildModel",["uiGmapBasePolyChildModel","uiGmapPolylineOptionsBuilder",function(BaseGen,Builder){var PolylineChildModel,base,gFactory;return gFactory=function(opts){return new google.maps.Polyline(opts)},base=BaseGen(Builder,gFactory),PolylineChildModel=function(superClass){function PolylineChildModel(){return PolylineChildModel.__super__.constructor.apply(this,arguments)}return extend(PolylineChildModel,superClass),PolylineChildModel}(base)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.child").factory("uiGmapWindowChildModel",["uiGmapBaseObject","uiGmapGmapUtil","uiGmapLogger","$compile","$http","$templateCache","uiGmapChromeFixes","uiGmapEventsHelper",function(BaseObject,GmapUtil,$log,$compile,$http,$templateCache,ChromeFixes,EventsHelper){var WindowChildModel;return WindowChildModel=function(superClass){function WindowChildModel(model1,scope1,opts,isIconVisibleOnClick,mapCtrl,markerScope,element,needToManualDestroy,markerIsVisibleAfterWindowClose){var maybeMarker;this.model=model1,this.scope=scope1,this.opts=opts,this.isIconVisibleOnClick=isIconVisibleOnClick,this.mapCtrl=mapCtrl,this.markerScope=markerScope,this.element=element,this.needToManualDestroy=null!=needToManualDestroy?needToManualDestroy:!1,this.markerIsVisibleAfterWindowClose=null!=markerIsVisibleAfterWindowClose?markerIsVisibleAfterWindowClose:!0,this.updateModel=bind(this.updateModel,this),this.destroy=bind(this.destroy,this),this.remove=bind(this.remove,this),this.getLatestPosition=bind(this.getLatestPosition,this),this.hideWindow=bind(this.hideWindow,this),this.showWindow=bind(this.showWindow,this),this.handleClick=bind(this.handleClick,this),this.watchOptions=bind(this.watchOptions,this),this.watchCoords=bind(this.watchCoords,this),this.createGWin=bind(this.createGWin,this),this.watchElement=bind(this.watchElement,this),this.watchAndDoShow=bind(this.watchAndDoShow,this),this.doShow=bind(this.doShow,this),this.clonedModel=_.clone(this.model,!0),this.getGmarker=function(){var ref,ref1;return null!=(null!=(ref=this.markerScope)?ref.getGMarker:void 0)&&null!=(ref1=this.markerScope)?ref1.getGMarker():void 0},this.listeners=[],this.createGWin(),maybeMarker=this.getGmarker(),null!=maybeMarker&&maybeMarker.setClickable(!0),this.watchElement(),this.watchOptions(),this.watchCoords(),this.watchAndDoShow(),this.scope.$on("$destroy",function(_this){return function(){return _this.destroy()}}(this)),$log.info(this)}return extend(WindowChildModel,superClass),WindowChildModel.include(GmapUtil),WindowChildModel.include(EventsHelper),WindowChildModel.prototype.doShow=function(wasOpen){return this.scope.show===!0||wasOpen?this.showWindow():this.hideWindow()},WindowChildModel.prototype.watchAndDoShow=function(){return null!=this.model.show&&(this.scope.show=this.model.show),this.scope.$watch("show",this.doShow,!0),this.doShow()},WindowChildModel.prototype.watchElement=function(){return this.scope.$watch(function(_this){return function(){var ref,wasOpen;if(_this.element||_this.html)return _this.html!==_this.element.html()&&_this.gObject?(null!=(ref=_this.opts)&&(ref.content=void 0),wasOpen=_this.gObject.isOpen(),_this.remove(),_this.createGWin(wasOpen)):void 0}}(this))},WindowChildModel.prototype.createGWin=function(isOpen){var _opts,defaults,maybeMarker,ref,ref1;return null==isOpen&&(isOpen=!1),maybeMarker=this.getGmarker(),defaults={},null!=this.opts&&(this.scope.coords&&(this.opts.position=this.getCoords(this.scope.coords)),defaults=this.opts),this.element&&(this.html=_.isObject(this.element)?this.element.html():this.element),_opts=this.scope.options?this.scope.options:defaults,this.opts=this.createWindowOptions(maybeMarker,this.markerScope||this.scope,this.html,_opts),null!=this.opts?(this.gObject||(this.opts.boxClass&&window.InfoBox&&"function"==typeof window.InfoBox?this.gObject=new window.InfoBox(this.opts):this.gObject=new google.maps.InfoWindow(this.opts),this.listeners.push(google.maps.event.addListener(this.gObject,"domready",function(){return ChromeFixes.maybeRepaint(this.content)})),this.listeners.push(google.maps.event.addListener(this.gObject,"closeclick",function(_this){return function(){return maybeMarker&&(maybeMarker.setAnimation(_this.oldMarkerAnimation),_this.markerIsVisibleAfterWindowClose&&_.delay(function(){return maybeMarker.setVisible(!1),maybeMarker.setVisible(_this.markerIsVisibleAfterWindowClose)},250)),_this.gObject.close(),_this.model.show=!1,null!=_this.scope.closeClick?_this.scope.$evalAsync(_this.scope.closeClick()):_this.scope.$evalAsync()}}(this)))),this.gObject.setContent(this.opts.content),this.handleClick((null!=(ref=this.scope)&&null!=(ref1=ref.options)?ref1.forceClick:void 0)||isOpen),this.doShow(this.gObject.isOpen())):void 0},WindowChildModel.prototype.watchCoords=function(){var scope;return scope=null!=this.markerScope?this.markerScope:this.scope,scope.$watch("coords",function(_this){return function(newValue,oldValue){var pos;if(newValue!==oldValue){if(null==newValue)_this.hideWindow();else if(!_this.validateCoords(newValue))return void $log.error("WindowChildMarker cannot render marker as scope.coords as no position on marker: "+JSON.stringify(_this.model));if(pos=_this.getCoords(newValue),_this.gObject.setPosition(pos),_this.opts)return _this.opts.position=pos}}}(this),!0)},WindowChildModel.prototype.watchOptions=function(){return this.scope.$watch("options",function(_this){return function(newValue,oldValue){if(newValue!==oldValue&&(_this.opts=newValue,null!=_this.gObject)){if(_this.gObject.setOptions(_this.opts),null!=_this.opts.visible&&_this.opts.visible)return _this.showWindow();if(null!=_this.opts.visible)return _this.hideWindow()}}}(this),!0)},WindowChildModel.prototype.handleClick=function(forceClick){var click,maybeMarker;if(null!=this.gObject)return maybeMarker=this.getGmarker(),click=function(_this){return function(){return null==_this.gObject&&_this.createGWin(),_this.showWindow(),null!=maybeMarker?(_this.initialMarkerVisibility=maybeMarker.getVisible(),_this.oldMarkerAnimation=maybeMarker.getAnimation(),maybeMarker.setVisible(_this.isIconVisibleOnClick)):void 0}}(this),forceClick&&click(),maybeMarker?this.listeners=this.listeners.concat(this.setEvents(maybeMarker,{events:{click:click}},this.model)):void 0},WindowChildModel.prototype.showWindow=function(){var compiled,show,templateScope;return null!=this.gObject?(show=function(_this){return function(){var isOpen,maybeMarker,pos;if(!_this.gObject.isOpen()){if(maybeMarker=_this.getGmarker(),null!=_this.gObject&&null!=_this.gObject.getPosition&&(pos=_this.gObject.getPosition()),maybeMarker&&(pos=maybeMarker.getPosition()),!pos)return;if(_this.gObject.open(_this.mapCtrl,maybeMarker),isOpen=_this.gObject.isOpen(),_this.model.show!==isOpen)return _this.model.show=isOpen}}}(this),this.scope.templateUrl?$http.get(this.scope.templateUrl,{cache:$templateCache}).then(function(_this){return function(content){var compiled,templateScope;return templateScope=_this.scope.$new(),angular.isDefined(_this.scope.templateParameter)&&(templateScope.parameter=_this.scope.templateParameter),compiled=$compile(content.data)(templateScope),_this.gObject.setContent(compiled[0]),show()}}(this)):this.scope.template?(templateScope=this.scope.$new(),angular.isDefined(this.scope.templateParameter)&&(templateScope.parameter=this.scope.templateParameter),compiled=$compile(this.scope.template)(templateScope),this.gObject.setContent(compiled[0]),show()):show()):void 0},WindowChildModel.prototype.hideWindow=function(){return null!=this.gObject&&this.gObject.isOpen()?this.gObject.close():void 0},WindowChildModel.prototype.getLatestPosition=function(overridePos){var maybeMarker;return maybeMarker=this.getGmarker(),null==this.gObject||null==maybeMarker||overridePos?overridePos?this.gObject.setPosition(overridePos):void 0:this.gObject.setPosition(maybeMarker.getPosition())},WindowChildModel.prototype.remove=function(){return this.hideWindow(),this.removeEvents(this.listeners),this.listeners.length=0,delete this.gObject,delete this.opts},WindowChildModel.prototype.destroy=function(manualOverride){var ref;return null==manualOverride&&(manualOverride=!1),this.remove(),null==this.scope||(null!=(ref=this.scope)?ref.$$destroyed:void 0)||!this.needToManualDestroy&&!manualOverride?void 0:this.scope.$destroy()},WindowChildModel.prototype.updateModel=function(model){return this.clonedModel=_.extend({},model),_.extend(this.model,this.clonedModel)},WindowChildModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapBasePolysParentModel",["$timeout","uiGmapLogger","uiGmapModelKey","uiGmapModelsWatcher","uiGmapPropMap","uiGmap_async","uiGmapPromise",function($timeout,$log,ModelKey,ModelsWatcher,PropMap,_async,uiGmapPromise){return function(IPoly,PolyChildModel,gObjectName){var BasePolysParentModel;return BasePolysParentModel=function(superClass){function BasePolysParentModel(scope,element,attrs,gMap1,defaults){this.element=element,this.attrs=attrs,this.gMap=gMap1,this.defaults=defaults,this.createChild=bind(this.createChild,this),this.pieceMeal=bind(this.pieceMeal,this),this.createAllNew=bind(this.createAllNew,this),this.watchIdKey=bind(this.watchIdKey,this),this.createChildScopes=bind(this.createChildScopes,this),this.watchDestroy=bind(this.watchDestroy,this),this.onDestroy=bind(this.onDestroy,this),this.rebuildAll=bind(this.rebuildAll,this),this.doINeedToWipe=bind(this.doINeedToWipe,this),this.watchModels=bind(this.watchModels,this),BasePolysParentModel.__super__.constructor.call(this,scope),this["interface"]=IPoly,this.$log=$log,this.plurals=new PropMap,_.each(IPoly.scopeKeys,function(_this){return function(name){return _this[name+"Key"]=void 0}}(this)),this.models=void 0,this.firstTime=!0,this.$log.info(this),this.createChildScopes()}return extend(BasePolysParentModel,superClass),BasePolysParentModel.include(ModelsWatcher),BasePolysParentModel.prototype.watchModels=function(scope){return scope.$watchCollection("models",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.doINeedToWipe(newValue)||scope.doRebuildAll?_this.rebuildAll(scope,!0,!0):_this.createChildScopes(!1):void 0}}(this))},BasePolysParentModel.prototype.doINeedToWipe=function(newValue){var newValueIsEmpty;return newValueIsEmpty=null!=newValue?0===newValue.length:!0,this.plurals.length>0&&newValueIsEmpty},BasePolysParentModel.prototype.rebuildAll=function(scope,doCreate,doDelete){return this.onDestroy(doDelete).then(function(_this){return function(){return doCreate?_this.createChildScopes():void 0}}(this))},BasePolysParentModel.prototype.onDestroy=function(scope){return BasePolysParentModel.__super__.onDestroy.call(this,this.scope),_async.promiseLock(this,uiGmapPromise.promiseTypes["delete"],void 0,void 0,function(_this){return function(){return _async.each(_this.plurals.values(),function(child){return child.destroy(!0)},_async.chunkSizeFrom(_this.scope.cleanchunk,!1)).then(function(){var ref;return null!=(ref=_this.plurals)?ref.removeAll():void 0})}}(this))},BasePolysParentModel.prototype.watchDestroy=function(scope){return scope.$on("$destroy",function(_this){return function(){return _this.rebuildAll(scope,!1,!0)}}(this))},BasePolysParentModel.prototype.createChildScopes=function(isCreatingFromScratch){return null==isCreatingFromScratch&&(isCreatingFromScratch=!0),angular.isUndefined(this.scope.models)?void this.$log.error("No models to create "+gObjectName+"s from! I Need direct models!"):null!=this.gMap&&null!=this.scope.models?(this.watchIdKey(this.scope),isCreatingFromScratch?this.createAllNew(this.scope,!1):this.pieceMeal(this.scope,!1)):void 0},BasePolysParentModel.prototype.watchIdKey=function(scope){return this.setIdKey(scope),scope.$watch("idKey",function(_this){return function(newValue,oldValue){return newValue!==oldValue&&null==newValue?(_this.idKey=newValue,_this.rebuildAll(scope,!0,!0)):void 0}}(this))},BasePolysParentModel.prototype.createAllNew=function(scope,isArray){var maybeCanceled;return null==isArray&&(isArray=!1),this.models=scope.models,this.firstTime&&(this.watchModels(scope),this.watchDestroy(scope)),this.didQueueInitPromise(this,scope)?void 0:(maybeCanceled=null,_async.promiseLock(this,uiGmapPromise.promiseTypes.create,"createAllNew",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return _async.each(scope.models,function(model){var child;return child=_this.createChild(model,_this.gMap),maybeCanceled&&($log.debug("createNew should fall through safely"),child.isEnabled=!1),maybeCanceled},_async.chunkSizeFrom(scope.chunk)).then(function(){return _this.firstTime=!1})}}(this)))},BasePolysParentModel.prototype.pieceMeal=function(scope,isArray){var maybeCanceled,payload;return null==isArray&&(isArray=!0),scope.$$destroyed?void 0:(maybeCanceled=null,payload=null,this.models=scope.models,null!=scope&&this.modelsLength()&&this.plurals.length?_async.promiseLock(this,uiGmapPromise.promiseTypes.update,"pieceMeal",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return uiGmapPromise.promise(function(){return _this.figureOutState(_this.idKey,scope,_this.plurals,_this.modelKeyComparison)}).then(function(state){return payload=state,payload.updates.length&&$log.info("polygons updates: "+payload.updates.length+" will be missed"),_async.each(payload.removals,function(child){return null!=child?(child.destroy(),_this.plurals.remove(child.model[_this.idKey]),maybeCanceled):void 0},_async.chunkSizeFrom(scope.chunk))}).then(function(){return _async.each(payload.adds,function(modelToAdd){return maybeCanceled&&$log.debug("pieceMeal should fall through safely"),_this.createChild(modelToAdd,_this.gMap),maybeCanceled},_async.chunkSizeFrom(scope.chunk))})}}(this)):(this.inProgress=!1,this.rebuildAll(this.scope,!0,!0)))},BasePolysParentModel.prototype.createChild=function(model,gMap){var child,childScope;return childScope=this.scope.$new(!1),this.setChildScope(IPoly.scopeKeys,childScope,model),childScope.$watch("model",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.setChildScope(childScope,newValue):void 0}}(this),!0),childScope["static"]=this.scope["static"],child=new PolyChildModel(childScope,this.attrs,gMap,this.defaults,model),null==model[this.idKey]?void this.$log.error(gObjectName+" model has no id to assign a child to.\nThis is required for performance. Please assign id,\nor redirect id to a different key."):(this.plurals.put(model[this.idKey],child),child)},BasePolysParentModel}(ModelKey)}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapCircleParentModel",["uiGmapLogger","$timeout","uiGmapGmapUtil","uiGmapEventsHelper","uiGmapCircleOptionsBuilder",function($log,$timeout,GmapUtil,EventsHelper,Builder){var CircleParentModel;return CircleParentModel=function(superClass){function CircleParentModel(scope,element,attrs,map,DEFAULTS){var clean,gObject,lastRadius;this.attrs=attrs,this.map=map,this.DEFAULTS=DEFAULTS,this.scope=scope,lastRadius=null,clean=function(_this){return function(){return lastRadius=null,null!=_this.listeners?(_this.removeEvents(_this.listeners),_this.listeners=void 0):void 0}}(this),gObject=new google.maps.Circle(this.buildOpts(GmapUtil.getCoords(scope.center),scope.radius)),this.setMyOptions=function(_this){return function(newVals,oldVals){return _.isEqual(newVals,oldVals)?void 0:gObject.setOptions(_this.buildOpts(GmapUtil.getCoords(scope.center),scope.radius))}}(this),this.props=this.props.concat([{prop:"center",isColl:!0},{prop:"fill",isColl:!0},"radius","zIndex"]),this.watchProps(),clean(),this.listeners=this.setEvents(gObject,scope,scope,["radius_changed"]),null!=this.listeners&&this.listeners.push(google.maps.event.addListener(gObject,"radius_changed",function(){var newRadius,work;return newRadius=gObject.getRadius(),newRadius!==lastRadius?(lastRadius=newRadius,work=function(){var ref,ref1;return newRadius!==scope.radius&&(scope.radius=newRadius),(null!=(ref=scope.events)?ref.radius_changed:void 0)&&_.isFunction(null!=(ref1=scope.events)?ref1.radius_changed:void 0)?scope.events.radius_changed(gObject,"radius_changed",scope,arguments):void 0},angular.mock?work():scope.$evalAsync(function(){return work()})):void 0})),null!=this.listeners&&this.listeners.push(google.maps.event.addListener(gObject,"center_changed",function(){return scope.$evalAsync(function(){return angular.isDefined(scope.center.type)?(scope.center.coordinates[1]=gObject.getCenter().lat(),scope.center.coordinates[0]=gObject.getCenter().lng()):(scope.center.latitude=gObject.getCenter().lat(),scope.center.longitude=gObject.getCenter().lng())})})),scope.$on("$destroy",function(_this){return function(){return clean(),gObject.setMap(null)}}(this)),$log.info(this)}return extend(CircleParentModel,superClass),CircleParentModel.include(GmapUtil),CircleParentModel.include(EventsHelper),CircleParentModel}(Builder)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapDrawingManagerParentModel",["uiGmapLogger","$timeout","uiGmapBaseObject","uiGmapEventsHelper",function($log,$timeout,BaseObject,EventsHelper){var DrawingManagerParentModel;return DrawingManagerParentModel=function(superClass){function DrawingManagerParentModel(scope,element,attrs,map){var gObject,listeners;this.scope=scope,this.attrs=attrs,this.map=map,gObject=new google.maps.drawing.DrawingManager(this.scope.options),gObject.setMap(this.map),listeners=void 0,null!=this.scope.control&&(this.scope.control.getDrawingManager=function(){return gObject}),!this.scope["static"]&&this.scope.options&&this.scope.$watch("options",function(newValue){return null!=gObject?gObject.setOptions(newValue):void 0},!0),null!=this.scope.events&&(listeners=this.setEvents(gObject,this.scope,this.scope),this.scope.$watch("events",function(_this){return function(newValue,oldValue){return _.isEqual(newValue,oldValue)?void 0:(null!=listeners&&_this.removeEvents(listeners),listeners=_this.setEvents(gObject,_this.scope,_this.scope))}}(this))),this.scope.$on("$destroy",function(_this){return function(){return null!=listeners&&_this.removeEvents(listeners),gObject.setMap(null),gObject=null}}(this))}return extend(DrawingManagerParentModel,superClass),DrawingManagerParentModel.include(EventsHelper),DrawingManagerParentModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapIMarkerParentModel",["uiGmapModelKey","uiGmapLogger",function(ModelKey,Logger){var IMarkerParentModel;return IMarkerParentModel=function(superClass){function IMarkerParentModel(scope1,element,attrs,map){if(this.scope=scope1,this.element=element,this.attrs=attrs,this.map=map,this.onWatch=bind(this.onWatch,this),this.watch=bind(this.watch,this),this.validateScope=bind(this.validateScope,this),IMarkerParentModel.__super__.constructor.call(this,this.scope),this.$log=Logger,!this.validateScope(this.scope))throw new String("Unable to construct IMarkerParentModel due to invalid scope");this.doClick=angular.isDefined(this.attrs.click),null!=this.scope.options&&(this.DEFAULTS=this.scope.options),this.watch("coords",this.scope),this.watch("icon",this.scope),this.watch("options",this.scope),this.scope.$on("$destroy",function(_this){return function(){return _this.onDestroy(_this.scope)}}(this))}return extend(IMarkerParentModel,superClass),IMarkerParentModel.prototype.DEFAULTS={},IMarkerParentModel.prototype.validateScope=function(scope){var ret;return null==scope?(this.$log.error(this.constructor.name+": invalid scope used"),!1):(ret=null!=scope.coords,ret?ret:(this.$log.error(this.constructor.name+": no valid coords attribute found"),!1))},IMarkerParentModel.prototype.watch=function(propNameToWatch,scope,equalityCheck){return null==equalityCheck&&(equalityCheck=!0),scope.$watch(propNameToWatch,function(_this){return function(newValue,oldValue){return _.isEqual(newValue,oldValue)?void 0:_this.onWatch(propNameToWatch,scope,newValue,oldValue)}}(this),equalityCheck)},IMarkerParentModel.prototype.onWatch=function(propNameToWatch,scope,newValue,oldValue){},IMarkerParentModel}(ModelKey)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapIWindowParentModel",["uiGmapModelKey","uiGmapGmapUtil","uiGmapLogger",function(ModelKey,GmapUtil,Logger){var IWindowParentModel;return IWindowParentModel=function(superClass){function IWindowParentModel(scope,element,attrs,ctrls,$timeout,$compile,$http,$templateCache){IWindowParentModel.__super__.constructor.call(this,scope),this.$log=Logger,this.$timeout=$timeout,this.$compile=$compile,this.$http=$http,this.$templateCache=$templateCache,this.DEFAULTS={},null!=scope.options&&(this.DEFAULTS=scope.options)}return extend(IWindowParentModel,superClass),IWindowParentModel.include(GmapUtil),IWindowParentModel.prototype.getItem=function(scope,modelsPropToIterate,index){return"models"===modelsPropToIterate?scope[modelsPropToIterate][index]:scope[modelsPropToIterate].get(index)},IWindowParentModel}(ModelKey)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapLayerParentModel",["uiGmapBaseObject","uiGmapLogger","$timeout",function(BaseObject,Logger,$timeout){
var LayerParentModel;return LayerParentModel=function(superClass){function LayerParentModel(scope,element,attrs,gMap,onLayerCreated,$log){return this.scope=scope,this.element=element,this.attrs=attrs,this.gMap=gMap,this.onLayerCreated=null!=onLayerCreated?onLayerCreated:void 0,this.$log=null!=$log?$log:Logger,this.createGoogleLayer=bind(this.createGoogleLayer,this),null==this.attrs.type?void this.$log.info("type attribute for the layer directive is mandatory. Layer creation aborted!!"):(this.createGoogleLayer(),this.doShow=!0,angular.isDefined(this.attrs.show)&&(this.doShow=this.scope.show),this.doShow&&null!=this.gMap&&this.gObject.setMap(this.gMap),this.scope.$watch("show",function(_this){return function(newValue,oldValue){return newValue!==oldValue?(_this.doShow=newValue,newValue?_this.gObject.setMap(_this.gMap):_this.gObject.setMap(null)):void 0}}(this),!0),this.scope.$watch("options",function(_this){return function(newValue,oldValue){return newValue!==oldValue?(_this.gObject.setMap(null),_this.gObject=null,_this.createGoogleLayer()):void 0}}(this),!0),void this.scope.$on("$destroy",function(_this){return function(){return _this.gObject.setMap(null)}}(this)))}return extend(LayerParentModel,superClass),LayerParentModel.prototype.createGoogleLayer=function(){var base;return null==this.attrs.options?this.gObject=void 0===this.attrs.namespace?new google.maps[this.attrs.type]:new google.maps[this.attrs.namespace][this.attrs.type]:this.gObject=void 0===this.attrs.namespace?new google.maps[this.attrs.type](this.scope.options):new google.maps[this.attrs.namespace][this.attrs.type](this.scope.options),null!=this.gObject&&null!=this.onLayerCreated&&"function"==typeof(base=this.onLayerCreated(this.scope,this.gObject))?base(this.gObject):void 0},LayerParentModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapMapTypeParentModel",["uiGmapBaseObject","uiGmapLogger",function(BaseObject,Logger){var MapTypeParentModel;return MapTypeParentModel=function(superClass){function MapTypeParentModel(scope,element,attrs,gMap,$log){return this.scope=scope,this.element=element,this.attrs=attrs,this.gMap=gMap,this.$log=null!=$log?$log:Logger,this.hideOverlay=bind(this.hideOverlay,this),this.showOverlay=bind(this.showOverlay,this),this.refreshMapType=bind(this.refreshMapType,this),this.createMapType=bind(this.createMapType,this),null==this.attrs.options?void this.$log.info("options attribute for the map-type directive is mandatory. Map type creation aborted!!"):(this.id=this.gMap.overlayMapTypesCount=this.gMap.overlayMapTypesCount+1||0,this.doShow=!0,this.createMapType(),angular.isDefined(this.attrs.show)&&(this.doShow=this.scope.show),this.doShow&&null!=this.gMap&&this.showOverlay(),this.scope.$watch("show",function(_this){return function(newValue,oldValue){return newValue!==oldValue?(_this.doShow=newValue,newValue?_this.showOverlay():_this.hideOverlay()):void 0}}(this),!0),this.scope.$watch("options",function(_this){return function(newValue,oldValue){return _.isEqual(newValue,oldValue)?void 0:_this.refreshMapType()}}(this),!0),angular.isDefined(this.attrs.refresh)&&this.scope.$watch("refresh",function(_this){return function(newValue,oldValue){return _.isEqual(newValue,oldValue)?void 0:_this.refreshMapType()}}(this),!0),void this.scope.$on("$destroy",function(_this){return function(){return _this.hideOverlay(),_this.mapType=null}}(this)))}return extend(MapTypeParentModel,superClass),MapTypeParentModel.prototype.createMapType=function(){if(null!=this.scope.options.getTile)this.mapType=this.scope.options;else{if(null==this.scope.options.getTileUrl)return void this.$log.info("options should provide either getTile or getTileUrl methods. Map type creation aborted!!");this.mapType=new google.maps.ImageMapType(this.scope.options)}return this.attrs.id&&this.scope.id&&(this.gMap.mapTypes.set(this.scope.id,this.mapType),angular.isDefined(this.attrs.show)||(this.doShow=!1)),this.mapType.layerId=this.id},MapTypeParentModel.prototype.refreshMapType=function(){return this.hideOverlay(),this.mapType=null,this.createMapType(),this.doShow&&null!=this.gMap?this.showOverlay():void 0},MapTypeParentModel.prototype.showOverlay=function(){return this.gMap.overlayMapTypes.push(this.mapType)},MapTypeParentModel.prototype.hideOverlay=function(){var found;return found=!1,this.gMap.overlayMapTypes.forEach(function(_this){return function(mapType,index){found||mapType.layerId!==_this.id||(found=!0,_this.gMap.overlayMapTypes.removeAt(index))}}(this))},MapTypeParentModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapMarkersParentModel",["uiGmapIMarkerParentModel","uiGmapModelsWatcher","uiGmapPropMap","uiGmapMarkerChildModel","uiGmap_async","uiGmapClustererMarkerManager","uiGmapMarkerManager","$timeout","uiGmapIMarker","uiGmapPromise","uiGmapGmapUtil","uiGmapLogger",function(IMarkerParentModel,ModelsWatcher,PropMap,MarkerChildModel,_async,ClustererMarkerManager,MarkerManager,$timeout,IMarker,uiGmapPromise,GmapUtil,$log){var MarkersParentModel,_setPlurals;return _setPlurals=function(val,objToSet){return objToSet.plurals=new PropMap,objToSet.scope.plurals=objToSet.plurals,objToSet},MarkersParentModel=function(superClass){function MarkersParentModel(scope,element,attrs,map){this.onDestroy=bind(this.onDestroy,this),this.newChildMarker=bind(this.newChildMarker,this),this.pieceMeal=bind(this.pieceMeal,this),this.rebuildAll=bind(this.rebuildAll,this),this.createAllNew=bind(this.createAllNew,this),this.createChildScopes=bind(this.createChildScopes,this),this.validateScope=bind(this.validateScope,this),this.onWatch=bind(this.onWatch,this);var self;MarkersParentModel.__super__.constructor.call(this,scope,element,attrs,map),this["interface"]=IMarker,self=this,_setPlurals(new PropMap,this),this.scope.pluralsUpdate={updateCtr:0},this.$log.info(this),this.doRebuildAll=null!=this.scope.doRebuildAll?this.scope.doRebuildAll:!1,this.setIdKey(this.scope),this.scope.$watch("doRebuildAll",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.doRebuildAll=newValue:void 0}}(this)),this.modelsLength()||(this.modelsRendered=!1),this.scope.$watch("models",function(_this){return function(newValue,oldValue){if(!_.isEqual(newValue,oldValue)||!_this.modelsRendered){if(0===newValue.length&&0===oldValue.length)return;return _this.modelsRendered=!0,_this.onWatch("models",_this.scope,newValue,oldValue)}}}(this),!this.isTrue(attrs.modelsbyref)),this.watch("doCluster",this.scope),this.watch("clusterOptions",this.scope),this.watch("clusterEvents",this.scope),this.watch("fit",this.scope),this.watch("idKey",this.scope),this.gManager=void 0,this.createAllNew(this.scope)}return extend(MarkersParentModel,superClass),MarkersParentModel.include(GmapUtil),MarkersParentModel.include(ModelsWatcher),MarkersParentModel.prototype.onWatch=function(propNameToWatch,scope,newValue,oldValue){return"idKey"===propNameToWatch&&newValue!==oldValue&&(this.idKey=newValue),this.doRebuildAll||"doCluster"===propNameToWatch?this.rebuildAll(scope):this.pieceMeal(scope)},MarkersParentModel.prototype.validateScope=function(scope){var modelsNotDefined;return modelsNotDefined=angular.isUndefined(scope.models)||void 0===scope.models,modelsNotDefined&&this.$log.error(this.constructor.name+": no valid models attribute found"),MarkersParentModel.__super__.validateScope.call(this,scope)||modelsNotDefined},MarkersParentModel.prototype.createChildScopes=function(isCreatingFromScratch){return null!=this.gMap&&null!=this.scope.models?isCreatingFromScratch?this.createAllNew(this.scope,!1):this.pieceMeal(this.scope,!1):void 0},MarkersParentModel.prototype.createAllNew=function(scope){var maybeCanceled,ref,ref1,ref2,self;return null!=this.gManager&&(this.gManager.clear(),delete this.gManager),scope.doCluster?(scope.clusterEvents&&(self=this,this.origClusterEvents?angular.extend(scope.clusterEvents,this.origClusterEvents):this.origClusterEvents={click:null!=(ref=scope.clusterEvents)?ref.click:void 0,mouseout:null!=(ref1=scope.clusterEvents)?ref1.mouseout:void 0,mouseover:null!=(ref2=scope.clusterEvents)?ref2.mouseover:void 0},angular.extend(scope.clusterEvents,{click:function(cluster){return self.maybeExecMappedEvent(cluster,"click")},mouseout:function(cluster){return self.maybeExecMappedEvent(cluster,"mouseout")},mouseover:function(cluster){return self.maybeExecMappedEvent(cluster,"mouseover")}})),this.gManager=new ClustererMarkerManager(this.map,void 0,scope.clusterOptions,scope.clusterEvents)):this.gManager=new MarkerManager(this.map),this.didQueueInitPromise(this,scope)?void 0:(maybeCanceled=null,_async.promiseLock(this,uiGmapPromise.promiseTypes.create,"createAllNew",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return _async.each(scope.models,function(model){return _this.newChildMarker(model,scope),maybeCanceled},_async.chunkSizeFrom(scope.chunk)).then(function(){return _this.modelsRendered=!0,scope.fit&&_this.gManager.fit(),_this.gManager.draw(),_this.scope.pluralsUpdate.updateCtr+=1},_async.chunkSizeFrom(scope.chunk))}}(this)))},MarkersParentModel.prototype.rebuildAll=function(scope){var ref;if(scope.doRebuild||void 0===scope.doRebuild)return(null!=(ref=this.scope.plurals)?ref.length:void 0)?this.onDestroy(scope).then(function(_this){return function(){return _this.createAllNew(scope)}}(this)):this.createAllNew(scope)},MarkersParentModel.prototype.pieceMeal=function(scope){var maybeCanceled,payload;if(!scope.$$destroyed)return maybeCanceled=null,payload=null,this.modelsLength()&&this.scope.plurals.length?_async.promiseLock(this,uiGmapPromise.promiseTypes.update,"pieceMeal",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return uiGmapPromise.promise(function(){return _this.figureOutState(_this.idKey,scope,_this.scope.plurals,_this.modelKeyComparison)}).then(function(state){return payload=state,_async.each(payload.removals,function(child){return null!=child?(null!=child.destroy&&child.destroy(),_this.scope.plurals.remove(child.id),maybeCanceled):void 0},_async.chunkSizeFrom(scope.chunk))}).then(function(){return _async.each(payload.adds,function(modelToAdd){return _this.newChildMarker(modelToAdd,scope),maybeCanceled},_async.chunkSizeFrom(scope.chunk))}).then(function(){return _async.each(payload.updates,function(update){return _this.updateChild(update.child,update.model),maybeCanceled},_async.chunkSizeFrom(scope.chunk))}).then(function(){return(payload.adds.length>0||payload.removals.length>0||payload.updates.length>0)&&(scope.plurals=_this.scope.plurals,scope.fit&&_this.gManager.fit(),_this.gManager.draw()),_this.scope.pluralsUpdate.updateCtr+=1})}}(this)):(this.inProgress=!1,this.rebuildAll(scope))},MarkersParentModel.prototype.newChildMarker=function(model,scope){var child,childScope,doDrawSelf,keys;return null==model[this.idKey]?void this.$log.error("Marker model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):(this.$log.info("child",child,"markers",this.scope.plurals),childScope=scope.$new(!0),childScope.events=scope.events,keys={},IMarker.scopeKeys.forEach(function(k){return keys[k]=scope[k]}),child=new MarkerChildModel(childScope,model,keys,this.map,this.DEFAULTS,this.doClick,this.gManager,doDrawSelf=!1),this.scope.plurals.put(model[this.idKey],child),child)},MarkersParentModel.prototype.onDestroy=function(scope){return MarkersParentModel.__super__.onDestroy.call(this,scope),_async.promiseLock(this,uiGmapPromise.promiseTypes["delete"],void 0,void 0,function(_this){return function(){return _async.each(_this.scope.plurals.values(),function(model){return null!=model?model.destroy(!1):void 0},_async.chunkSizeFrom(_this.scope.cleanchunk,!1)).then(function(){return null!=_this.gManager&&_this.gManager.clear(),_this.plurals.removeAll(),_this.plurals!==_this.scope.plurals&&console.error("plurals out of sync for MarkersParentModel"),_this.scope.pluralsUpdate.updateCtr+=1})}}(this))},MarkersParentModel.prototype.maybeExecMappedEvent=function(cluster,fnName){var pair,ref;return _.isFunction(null!=(ref=this.scope.clusterEvents)?ref[fnName]:void 0)&&(pair=this.mapClusterToPlurals(cluster),this.origClusterEvents[fnName])?this.origClusterEvents[fnName](pair.cluster,pair.mapped):void 0},MarkersParentModel.prototype.mapClusterToPlurals=function(cluster){var mapped;return mapped=cluster.getMarkers().map(function(_this){return function(g){return _this.scope.plurals.get(g.key).model}}(this)),{cluster:cluster,mapped:mapped}},MarkersParentModel.prototype.getItem=function(scope,modelsPropToIterate,index){return"models"===modelsPropToIterate?scope[modelsPropToIterate][index]:scope[modelsPropToIterate].get(index)},MarkersParentModel}(IMarkerParentModel)}])}.call(this),function(){["Polygon","Polyline"].forEach(function(name){return angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmap"+name+"sParentModel",["uiGmapBasePolysParentModel","uiGmap"+name+"ChildModel","uiGmapI"+name,function(BasePolysParentModel,ChildModel,IPoly){return BasePolysParentModel(IPoly,ChildModel,name)}])})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapRectangleParentModel",["uiGmapLogger","uiGmapGmapUtil","uiGmapEventsHelper","uiGmapRectangleOptionsBuilder",function($log,GmapUtil,EventsHelper,Builder){var RectangleParentModel;return RectangleParentModel=function(superClass){function RectangleParentModel(scope,element,attrs,map,DEFAULTS){var bounds,clear,createBounds,dragging,fit,gObject,init,listeners,myListeners,settingBoundsFromScope,updateBounds;this.scope=scope,this.attrs=attrs,this.map=map,this.DEFAULTS=DEFAULTS,bounds=void 0,dragging=!1,myListeners=[],listeners=void 0,fit=function(_this){return function(){return _this.isTrue(_this.attrs.fit)?_this.fitMapBounds(_this.map,bounds):void 0}}(this),createBounds=function(_this){return function(){var ref,ref1,ref2;return null!=_this.scope.bounds&&null!=(null!=(ref=_this.scope.bounds)?ref.sw:void 0)&&null!=(null!=(ref1=_this.scope.bounds)?ref1.ne:void 0)&&_this.validateBoundPoints(_this.scope.bounds)?(bounds=_this.convertBoundPoints(_this.scope.bounds),$log.info("new new bounds created: "+JSON.stringify(bounds))):null!=_this.scope.bounds.getNorthEast&&null!=_this.scope.bounds.getSouthWest?bounds=_this.scope.bounds:null!=_this.scope.bounds?$log.error("Invalid bounds for newValue: "+JSON.stringify(null!=(ref2=_this.scope)?ref2.bounds:void 0)):void 0}}(this),createBounds(),gObject=new google.maps.Rectangle(this.buildOpts(bounds)),$log.info("gObject (rectangle) created: "+gObject),settingBoundsFromScope=!1,updateBounds=function(_this){return function(){var b,ne,sw;return b=gObject.getBounds(),ne=b.getNorthEast(),sw=b.getSouthWest(),settingBoundsFromScope?void 0:_this.scope.$evalAsync(function(s){return null!=s.bounds&&null!=s.bounds.sw&&null!=s.bounds.ne&&(s.bounds.ne={latitude:ne.lat(),longitude:ne.lng()},s.bounds.sw={latitude:sw.lat(),longitude:sw.lng()}),null!=s.bounds.getNorthEast&&null!=s.bounds.getSouthWest?s.bounds=b:void 0})}}(this),init=function(_this){return function(){return fit(),_this.removeEvents(myListeners),myListeners.push(google.maps.event.addListener(gObject,"dragstart",function(){return dragging=!0})),myListeners.push(google.maps.event.addListener(gObject,"dragend",function(){return dragging=!1,updateBounds()})),myListeners.push(google.maps.event.addListener(gObject,"bounds_changed",function(){return dragging?void 0:updateBounds()}))}}(this),clear=function(_this){return function(){return _this.removeEvents(myListeners),null!=listeners&&_this.removeEvents(listeners),gObject.setMap(null)}}(this),null!=bounds&&init(),this.scope.$watch("bounds",function(newValue,oldValue){var isNew;if(!(_.isEqual(newValue,oldValue)&&null!=bounds||dragging))return settingBoundsFromScope=!0,null==newValue?void clear():(null==bounds?isNew=!0:fit(),createBounds(),gObject.setBounds(bounds),settingBoundsFromScope=!1,isNew&&null!=bounds?init():void 0)},!0),this.setMyOptions=function(_this){return function(newVals,oldVals){return _.isEqual(newVals,oldVals)||null==bounds||null==newVals?void 0:gObject.setOptions(_this.buildOpts(bounds))}}(this),this.props.push("bounds"),this.watchProps(this.props),null!=this.attrs.events&&(listeners=this.setEvents(gObject,this.scope,this.scope),this.scope.$watch("events",function(_this){return function(newValue,oldValue){return _.isEqual(newValue,oldValue)?void 0:(null!=listeners&&_this.removeEvents(listeners),listeners=_this.setEvents(gObject,_this.scope,_this.scope))}}(this))),this.scope.$on("$destroy",function(_this){return function(){return clear()}}(this)),$log.info(this)}return extend(RectangleParentModel,superClass),RectangleParentModel.include(GmapUtil),RectangleParentModel.include(EventsHelper),RectangleParentModel}(Builder)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapSearchBoxParentModel",["uiGmapBaseObject","uiGmapLogger","uiGmapEventsHelper","$timeout","$http","$templateCache",function(BaseObject,Logger,EventsHelper,$timeout,$http,$templateCache){var SearchBoxParentModel;return SearchBoxParentModel=function(superClass){function SearchBoxParentModel(scope,element,attrs,gMap,ctrlPosition,template,$log){var controlDiv;return this.scope=scope,this.element=element,this.attrs=attrs,this.gMap=gMap,this.ctrlPosition=ctrlPosition,this.template=template,this.$log=null!=$log?$log:Logger,this.setVisibility=bind(this.setVisibility,this),this.getBounds=bind(this.getBounds,this),this.setBounds=bind(this.setBounds,this),this.createSearchBox=bind(this.createSearchBox,this),this.addToParentDiv=bind(this.addToParentDiv,this),this.addAsMapControl=bind(this.addAsMapControl,this),this.init=bind(this.init,this),null==this.attrs.template?void this.$log.error("template attribute for the search-box directive is mandatory. Places Search Box creation aborted!!"):(angular.isUndefined(this.scope.options)&&(this.scope.options={},this.scope.options.visible=!0),angular.isUndefined(this.scope.options.visible)&&(this.scope.options.visible=!0),angular.isUndefined(this.scope.options.autocomplete)&&(this.scope.options.autocomplete=!1),this.visible=this.scope.options.visible,this.autocomplete=this.scope.options.autocomplete,controlDiv=angular.element("<div></div>"),controlDiv.append(this.template),this.input=controlDiv.find("input")[0],void this.init())}return extend(SearchBoxParentModel,superClass),SearchBoxParentModel.include(EventsHelper),SearchBoxParentModel.prototype.init=function(){return this.createSearchBox(),this.scope.$watch("options",function(_this){return function(newValue,oldValue){return angular.isObject(newValue)&&(null!=newValue.bounds&&_this.setBounds(newValue.bounds),null!=newValue.visible&&_this.visible!==newValue.visible)?_this.setVisibility(newValue.visible):void 0}}(this),!0),null!=this.attrs.parentdiv?this.addToParentDiv():this.addAsMapControl(),this.autocomplete?this.listener=google.maps.event.addListener(this.gObject,"place_changed",function(_this){return function(){return _this.places=_this.gObject.getPlace()}}(this)):this.listener=google.maps.event.addListener(this.gObject,"places_changed",function(_this){return function(){return _this.places=_this.gObject.getPlaces()}}(this)),this.listeners=this.setEvents(this.gObject,this.scope,this.scope),this.$log.info(this),this.scope.$on("$destroy",function(_this){return function(){return _this.gObject=null}}(this))},SearchBoxParentModel.prototype.addAsMapControl=function(){return this.gMap.controls[google.maps.ControlPosition[this.ctrlPosition]].push(this.input)},SearchBoxParentModel.prototype.addToParentDiv=function(){return this.parentDiv=angular.element(document.getElementById(this.scope.parentdiv)),this.parentDiv.append(this.input)},SearchBoxParentModel.prototype.createSearchBox=function(){return this.autocomplete?this.gObject=new google.maps.places.Autocomplete(this.input,this.scope.options):this.gObject=new google.maps.places.SearchBox(this.input,this.scope.options)},SearchBoxParentModel.prototype.setBounds=function(bounds){if(angular.isUndefined(bounds.isEmpty))this.$log.error("Error: SearchBoxParentModel setBounds. Bounds not an instance of LatLngBounds.");else if(bounds.isEmpty()===!1&&null!=this.gObject)return this.gObject.setBounds(bounds)},SearchBoxParentModel.prototype.getBounds=function(){return this.gObject.getBounds()},SearchBoxParentModel.prototype.setVisibility=function(val){return null!=this.attrs.parentdiv?val===!1?this.parentDiv.addClass("ng-hide"):this.parentDiv.removeClass("ng-hide"):val===!1?this.gMap.controls[google.maps.ControlPosition[this.ctrlPosition]].clear():this.gMap.controls[google.maps.ControlPosition[this.ctrlPosition]].push(this.input),this.visible=val},SearchBoxParentModel}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api.models.parent").factory("uiGmapWindowsParentModel",["uiGmapIWindowParentModel","uiGmapModelsWatcher","uiGmapPropMap","uiGmapWindowChildModel","uiGmapLinked","uiGmap_async","uiGmapLogger","$timeout","$compile","$http","$templateCache","$interpolate","uiGmapPromise","uiGmapIWindow","uiGmapGmapUtil",function(IWindowParentModel,ModelsWatcher,PropMap,WindowChildModel,Linked,_async,$log,$timeout,$compile,$http,$templateCache,$interpolate,uiGmapPromise,IWindow,GmapUtil){var WindowsParentModel;return WindowsParentModel=function(superClass){function WindowsParentModel(scope,element,attrs,ctrls,gMap1,markersScope){this.gMap=gMap1,this.markersScope=markersScope,this.modelKeyComparison=bind(this.modelKeyComparison,this),this.interpolateContent=bind(this.interpolateContent,this),this.setChildScope=bind(this.setChildScope,this),this.createWindow=bind(this.createWindow,this),this.setContentKeys=bind(this.setContentKeys,this),this.pieceMeal=bind(this.pieceMeal,this),this.createAllNew=bind(this.createAllNew,this),this.watchIdKey=bind(this.watchIdKey,this),this.createChildScopes=bind(this.createChildScopes,this),this.watchOurScope=bind(this.watchOurScope,this),this.watchDestroy=bind(this.watchDestroy,this),this.onDestroy=bind(this.onDestroy,this),this.rebuildAll=bind(this.rebuildAll,this),this.doINeedToWipe=bind(this.doINeedToWipe,this),this.watchModels=bind(this.watchModels,this),this.go=bind(this.go,this),WindowsParentModel.__super__.constructor.call(this,scope,element,attrs,ctrls,$timeout,$compile,$http,$templateCache),this["interface"]=IWindow,this.plurals=new PropMap,_.each(IWindow.scopeKeys,function(_this){return function(name){return _this[name+"Key"]=void 0}}(this)),this.linked=new Linked(scope,element,attrs,ctrls),this.contentKeys=void 0,this.isIconVisibleOnClick=void 0,this.firstTime=!0,this.firstWatchModels=!0,this.$log.info(self),this.parentScope=void 0,this.go(scope)}return extend(WindowsParentModel,superClass),WindowsParentModel.include(ModelsWatcher),WindowsParentModel.prototype.go=function(scope){return this.watchOurScope(scope),this.doRebuildAll=null!=this.scope.doRebuildAll?this.scope.doRebuildAll:!1,scope.$watch("doRebuildAll",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.doRebuildAll=newValue:void 0}}(this)),this.createChildScopes()},WindowsParentModel.prototype.watchModels=function(scope){var itemToWatch;return itemToWatch=null!=this.markersScope?"pluralsUpdate":"models",scope.$watch(itemToWatch,function(_this){return function(newValue,oldValue){var doScratch;return!_.isEqual(newValue,oldValue)||_this.firstWatchModels?(_this.firstWatchModels=!1,_this.doRebuildAll||_this.doINeedToWipe(scope.models)?_this.rebuildAll(scope,!0,!0):(doScratch=0===_this.plurals.length,null!=_this.existingPieces?_.last(_this.existingPieces._content).then(function(){return _this.createChildScopes(doScratch)}):_this.createChildScopes(doScratch))):void 0}}(this),!0)},WindowsParentModel.prototype.doINeedToWipe=function(newValue){var newValueIsEmpty;return newValueIsEmpty=null!=newValue?0===newValue.length:!0,this.plurals.length>0&&newValueIsEmpty},WindowsParentModel.prototype.rebuildAll=function(scope,doCreate,doDelete){return this.onDestroy(doDelete).then(function(_this){return function(){return doCreate?_this.createChildScopes():void 0}}(this))},WindowsParentModel.prototype.onDestroy=function(scope){return WindowsParentModel.__super__.onDestroy.call(this,this.scope),_async.promiseLock(this,uiGmapPromise.promiseTypes["delete"],void 0,void 0,function(_this){return function(){return _async.each(_this.plurals.values(),function(child){return child.destroy()},_async.chunkSizeFrom(_this.scope.cleanchunk,!1)).then(function(){var ref;return null!=(ref=_this.plurals)?ref.removeAll():void 0})}}(this))},WindowsParentModel.prototype.watchDestroy=function(scope){return scope.$on("$destroy",function(_this){return function(){return _this.firstWatchModels=!0,_this.firstTime=!0,_this.rebuildAll(scope,!1,!0)}}(this))},WindowsParentModel.prototype.watchOurScope=function(scope){return _.each(IWindow.scopeKeys,function(_this){return function(name){var nameKey;return nameKey=name+"Key",_this[nameKey]="function"==typeof scope[name]?scope[name]():scope[name]}}(this))},WindowsParentModel.prototype.createChildScopes=function(isCreatingFromScratch){var modelsNotDefined,ref,ref1;return null==isCreatingFromScratch&&(isCreatingFromScratch=!0),this.isIconVisibleOnClick=!0,angular.isDefined(this.linked.attrs.isiconvisibleonclick)&&(this.isIconVisibleOnClick=this.linked.scope.isIconVisibleOnClick),modelsNotDefined=angular.isUndefined(this.linked.scope.models),!modelsNotDefined||void 0!==this.markersScope&&void 0!==(null!=(ref=this.markersScope)?ref.plurals:void 0)&&void 0!==(null!=(ref1=this.markersScope)?ref1.models:void 0)?null!=this.gMap?null!=this.linked.scope.models?(this.watchIdKey(this.linked.scope),isCreatingFromScratch?this.createAllNew(this.linked.scope,!1):this.pieceMeal(this.linked.scope,!1)):(this.parentScope=this.markersScope,this.watchIdKey(this.parentScope),isCreatingFromScratch?this.createAllNew(this.markersScope,!0,"plurals",!1):this.pieceMeal(this.markersScope,!0,"plurals",!1)):void 0:void this.$log.error("No models to create windows from! Need direct models or models derived from markers!")},WindowsParentModel.prototype.watchIdKey=function(scope){return this.setIdKey(scope),scope.$watch("idKey",function(_this){return function(newValue,oldValue){return newValue!==oldValue&&null==newValue?(_this.idKey=newValue,_this.rebuildAll(scope,!0,!0)):void 0}}(this))},WindowsParentModel.prototype.createAllNew=function(scope,hasGMarker,modelsPropToIterate,isArray){var maybeCanceled;return null==modelsPropToIterate&&(modelsPropToIterate="models"),null==isArray&&(isArray=!1),this.firstTime&&(this.watchModels(scope),this.watchDestroy(scope)),this.setContentKeys(scope.models),this.didQueueInitPromise(this,scope)?void 0:(maybeCanceled=null,_async.promiseLock(this,uiGmapPromise.promiseTypes.create,"createAllNew",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return _async.each(scope.models,function(model){var gMarker,ref;return gMarker=hasGMarker&&null!=(ref=_this.getItem(scope,modelsPropToIterate,model[_this.idKey]))?ref.gObject:void 0,maybeCanceled||(!gMarker&&_this.markersScope&&$log.error("Unable to get gMarker from markersScope!"),_this.createWindow(model,gMarker,_this.gMap)),maybeCanceled},_async.chunkSizeFrom(scope.chunk)).then(function(){return _this.firstTime=!1})}}(this)))},WindowsParentModel.prototype.pieceMeal=function(scope,hasGMarker,modelsPropToIterate,isArray){var maybeCanceled,payload;return null==modelsPropToIterate&&(modelsPropToIterate="models"),null==isArray&&(isArray=!0),scope.$$destroyed?void 0:(maybeCanceled=null,payload=null,null!=scope&&this.modelsLength()&&this.plurals.length?_async.promiseLock(this,uiGmapPromise.promiseTypes.update,"pieceMeal",function(canceledMsg){return maybeCanceled=canceledMsg},function(_this){return function(){return uiGmapPromise.promise(function(){return _this.figureOutState(_this.idKey,scope,_this.plurals,_this.modelKeyComparison)}).then(function(state){return payload=state,_async.each(payload.removals,function(child){return null!=child?(_this.plurals.remove(child.id),null!=child.destroy&&child.destroy(!0),maybeCanceled):void 0},_async.chunkSizeFrom(scope.chunk))}).then(function(){return _async.each(payload.adds,function(modelToAdd){var gMarker,ref;if(gMarker=null!=(ref=_this.getItem(scope,modelsPropToIterate,modelToAdd[_this.idKey]))?ref.gObject:void 0,!gMarker)throw"Gmarker undefined";return _this.createWindow(modelToAdd,gMarker,_this.gMap),maybeCanceled})}).then(function(){return _async.each(payload.updates,function(update){return _this.updateChild(update.child,update.model),maybeCanceled},_async.chunkSizeFrom(scope.chunk))})}}(this)):($log.debug("pieceMeal: rebuildAll"),this.rebuildAll(this.scope,!0,!0)))},WindowsParentModel.prototype.setContentKeys=function(models){return this.modelsLength(models)?this.contentKeys=Object.keys(models[0]):void 0},WindowsParentModel.prototype.createWindow=function(model,gMarker,gMap){var child,childScope,fakeElement,opts,ref,ref1;return childScope=this.linked.scope.$new(!1),this.setChildScope(childScope,model),childScope.$watch("model",function(_this){return function(newValue,oldValue){return newValue!==oldValue?_this.setChildScope(childScope,newValue):void 0}}(this),!0),fakeElement={html:function(_this){return function(){return _this.interpolateContent(_this.linked.element.html(),model)}}(this)},this.DEFAULTS=this.scopeOrModelVal(this.optionsKey,this.scope,model)||{},opts=this.createWindowOptions(gMarker,childScope,fakeElement.html(),this.DEFAULTS),child=new WindowChildModel(model,childScope,opts,this.isIconVisibleOnClick,gMap,null!=(ref=this.markersScope)&&null!=(ref1=ref.plurals.get(model[this.idKey]))?ref1.scope:void 0,fakeElement,!1,!0),null==model[this.idKey]?void this.$log.error("Window model has no id to assign a child to. This is required for performance. Please assign id, or redirect id to a different key."):(this.plurals.put(model[this.idKey],child),child)},WindowsParentModel.prototype.setChildScope=function(childScope,model){return _.each(IWindow.scopeKeys,function(_this){return function(name){var nameKey,newValue;return nameKey=name+"Key",
newValue="self"===_this[nameKey]?model:model[_this[nameKey]],newValue!==childScope[name]?childScope[name]=newValue:void 0}}(this)),childScope.model=model},WindowsParentModel.prototype.interpolateContent=function(content,model){var exp,i,interpModel,key,len,ref;if(void 0!==this.contentKeys&&0!==this.contentKeys.length){for(exp=$interpolate(content),interpModel={},ref=this.contentKeys,i=0,len=ref.length;len>i;i++)key=ref[i],interpModel[key]=model[key];return exp(interpModel)}},WindowsParentModel.prototype.modelKeyComparison=function(model1,model2){var isEqual,scope;if(scope=null!=this.scope.coords?this.scope:this.parentScope,null==scope)throw"No scope or parentScope set!";return(isEqual=GmapUtil.equalCoords(this.evalModelHandle(model1,scope.coords),this.evalModelHandle(model2,scope.coords)))?isEqual=_.every(_.without(this["interface"].scopeKeys,"coords"),function(_this){return function(k){return _this.evalModelHandle(model1,scope[k])===_this.evalModelHandle(model2,scope[k])}}(this)):isEqual},WindowsParentModel}(IWindowParentModel)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapCircle",["uiGmapICircle","uiGmapCircleParentModel",function(ICircle,CircleParentModel){return _.extend(ICircle,{link:function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return new CircleParentModel(scope,element,attrs,map)}}(this))}})}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapControl",["uiGmapIControl","$http","$templateCache","$compile","$controller","uiGmapGoogleMapApi",function(IControl,$http,$templateCache,$compile,$controller,GoogleMapApi){var Control;return Control=function(superClass){function Control(){this.link=bind(this.link,this),Control.__super__.constructor.call(this)}return extend(Control,superClass),Control.prototype.link=function(scope,element,attrs,ctrl){return GoogleMapApi.then(function(_this){return function(maps){var index,position;return angular.isUndefined(scope.template)?void _this.$log.error("mapControl: could not find a valid template property"):(index=angular.isDefined(scope.index&&!isNaN(parseInt(scope.index)))?parseInt(scope.index):void 0,position=angular.isDefined(scope.position)?scope.position.toUpperCase().replace(/-/g,"_"):"TOP_CENTER",maps.ControlPosition[position]?IControl.mapPromise(scope,ctrl).then(function(map){var control,controlDiv;return control=void 0,controlDiv=angular.element("<div></div>"),$http.get(scope.template,{cache:$templateCache}).success(function(template){var templateCtrl,templateScope;return templateScope=scope.$new(),controlDiv.append(template),angular.isDefined(scope.controller)&&(templateCtrl=$controller(scope.controller,{$scope:templateScope}),controlDiv.children().data("$ngControllerController",templateCtrl)),control=$compile(controlDiv.children())(templateScope),index?control[0].index=index:void 0}).error(function(error){return _this.$log.error("mapControl: template could not be found")}).then(function(){return map.controls[google.maps.ControlPosition[position]].push(control[0])})}):void _this.$log.error("mapControl: invalid position property"))}}(this))},Control}(IControl)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapDragZoom",["uiGmapCtrlHandle","uiGmapPropertyAction",function(CtrlHandle,PropertyAction){return{restrict:"EMA",transclude:!0,template:'<div class="angular-google-map-dragzoom" ng-transclude style="display: none"></div>',require:"^uiGmapGoogleMap",scope:{keyboardkey:"=",options:"=",spec:"="},controller:["$scope","$element",function($scope,$element){return $scope.ctrlType="uiGmapDragZoom",_.extend(this,CtrlHandle.handle($scope,$element))}],link:function(scope,element,attrs,ctrl){return CtrlHandle.mapPromise(scope,ctrl).then(function(map){var enableKeyDragZoom,setKeyAction,setOptionsAction;return enableKeyDragZoom=function(opts){return map.enableKeyDragZoom(opts),scope.spec?scope.spec.enableKeyDragZoom(opts):void 0},setKeyAction=new PropertyAction(function(key,newVal){return newVal?enableKeyDragZoom({key:newVal}):enableKeyDragZoom()}),setOptionsAction=new PropertyAction(function(key,newVal){return newVal?enableKeyDragZoom(newVal):void 0}),scope.$watch("keyboardkey",setKeyAction.sic),setKeyAction.sic(scope.keyboardkey),scope.$watch("options",setOptionsAction.sic),setOptionsAction.sic(scope.options)})}}}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapDrawingManager",["uiGmapIDrawingManager","uiGmapDrawingManagerParentModel",function(IDrawingManager,DrawingManagerParentModel){return _.extend(IDrawingManager,{link:function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(map){return new DrawingManagerParentModel(scope,element,attrs,map)})}})}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapApiFreeDrawPolygons",["uiGmapLogger","uiGmapBaseObject","uiGmapCtrlHandle","uiGmapDrawFreeHandChildModel","uiGmapLodash",function($log,BaseObject,CtrlHandle,DrawFreeHandChildModel,uiGmapLodash){var FreeDrawPolygons;return FreeDrawPolygons=function(superClass){function FreeDrawPolygons(){return this.link=bind(this.link,this),FreeDrawPolygons.__super__.constructor.apply(this,arguments)}return extend(FreeDrawPolygons,superClass),FreeDrawPolygons.include(CtrlHandle),FreeDrawPolygons.prototype.restrict="EMA",FreeDrawPolygons.prototype.replace=!0,FreeDrawPolygons.prototype.require="^uiGmapGoogleMap",FreeDrawPolygons.prototype.scope={polygons:"=",draw:"=",revertmapoptions:"="},FreeDrawPolygons.prototype.link=function(scope,element,attrs,ctrl){return this.mapPromise(scope,ctrl).then(function(_this){return function(map){var freeHand,listener;return scope.polygons?_.isArray(scope.polygons)?(freeHand=new DrawFreeHandChildModel(map,scope.revertmapoptions),listener=void 0,scope.draw=function(){return"function"==typeof listener&&listener(),freeHand.engage(scope.polygons).then(function(){var firstTime;return firstTime=!0,listener=scope.$watchCollection("polygons",function(newValue,oldValue){var removals;return firstTime||newValue===oldValue?void(firstTime=!1):(removals=uiGmapLodash.differenceObjects(oldValue,newValue),removals.forEach(function(p){return p.setMap(null)}))})})}):$log.error("Free Draw Polygons must be of type Array!"):$log.error("No polygons to bind to!")}}(this))},FreeDrawPolygons}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapICircle",[function(){var DEFAULTS;return DEFAULTS={},{restrict:"EA",replace:!0,require:"^uiGmapGoogleMap",scope:{center:"=center",radius:"=radius",stroke:"=stroke",fill:"=fill",clickable:"=",draggable:"=",editable:"=",geodesic:"=",icons:"=icons",visible:"=",events:"=",zIndex:"=zindex"}}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIControl",["uiGmapBaseObject","uiGmapLogger","uiGmapCtrlHandle",function(BaseObject,Logger,CtrlHandle){var IControl;return IControl=function(superClass){function IControl(){this.restrict="EA",this.replace=!0,this.require="^uiGmapGoogleMap",this.scope={template:"@template",position:"@position",controller:"@controller",index:"@index"},this.$log=Logger}return extend(IControl,superClass),IControl.extend(CtrlHandle),IControl.prototype.link=function(scope,element,attrs,ctrl){throw new Exception("Not implemented!!")},IControl}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapIDrawingManager",[function(){return{restrict:"EA",replace:!0,require:"^uiGmapGoogleMap",scope:{"static":"@",control:"=",options:"=",events:"="}}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIMarker",["uiGmapBaseObject","uiGmapCtrlHandle",function(BaseObject,CtrlHandle){var IMarker;return IMarker=function(superClass){function IMarker(){this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.replace=!0,this.scope=_.extend(this.scope||{},IMarker.scope)}return extend(IMarker,superClass),IMarker.scope={coords:"=coords",icon:"=icon",click:"&click",options:"=options",events:"=events",fit:"=fit",idKey:"=idkey",control:"=control"},IMarker.scopeKeys=_.keys(IMarker.scope),IMarker.keys=IMarker.scopeKeys,IMarker.extend(CtrlHandle),IMarker}(BaseObject)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIPolygon",["uiGmapGmapUtil","uiGmapBaseObject","uiGmapLogger","uiGmapCtrlHandle",function(GmapUtil,BaseObject,Logger,CtrlHandle){var IPolygon;return IPolygon=function(superClass){function IPolygon(){}return extend(IPolygon,superClass),IPolygon.scope={path:"=path",stroke:"=stroke",clickable:"=",draggable:"=",editable:"=",geodesic:"=",fill:"=",icons:"=icons",visible:"=","static":"=",events:"=",zIndex:"=zindex",fit:"=",control:"=control"},IPolygon.scopeKeys=_.keys(IPolygon.scope),IPolygon.include(GmapUtil),IPolygon.extend(CtrlHandle),IPolygon.prototype.restrict="EMA",IPolygon.prototype.replace=!0,IPolygon.prototype.require="^uiGmapGoogleMap",IPolygon.prototype.scope=IPolygon.scope,IPolygon.prototype.DEFAULTS={},IPolygon.prototype.$log=Logger,IPolygon}(BaseObject)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIPolyline",["uiGmapGmapUtil","uiGmapBaseObject","uiGmapLogger","uiGmapCtrlHandle",function(GmapUtil,BaseObject,Logger,CtrlHandle){var IPolyline;return IPolyline=function(superClass){function IPolyline(){}return extend(IPolyline,superClass),IPolyline.scope={path:"=",stroke:"=",clickable:"=",draggable:"=",editable:"=",geodesic:"=",icons:"=",visible:"=","static":"=",fit:"=",events:"=",zIndex:"=zindex"},IPolyline.scopeKeys=_.keys(IPolyline.scope),IPolyline.include(GmapUtil),IPolyline.extend(CtrlHandle),IPolyline.prototype.restrict="EMA",IPolyline.prototype.replace=!0,IPolyline.prototype.require="^uiGmapGoogleMap",IPolyline.prototype.scope=IPolyline.scope,IPolyline.prototype.DEFAULTS={},IPolyline.prototype.$log=Logger,IPolyline}(BaseObject)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapIRectangle",[function(){var DEFAULTS;return DEFAULTS={},{restrict:"EMA",require:"^uiGmapGoogleMap",replace:!0,scope:{bounds:"=",stroke:"=",clickable:"=",draggable:"=",editable:"=",fill:"=",visible:"=",events:"="}}}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapIWindow",["uiGmapBaseObject","uiGmapChildEvents","uiGmapCtrlHandle",function(BaseObject,ChildEvents,CtrlHandle){var IWindow;return IWindow=function(superClass){function IWindow(){this.restrict="EMA",this.template=void 0,this.transclude=!0,this.priority=-100,this.require="^uiGmapGoogleMap",this.replace=!0,this.scope=_.extend(this.scope||{},IWindow.scope)}return extend(IWindow,superClass),IWindow.scope={coords:"=coords",template:"=template",templateUrl:"=templateurl",templateParameter:"=templateparameter",isIconVisibleOnClick:"=isiconvisibleonclick",closeClick:"&closeclick",options:"=options",control:"=control",show:"=show"},IWindow.scopeKeys=_.keys(IWindow.scope),IWindow.include(ChildEvents),IWindow.extend(CtrlHandle),IWindow}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapMap",["$timeout","$q","uiGmapLogger","uiGmapGmapUtil","uiGmapBaseObject","uiGmapCtrlHandle","uiGmapIsReady","uiGmapuuid","uiGmapExtendGWin","uiGmapExtendMarkerClusterer","uiGmapGoogleMapsUtilV3","uiGmapGoogleMapApi","uiGmapEventsHelper",function($timeout,$q,$log,GmapUtil,BaseObject,CtrlHandle,IsReady,uuid,ExtendGWin,ExtendMarkerClusterer,GoogleMapsUtilV3,GoogleMapApi,EventsHelper){var DEFAULTS,Map,initializeItems;return DEFAULTS=void 0,initializeItems=[GoogleMapsUtilV3,ExtendGWin,ExtendMarkerClusterer],Map=function(superClass){function Map(){this.link=bind(this.link,this);var ctrlFn,self;ctrlFn=function($scope){var ctrlObj,retCtrl;return retCtrl=void 0,$scope.$on("$destroy",function(){return IsReady.decrement()}),ctrlObj=CtrlHandle.handle($scope),$scope.ctrlType="Map",$scope.deferred.promise.then(function(){return initializeItems.forEach(function(i){return i.init()})}),ctrlObj.getMap=function(){return $scope.map},retCtrl=_.extend(this,ctrlObj)},this.controller=["$scope",ctrlFn],self=this}return extend(Map,superClass),Map.include(GmapUtil),Map.prototype.restrict="EMA",Map.prototype.transclude=!0,Map.prototype.replace=!1,Map.prototype.template='<div class="angular-google-map"><div class="angular-google-map-container"></div><div ng-transclude style="display: none"></div></div>',Map.prototype.scope={center:"=",zoom:"=",dragging:"=",control:"=",options:"=",events:"=",eventOpts:"=",styles:"=",bounds:"=",update:"="},Map.prototype.link=function(scope,element,attrs){var listeners,unbindCenterWatch;return listeners=[],scope.$on("$destroy",function(){return EventsHelper.removeEvents(listeners)}),scope.idleAndZoomChanged=!1,null==scope.center?void(unbindCenterWatch=scope.$watch("center",function(_this){return function(){return scope.center?(unbindCenterWatch(),_this.link(scope,element,attrs)):void 0}}(this))):GoogleMapApi.then(function(_this){return function(maps){var _gMap,customListeners,disabledEvents,dragging,el,eventName,getEventHandler,mapOptions,maybeHookToEvent,opts,ref,resolveSpawned,settingFromDirective,spawned,type,updateCenter,zoomPromise;if(DEFAULTS={mapTypeId:maps.MapTypeId.ROADMAP},spawned=IsReady.spawn(),resolveSpawned=function(){return spawned.deferred.resolve({instance:spawned.instance,map:_gMap})},!_this.validateCoords(scope.center))return void $log.error("angular-google-maps: could not find a valid center property");if(!angular.isDefined(scope.zoom))return void $log.error("angular-google-maps: map zoom property not set");if(el=angular.element(element),el.addClass("angular-google-map"),opts={options:{}},attrs.options&&(opts.options=scope.options),attrs.styles&&(opts.styles=scope.styles),attrs.type&&(type=attrs.type.toUpperCase(),google.maps.MapTypeId.hasOwnProperty(type)?opts.mapTypeId=google.maps.MapTypeId[attrs.type.toUpperCase()]:$log.error("angular-google-maps: invalid map type '"+attrs.type+"'")),mapOptions=angular.extend({},DEFAULTS,opts,{center:_this.getCoords(scope.center),zoom:scope.zoom,bounds:scope.bounds}),_gMap=new google.maps.Map(el.find("div")[1],mapOptions),_gMap.uiGmap_id=uuid.generate(),dragging=!1,listeners.push(google.maps.event.addListenerOnce(_gMap,"idle",function(){return scope.deferred.resolve(_gMap),resolveSpawned()})),disabledEvents=attrs.events&&null!=(null!=(ref=scope.events)?ref.blacklist:void 0)?scope.events.blacklist:[],_.isString(disabledEvents)&&(disabledEvents=[disabledEvents]),maybeHookToEvent=function(eventName,fn,prefn){return _.contains(disabledEvents,eventName)?void 0:(prefn&&prefn(),listeners.push(google.maps.event.addListener(_gMap,eventName,function(){var ref1;return(null!=(ref1=scope.update)?ref1.lazy:void 0)?void 0:fn()})))},_.contains(disabledEvents,"all")||(maybeHookToEvent("dragstart",function(){return dragging=!0,scope.$evalAsync(function(s){return null!=s.dragging?s.dragging=dragging:void 0})}),maybeHookToEvent("dragend",function(){return dragging=!1,scope.$evalAsync(function(s){return null!=s.dragging?s.dragging=dragging:void 0})}),updateCenter=function(c,s){if(null==c&&(c=_gMap.center),null==s&&(s=scope),!_.contains(disabledEvents,"center"))if(angular.isDefined(s.center.type)){if(s.center.coordinates[1]!==c.lat()&&(s.center.coordinates[1]=c.lat()),s.center.coordinates[0]!==c.lng())return s.center.coordinates[0]=c.lng()}else if(s.center.latitude!==c.lat()&&(s.center.latitude=c.lat()),s.center.longitude!==c.lng())return s.center.longitude=c.lng()},settingFromDirective=!1,maybeHookToEvent("idle",function(){var b,ne,sw;return b=_gMap.getBounds(),ne=b.getNorthEast(),sw=b.getSouthWest(),settingFromDirective=!0,scope.$evalAsync(function(s){return updateCenter(),null===s.bounds||s.bounds===undefined||void 0===s.bounds||_.contains(disabledEvents,"bounds")||(s.bounds.northeast={latitude:ne.lat(),longitude:ne.lng()},s.bounds.southwest={latitude:sw.lat(),longitude:sw.lng()}),_.contains(disabledEvents,"zoom")||(s.zoom=_gMap.zoom,scope.idleAndZoomChanged=!scope.idleAndZoomChanged),settingFromDirective=!1})})),angular.isDefined(scope.events)&&null!==scope.events&&angular.isObject(scope.events)){getEventHandler=function(eventName){return function(){return scope.events[eventName].apply(scope,[_gMap,eventName,arguments])}},customListeners=[];for(eventName in scope.events)scope.events.hasOwnProperty(eventName)&&angular.isFunction(scope.events[eventName])&&customListeners.push(google.maps.event.addListener(_gMap,eventName,getEventHandler(eventName)));listeners.concat(customListeners)}return _gMap.getOptions=function(){return mapOptions},scope.map=_gMap,null!=attrs.control&&null!=scope.control&&(scope.control.refresh=function(maybeCoords){var coords,ref1,ref2;if(null!=_gMap)return null!=("undefined"!=typeof google&&null!==google&&null!=(ref1=google.maps)&&null!=(ref2=ref1.event)?ref2.trigger:void 0)&&null!=_gMap&&google.maps.event.trigger(_gMap,"resize"),null!=(null!=maybeCoords?maybeCoords.latitude:void 0)&&null!=(null!=maybeCoords?maybeCoords.longitude:void 0)?(coords=_this.getCoords(maybeCoords),_this.isTrue(attrs.pan)?_gMap.panTo(coords):_gMap.setCenter(coords)):void 0},scope.control.getGMap=function(){return _gMap},scope.control.getMapOptions=function(){return mapOptions},scope.control.getCustomEventListeners=function(){return customListeners},scope.control.removeEvents=function(yourListeners){return EventsHelper.removeEvents(yourListeners)}),scope.$watch("center",function(newValue,oldValue){var coords,settingCenterFromScope;if(newValue!==oldValue&&!settingFromDirective&&(coords=_this.getCoords(scope.center),coords.lat()!==_gMap.center.lat()||coords.lng()!==_gMap.center.lng()))return settingCenterFromScope=!0,dragging||(_this.validateCoords(newValue)||$log.error("Invalid center for newValue: "+JSON.stringify(newValue)),_this.isTrue(attrs.pan)&&scope.zoom===_gMap.zoom?_gMap.panTo(coords):_gMap.setCenter(coords)),settingCenterFromScope=!1},!0),zoomPromise=null,scope.$watch("zoom",function(newValue,oldValue){var ref1,ref2,settingZoomFromScope;if(null!=newValue&&!_.isEqual(newValue,oldValue)&&(null!=_gMap?_gMap.getZoom():void 0)!==(null!=scope?scope.zoom:void 0)&&!settingFromDirective)return settingZoomFromScope=!0,null!=zoomPromise&&$timeout.cancel(zoomPromise),zoomPromise=$timeout(function(){return _gMap.setZoom(newValue),settingZoomFromScope=!1},(null!=(ref1=scope.eventOpts)&&null!=(ref2=ref1.debounce)?ref2.zoomMs:void 0)+20,!1)}),scope.$watch("bounds",function(newValue,oldValue){var bounds,ne,ref1,ref2,ref3,ref4,sw;if(newValue!==oldValue)return null==(null!=newValue&&null!=(ref1=newValue.northeast)?ref1.latitude:void 0)||null==(null!=newValue&&null!=(ref2=newValue.northeast)?ref2.longitude:void 0)||null==(null!=newValue&&null!=(ref3=newValue.southwest)?ref3.latitude:void 0)||null==(null!=newValue&&null!=(ref4=newValue.southwest)?ref4.longitude:void 0)?void $log.error("Invalid map bounds for new value: "+JSON.stringify(newValue)):(ne=new google.maps.LatLng(newValue.northeast.latitude,newValue.northeast.longitude),sw=new google.maps.LatLng(newValue.southwest.latitude,newValue.southwest.longitude),bounds=new google.maps.LatLngBounds(sw,ne),_gMap.fitBounds(bounds))}),["options","styles"].forEach(function(toWatch){return scope.$watch(toWatch,function(newValue,oldValue){var watchItem;return watchItem=this.exp,_.isEqual(newValue,oldValue)?void 0:("options"===watchItem?opts.options=newValue:opts.options[watchItem]=newValue,null!=_gMap?_gMap.setOptions(opts):void 0)},!0)})}}(this))},Map}(BaseObject)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapMarker",["uiGmapIMarker","uiGmapMarkerChildModel","uiGmapMarkerManager","uiGmapLogger",function(IMarker,MarkerChildModel,MarkerManager,$log){var Marker;return Marker=function(superClass){function Marker(){this.link=bind(this.link,this),Marker.__super__.constructor.call(this),this.template='<span class="angular-google-map-marker" ng-transclude></span>',$log.info(this)}return extend(Marker,superClass),Marker.prototype.controller=["$scope","$element",function($scope,$element){return $scope.ctrlType="Marker",_.extend(this,IMarker.handle($scope,$element))}],Marker.prototype.link=function(scope,element,attrs,ctrl){var mapPromise;return mapPromise=IMarker.mapPromise(scope,ctrl),mapPromise.then(function(_this){return function(map){var doClick,doDrawSelf,gManager,keys,m,trackModel;return gManager=new MarkerManager(map),keys=_.object(IMarker.keys,IMarker.keys),m=new MarkerChildModel(scope,scope,keys,map,{},doClick=!0,gManager,doDrawSelf=!1,trackModel=!1),m.deferred.promise.then(function(gMarker){return scope.deferred.resolve(gMarker)}),null!=scope.control?scope.control.getGMarkers=gManager.getGMarkers:void 0}}(this)),scope.$on("$destroy",function(_this){return function(){var gManager;return"undefined"!=typeof gManager&&null!==gManager&&gManager.clear(),gManager=null}}(this))},Marker}(IMarker)}])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapMarkers",["uiGmapIMarker","uiGmapPlural","uiGmapMarkersParentModel","uiGmap_sync","uiGmapLogger",function(IMarker,Plural,MarkersParentModel,_sync,$log){var Markers;return Markers=function(superClass){function Markers(){Markers.__super__.constructor.call(this),this.template='<span class="angular-google-map-markers" ng-transclude></span>',Plural.extend(this,{doCluster:"=docluster",clusterOptions:"=clusteroptions",clusterEvents:"=clusterevents",modelsByRef:"=modelsbyref"}),$log.info(this)}return extend(Markers,superClass),Markers.prototype.controller=["$scope","$element",function($scope,$element){return $scope.ctrlType="Markers",_.extend(this,IMarker.handle($scope,$element))}],Markers.prototype.link=function(scope,element,attrs,ctrl){var parentModel,ready;return parentModel=void 0,ready=function(){return scope.deferred.resolve()},IMarker.mapPromise(scope,ctrl).then(function(map){var mapScope;return mapScope=ctrl.getScope(),mapScope.$watch("idleAndZoomChanged",function(){return _.defer(parentModel.gManager.draw)}),parentModel=new MarkersParentModel(scope,element,attrs,map),Plural.link(scope,parentModel),null!=scope.control&&(scope.control.getGMarkers=function(){var ref;return null!=(ref=parentModel.gManager)?ref.getGMarkers():void 0},scope.control.getChildMarkers=function(){return parentModel.plurals}),_.last(parentModel.existingPieces._content).then(function(){return ready()})})},Markers}(IMarker)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").service("uiGmapPlural",[function(){var _initControl;return _initControl=function(scope,parent){return null!=scope.control?(scope.control.updateModels=function(models){return scope.models=models,parent.createChildScopes(!1)},scope.control.newModels=function(models){return scope.models=models,parent.rebuildAll(scope,!0,!0)},scope.control.clean=function(){return parent.rebuildAll(scope,!1,!0)},scope.control.getPlurals=function(){return parent.plurals},scope.control.getManager=function(){return parent.gManager},scope.control.hasManager=function(){return null!=parent.gManager==!0},scope.control.managerDraw=function(){var ref;return scope.control.hasManager()&&null!=(ref=scope.control.getManager())?ref.draw():void 0}):void 0},{extend:function(obj,obj2){return _.extend(obj.scope||{},obj2||{},{idKey:"=idkey",doRebuildAll:"=dorebuildall",models:"=models",chunk:"=chunk",cleanchunk:"=cleanchunk",control:"=control"})},link:function(scope,parent){return _initControl(scope,parent)}}}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolygon",["uiGmapIPolygon","$timeout","uiGmaparray-sync","uiGmapPolygonChildModel",function(IPolygon,$timeout,arraySync,PolygonChild){var Polygon;return Polygon=function(superClass){function Polygon(){return this.link=bind(this.link,this),Polygon.__super__.constructor.apply(this,arguments)}return extend(Polygon,superClass),Polygon.prototype.link=function(scope,element,attrs,mapCtrl){var children,promise;return children=[],promise=IPolygon.mapPromise(scope,mapCtrl),null!=scope.control&&(scope.control.getInstance=this,scope.control.polygons=children,scope.control.promise=promise),promise.then(function(_this){return function(map){return children.push(new PolygonChild(scope,attrs,map,_this.DEFAULTS))}}(this))},Polygon}(IPolygon)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolygons",["uiGmapIPolygon","$timeout","uiGmaparray-sync","uiGmapPolygonsParentModel","uiGmapPlural",function(Interface,$timeout,arraySync,ParentModel,Plural){var Polygons;return Polygons=function(superClass){function Polygons(){this.link=bind(this.link,this),Polygons.__super__.constructor.call(this),Plural.extend(this),this.$log.info(this)}return extend(Polygons,superClass),Polygons.prototype.link=function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return(angular.isUndefined(scope.path)||null===scope.path)&&_this.$log.warn("polygons: no valid path attribute found"),scope.models||_this.$log.warn("polygons: no models found to create from"),Plural.link(scope,new ParentModel(scope,element,attrs,map,_this.DEFAULTS))}}(this))},Polygons}(Interface)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolyline",["uiGmapIPolyline","$timeout","uiGmaparray-sync","uiGmapPolylineChildModel",function(IPolyline,$timeout,arraySync,PolylineChildModel){var Polyline;return Polyline=function(superClass){function Polyline(){return this.link=bind(this.link,this),Polyline.__super__.constructor.apply(this,arguments)}return extend(Polyline,superClass),Polyline.prototype.link=function(scope,element,attrs,mapCtrl){return IPolyline.mapPromise(scope,mapCtrl).then(function(_this){return function(map){return(angular.isUndefined(scope.path)||null===scope.path||!_this.validatePath(scope.path))&&_this.$log.warn("polyline: no valid path attribute found"),new PolylineChildModel(scope,attrs,map,_this.DEFAULTS)}}(this))},Polyline}(IPolyline)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapPolylines",["uiGmapIPolyline","$timeout","uiGmaparray-sync","uiGmapPolylinesParentModel","uiGmapPlural",function(IPolyline,$timeout,arraySync,PolylinesParentModel,Plural){var Polylines;return Polylines=function(superClass){function Polylines(){this.link=bind(this.link,this),Polylines.__super__.constructor.call(this),Plural.extend(this),this.$log.info(this)}return extend(Polylines,superClass),Polylines.prototype.link=function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return(angular.isUndefined(scope.path)||null===scope.path)&&_this.$log.warn("polylines: no valid path attribute found"),scope.models||_this.$log.warn("polylines: no models found to create from"),Plural.link(scope,new PolylinesParentModel(scope,element,attrs,map,_this.DEFAULTS))}}(this))},Polylines}(IPolyline)}])}.call(this),function(){angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapRectangle",["uiGmapLogger","uiGmapGmapUtil","uiGmapIRectangle","uiGmapRectangleParentModel",function($log,GmapUtil,IRectangle,RectangleParentModel){return _.extend(IRectangle,{link:function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){
return function(map){return new RectangleParentModel(scope,element,attrs,map)}}(this))}})}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapWindow",["uiGmapIWindow","uiGmapGmapUtil","uiGmapWindowChildModel","uiGmapLodash","uiGmapLogger",function(IWindow,GmapUtil,WindowChildModel,uiGmapLodash,$log){var Window;return Window=function(superClass){function Window(){this.link=bind(this.link,this),Window.__super__.constructor.call(this),this.require=["^uiGmapGoogleMap","^?uiGmapMarker"],this.template='<span class="angular-google-maps-window" ng-transclude></span>',$log.debug(this),this.childWindows=[]}return extend(Window,superClass),Window.include(GmapUtil),Window.prototype.link=function(scope,element,attrs,ctrls){var markerCtrl,markerScope;return markerCtrl=ctrls.length>1&&null!=ctrls[1]?ctrls[1]:void 0,markerScope=null!=markerCtrl?markerCtrl.getScope():void 0,this.mapPromise=IWindow.mapPromise(scope,ctrls[0]),this.mapPromise.then(function(_this){return function(mapCtrl){var isIconVisibleOnClick;return isIconVisibleOnClick=!0,angular.isDefined(attrs.isiconvisibleonclick)&&(isIconVisibleOnClick=scope.isIconVisibleOnClick),markerCtrl?markerScope.deferred.promise.then(function(gMarker){return _this.init(scope,element,isIconVisibleOnClick,mapCtrl,markerScope)}):void _this.init(scope,element,isIconVisibleOnClick,mapCtrl)}}(this))},Window.prototype.init=function(scope,element,isIconVisibleOnClick,mapCtrl,markerScope){var childWindow,defaults,gMarker,hasScopeCoords,opts;return defaults=null!=scope.options?scope.options:{},hasScopeCoords=null!=scope&&this.validateCoords(scope.coords),null!=(null!=markerScope?markerScope.getGMarker:void 0)&&(gMarker=markerScope.getGMarker()),opts=hasScopeCoords?this.createWindowOptions(gMarker,scope,element.html(),defaults):defaults,null!=mapCtrl&&(childWindow=new WindowChildModel({},scope,opts,isIconVisibleOnClick,mapCtrl,markerScope,element),this.childWindows.push(childWindow),scope.$on("$destroy",function(_this){return function(){return _this.childWindows=uiGmapLodash.withoutObjects(_this.childWindows,[childWindow],function(child1,child2){return child1.scope.$id===child2.scope.$id}),_this.childWindows.length=0}}(this))),null!=scope.control&&(scope.control.getGWindows=function(_this){return function(){return _this.childWindows.map(function(child){return child.gObject})}}(this),scope.control.getChildWindows=function(_this){return function(){return _this.childWindows}}(this),scope.control.getPlurals=scope.control.getChildWindows,scope.control.showWindow=function(_this){return function(){return _this.childWindows.map(function(child){return child.showWindow()})}}(this),scope.control.hideWindow=function(_this){return function(){return _this.childWindows.map(function(child){return child.hideWindow()})}}(this)),null!=this.onChildCreation&&null!=childWindow?this.onChildCreation(childWindow):void 0},Window}(IWindow)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("uiGmapgoogle-maps.directives.api").factory("uiGmapWindows",["uiGmapIWindow","uiGmapPlural","uiGmapWindowsParentModel","uiGmapPromise","uiGmapLogger",function(IWindow,Plural,WindowsParentModel,uiGmapPromise,$log){var Windows;return Windows=function(superClass){function Windows(){this.init=bind(this.init,this),this.link=bind(this.link,this),Windows.__super__.constructor.call(this),this.require=["^uiGmapGoogleMap","^?uiGmapMarkers"],this.template='<span class="angular-google-maps-windows" ng-transclude></span>',Plural.extend(this),$log.debug(this)}return extend(Windows,superClass),Windows.prototype.link=function(scope,element,attrs,ctrls){var mapScope,markerCtrl,markerScope;return mapScope=ctrls[0].getScope(),markerCtrl=ctrls.length>1&&null!=ctrls[1]?ctrls[1]:void 0,markerScope=null!=markerCtrl?markerCtrl.getScope():void 0,mapScope.deferred.promise.then(function(_this){return function(map){var promise,ref;return promise=(null!=markerScope&&null!=(ref=markerScope.deferred)?ref.promise:void 0)||uiGmapPromise.resolve(),promise.then(function(){var pieces,ref1;return pieces=null!=(ref1=_this.parentModel)?ref1.existingPieces:void 0,pieces?pieces.then(function(){return _this.init(scope,element,attrs,ctrls,map,markerScope)}):_this.init(scope,element,attrs,ctrls,map,markerScope)})}}(this))},Windows.prototype.init=function(scope,element,attrs,ctrls,map,additionalScope){var parentModel;return parentModel=new WindowsParentModel(scope,element,attrs,ctrls,map,additionalScope),Plural.link(scope,parentModel),null!=scope.control?(scope.control.getGWindows=function(_this){return function(){return parentModel.plurals.map(function(child){return child.gObject})}}(this),scope.control.getChildWindows=function(_this){return function(){return parentModel.plurals}}(this)):void 0},Windows}(IWindow)}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapGoogleMap",["uiGmapMap",function(Map){return new Map}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapMarker",["$timeout","uiGmapMarker",function($timeout,Marker){return new Marker($timeout)}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapMarkers",["$timeout","uiGmapMarkers",function($timeout,Markers){return new Markers($timeout)}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapPolygon",["uiGmapPolygon",function(Polygon){return new Polygon}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapCircle",["uiGmapCircle",function(Circle){return Circle}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapPolyline",["uiGmapPolyline",function(Polyline){return new Polyline}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapPolylines",["uiGmapPolylines",function(Polylines){return new Polylines}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapRectangle",["uiGmapLogger","uiGmapRectangle",function($log,Rectangle){return Rectangle}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapWindow",["$timeout","$compile","$http","$templateCache","uiGmapWindow",function($timeout,$compile,$http,$templateCache,Window){return new Window($timeout,$compile,$http,$templateCache)}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapWindows",["$timeout","$compile","$http","$templateCache","$interpolate","uiGmapWindows",function($timeout,$compile,$http,$templateCache,$interpolate,Windows){return new Windows($timeout,$compile,$http,$templateCache,$interpolate)}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps").directive("uiGmapLayer",["$timeout","uiGmapLogger","uiGmapLayerParentModel",function($timeout,Logger,LayerParentModel){var Layer;return new(Layer=function(){function Layer(){this.link=bind(this.link,this),this.$log=Logger,this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.template="<span class='angular-google-map-layer' ng-transclude></span>",this.replace=!0,this.scope={show:"=show",type:"=type",namespace:"=namespace",options:"=options",onCreated:"&oncreated"}}return Layer.prototype.link=function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return null!=scope.onCreated?new LayerParentModel(scope,element,attrs,map,scope.onCreated):new LayerParentModel(scope,element,attrs,map)}}(this))},Layer}())}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapMapControl",["uiGmapControl",function(Control){return new Control}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapDragZoom",["uiGmapDragZoom",function(DragZoom){return DragZoom}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapDrawingManager",["uiGmapDrawingManager",function(DrawingManager){return DrawingManager}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapFreeDrawPolygons",["uiGmapApiFreeDrawPolygons",function(FreeDrawPolygons){return new FreeDrawPolygons}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps").directive("uiGmapMapType",["$timeout","uiGmapLogger","uiGmapMapTypeParentModel",function($timeout,Logger,MapTypeParentModel){var MapType;return new(MapType=function(){function MapType(){this.link=bind(this.link,this),this.$log=Logger,this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.template='<span class="angular-google-map-layer" ng-transclude></span>',this.replace=!0,this.scope={show:"=show",options:"=options",refresh:"=refresh",id:"@"}}return MapType.prototype.link=function(scope,element,attrs,mapCtrl){return mapCtrl.getScope().deferred.promise.then(function(_this){return function(map){return new MapTypeParentModel(scope,element,attrs,map)}}(this))},MapType}())}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapPolygons",["uiGmapPolygons",function(Polygons){return new Polygons}])}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};angular.module("uiGmapgoogle-maps").directive("uiGmapSearchBox",["uiGmapGoogleMapApi","uiGmapLogger","uiGmapSearchBoxParentModel","$http","$templateCache","$compile",function(GoogleMapApi,Logger,SearchBoxParentModel,$http,$templateCache,$compile){var SearchBox;return new(SearchBox=function(){function SearchBox(){this.link=bind(this.link,this),this.$log=Logger,this.restrict="EMA",this.require="^uiGmapGoogleMap",this.priority=-1,this.transclude=!0,this.template="<span class='angular-google-map-search' ng-transclude></span>",this.replace=!0,this.scope={template:"=template",events:"=events",position:"=?position",options:"=?options",parentdiv:"=?parentdiv",ngModel:"=?"}}return SearchBox.prototype.require="ngModel",SearchBox.prototype.link=function(scope,element,attrs,mapCtrl){return GoogleMapApi.then(function(_this){return function(maps){return $http.get(scope.template,{cache:$templateCache}).success(function(template){return angular.isUndefined(scope.events)?void _this.$log.error("searchBox: the events property is required"):mapCtrl.getScope().deferred.promise.then(function(map){var ctrlPosition;return ctrlPosition=angular.isDefined(scope.position)?scope.position.toUpperCase().replace(/-/g,"_"):"TOP_LEFT",maps.ControlPosition[ctrlPosition]?new SearchBoxParentModel(scope,element,attrs,map,ctrlPosition,$compile(template)(scope)):void _this.$log.error("searchBox: invalid position property")})})}}(this))},SearchBox}())}])}.call(this),function(){angular.module("uiGmapgoogle-maps").directive("uiGmapShow",["$animate","uiGmapLogger",function($animate,$log){return{scope:{uiGmapShow:"=",uiGmapAfterShow:"&",uiGmapAfterHide:"&"},link:function(scope,element){var angular_post_1_3_handle,angular_pre_1_3_handle,handle;return angular_post_1_3_handle=function(animateAction,cb){return $animate[animateAction](element,"ng-hide").then(function(){return cb()})},angular_pre_1_3_handle=function(animateAction,cb){return $animate[animateAction](element,"ng-hide",cb)},handle=function(animateAction,cb){return angular.version.major>1?$log.error("uiGmapShow is not supported for Angular Major greater than 1.\nYour Major is "+angular.version.major+'"'):1===angular.version.major&&angular.version.minor<3?angular_pre_1_3_handle(animateAction,cb):angular_post_1_3_handle(animateAction,cb)},scope.$watch("uiGmapShow",function(show){return show&&handle("removeClass",scope.uiGmapAfterShow),show?void 0:handle("addClass",scope.uiGmapAfterHide)})}}}])}.call(this),angular.module("uiGmapgoogle-maps.wrapped").service("uiGmapuuid",function(){function UUID(){}return UUID.generate=function(){var a=UUID._gri,b=UUID._ha;return b(a(32),8)+"-"+b(a(16),4)+"-"+b(16384|a(12),4)+"-"+b(32768|a(14),4)+"-"+b(a(48),12)},UUID._gri=function(a){return 0>a?NaN:30>=a?0|Math.random()*(1<<a):53>=a?(0|1073741824*Math.random())+1073741824*(0|Math.random()*(1<<a-30)):NaN},UUID._ha=function(a,b){for(var c=a.toString(16),d=b-c.length,e="0";d>0;d>>>=1,e+=e)1&d&&(c=e+c);return c},UUID}),angular.module("uiGmapgoogle-maps.wrapped").service("uiGmapGoogleMapsUtilV3",function(){return{init:_.once(function(){function InfoBox(opt_opts){opt_opts=opt_opts||{},google.maps.OverlayView.apply(this,arguments),this.content_=opt_opts.content||"",this.disableAutoPan_=opt_opts.disableAutoPan||!1,this.maxWidth_=opt_opts.maxWidth||0,this.pixelOffset_=opt_opts.pixelOffset||new google.maps.Size(0,0),this.position_=opt_opts.position||new google.maps.LatLng(0,0),this.zIndex_=opt_opts.zIndex||null,this.boxClass_=opt_opts.boxClass||"infoBox",this.boxStyle_=opt_opts.boxStyle||{},this.closeBoxMargin_=opt_opts.closeBoxMargin||"2px",this.closeBoxURL_=opt_opts.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",""===opt_opts.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=opt_opts.infoBoxClearance||new google.maps.Size(1,1),"undefined"==typeof opt_opts.visible&&("undefined"==typeof opt_opts.isHidden?opt_opts.visible=!0:opt_opts.visible=!opt_opts.isHidden),this.isHidden_=!opt_opts.visible,this.alignBottom_=opt_opts.alignBottom||!1,this.pane_=opt_opts.pane||"floatPane",this.enableEventPropagation_=opt_opts.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.moveListener_=null,this.contextListener_=null,this.eventListeners_=null,this.fixedWidthSet_=null}function ClusterIcon(cluster,styles){cluster.getMarkerClusterer().extend(ClusterIcon,google.maps.OverlayView),this.cluster_=cluster,this.className_=cluster.getMarkerClusterer().getClusterClass(),this.styles_=styles,this.center_=null,this.div_=null,this.sums_=null,this.visible_=!1,this.setMap(cluster.getMap())}function Cluster(mc){this.markerClusterer_=mc,this.map_=mc.getMap(),this.gridSize_=mc.getGridSize(),this.minClusterSize_=mc.getMinimumClusterSize(),this.averageCenter_=mc.getAverageCenter(),this.markers_=[],this.center_=null,this.bounds_=null,this.clusterIcon_=new ClusterIcon(this,mc.getStyles())}function MarkerClusterer(map,opt_markers,opt_options){this.extend(MarkerClusterer,google.maps.OverlayView),opt_markers=opt_markers||[],opt_options=opt_options||{},this.markers_=[],this.clusters_=[],this.listeners_=[],this.activeMap_=null,this.ready_=!1,this.gridSize_=opt_options.gridSize||60,this.minClusterSize_=opt_options.minimumClusterSize||2,this.maxZoom_=opt_options.maxZoom||null,this.styles_=opt_options.styles||[],this.title_=opt_options.title||"",this.zoomOnClick_=!0,opt_options.zoomOnClick!==undefined&&(this.zoomOnClick_=opt_options.zoomOnClick),this.averageCenter_=!1,opt_options.averageCenter!==undefined&&(this.averageCenter_=opt_options.averageCenter),this.ignoreHidden_=!1,opt_options.ignoreHidden!==undefined&&(this.ignoreHidden_=opt_options.ignoreHidden),this.enableRetinaIcons_=!1,opt_options.enableRetinaIcons!==undefined&&(this.enableRetinaIcons_=opt_options.enableRetinaIcons),this.imagePath_=opt_options.imagePath||MarkerClusterer.IMAGE_PATH,this.imageExtension_=opt_options.imageExtension||MarkerClusterer.IMAGE_EXTENSION,this.imageSizes_=opt_options.imageSizes||MarkerClusterer.IMAGE_SIZES,this.calculator_=opt_options.calculator||MarkerClusterer.CALCULATOR,this.batchSize_=opt_options.batchSize||MarkerClusterer.BATCH_SIZE,this.batchSizeIE_=opt_options.batchSizeIE||MarkerClusterer.BATCH_SIZE_IE,this.clusterClass_=opt_options.clusterClass||"cluster",-1!==navigator.userAgent.toLowerCase().indexOf("msie")&&(this.batchSize_=this.batchSizeIE_),this.setupStyles_(),this.addMarkers(opt_markers,!0),this.setMap(map)}function inherits(childCtor,parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype,childCtor.superClass_=parentCtor.prototype,childCtor.prototype=new tempCtor,childCtor.prototype.constructor=childCtor}function MarkerLabel_(marker,crossURL,handCursorURL){this.marker_=marker,this.handCursorURL_=marker.handCursorURL,this.labelDiv_=document.createElement("div"),this.labelDiv_.style.cssText="position: absolute; overflow: hidden;",this.eventDiv_=document.createElement("div"),this.eventDiv_.style.cssText=this.labelDiv_.style.cssText,this.eventDiv_.setAttribute("onselectstart","return false;"),this.eventDiv_.setAttribute("ondragstart","return false;"),this.crossDiv_=MarkerLabel_.getSharedCross(crossURL)}function MarkerWithLabel(opt_options){opt_options=opt_options||{},opt_options.labelContent=opt_options.labelContent||"",opt_options.labelAnchor=opt_options.labelAnchor||new google.maps.Point(0,0),opt_options.labelClass=opt_options.labelClass||"markerLabels",opt_options.labelStyle=opt_options.labelStyle||{},opt_options.labelInBackground=opt_options.labelInBackground||!1,"undefined"==typeof opt_options.labelVisible&&(opt_options.labelVisible=!0),"undefined"==typeof opt_options.raiseOnDrag&&(opt_options.raiseOnDrag=!0),"undefined"==typeof opt_options.clickable&&(opt_options.clickable=!0),"undefined"==typeof opt_options.draggable&&(opt_options.draggable=!1),"undefined"==typeof opt_options.optimized&&(opt_options.optimized=!1),opt_options.crossImage=opt_options.crossImage||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/drag_cross_67_16.png",opt_options.handCursor=opt_options.handCursor||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/closedhand_8_8.cur",opt_options.optimized=!1,this.label=new MarkerLabel_(this,opt_options.crossImage,opt_options.handCursor),google.maps.Marker.apply(this,arguments)}function RichMarker(opt_options){var options=opt_options||{};this.ready_=!1,this.dragging_=!1,opt_options.visible==undefined&&(opt_options.visible=!0),opt_options.shadow==undefined&&(opt_options.shadow="7px -3px 5px rgba(88,88,88,0.7)"),opt_options.anchor==undefined&&(opt_options.anchor=RichMarkerPosition.BOTTOM),this.setValues(options)}InfoBox.prototype=new google.maps.OverlayView,InfoBox.prototype.createInfoBoxDiv_=function(){var i,events,bw,me=this,cancelHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},ignoreHandler=function(e){e.returnValue=!1,e.preventDefault&&e.preventDefault(),me.enableEventPropagation_||cancelHandler(e)};if(!this.div_){if(this.div_=document.createElement("div"),this.setBoxStyle_(),"undefined"==typeof this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(bw=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-bw.left-bw.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),!this.enableEventPropagation_){for(this.eventListeners_=[],events=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],i=0;i<events.length;i++)this.eventListeners_.push(google.maps.event.addDomListener(this.div_,events[i],cancelHandler));this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(e){this.style.cursor="default"}))}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",ignoreHandler),google.maps.event.trigger(this,"domready")}},InfoBox.prototype.getCloseBoxImg_=function(){var img="";return""!==this.closeBoxURL_&&(img="<img",img+=" src='"+this.closeBoxURL_+"'",img+=" align=right",img+=" style='",img+=" position: relative;",img+=" cursor: pointer;",img+=" margin: "+this.closeBoxMargin_+";",img+="'>"),img},InfoBox.prototype.addClickHandler_=function(){var closeBox;""!==this.closeBoxURL_?(closeBox=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(closeBox,"click",this.getCloseClickHandler_())):this.closeListener_=null},InfoBox.prototype.getCloseClickHandler_=function(){var me=this;return function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(me,"closeclick"),me.close()}},InfoBox.prototype.panBox_=function(disablePan){var map,bounds,xOffset=0,yOffset=0;if(!disablePan&&(map=this.getMap(),map instanceof google.maps.Map)){map.getBounds().contains(this.position_)||map.setCenter(this.position_),bounds=map.getBounds();var mapDiv=map.getDiv(),mapWidth=mapDiv.offsetWidth,mapHeight=mapDiv.offsetHeight,iwOffsetX=this.pixelOffset_.width,iwOffsetY=this.pixelOffset_.height,iwWidth=this.div_.offsetWidth,iwHeight=this.div_.offsetHeight,padX=this.infoBoxClearance_.width,padY=this.infoBoxClearance_.height,pixPosition=this.getProjection().fromLatLngToContainerPixel(this.position_);if(pixPosition.x<-iwOffsetX+padX?xOffset=pixPosition.x+iwOffsetX-padX:pixPosition.x+iwWidth+iwOffsetX+padX>mapWidth&&(xOffset=pixPosition.x+iwWidth+iwOffsetX+padX-mapWidth),this.alignBottom_?pixPosition.y<-iwOffsetY+padY+iwHeight?yOffset=pixPosition.y+iwOffsetY-padY-iwHeight:pixPosition.y+iwOffsetY+padY>mapHeight&&(yOffset=pixPosition.y+iwOffsetY+padY-mapHeight):pixPosition.y<-iwOffsetY+padY?yOffset=pixPosition.y+iwOffsetY-padY:pixPosition.y+iwHeight+iwOffsetY+padY>mapHeight&&(yOffset=pixPosition.y+iwHeight+iwOffsetY+padY-mapHeight),0!==xOffset||0!==yOffset){map.getCenter();map.panBy(xOffset,yOffset)}}},InfoBox.prototype.setBoxStyle_=function(){var i,boxStyle;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",boxStyle=this.boxStyle_;for(i in boxStyle)boxStyle.hasOwnProperty(i)&&(this.div_.style[i]=boxStyle[i]);this.div_.style.WebkitTransform="translateZ(0)","undefined"!=typeof this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+100*this.div_.style.opacity+')"',this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},InfoBox.prototype.getBoxWidths_=function(){var computedStyle,bw={top:0,bottom:0,left:0,right:0},box=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(computedStyle=box.ownerDocument.defaultView.getComputedStyle(box,""),computedStyle&&(bw.top=parseInt(computedStyle.borderTopWidth,10)||0,bw.bottom=parseInt(computedStyle.borderBottomWidth,10)||0,bw.left=parseInt(computedStyle.borderLeftWidth,10)||0,bw.right=parseInt(computedStyle.borderRightWidth,10)||0)):document.documentElement.currentStyle&&box.currentStyle&&(bw.top=parseInt(box.currentStyle.borderTopWidth,10)||0,bw.bottom=parseInt(box.currentStyle.borderBottomWidth,10)||0,bw.left=parseInt(box.currentStyle.borderLeftWidth,10)||0,bw.right=parseInt(box.currentStyle.borderRightWidth,10)||0),bw},InfoBox.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var pixPosition=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=pixPosition.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(pixPosition.y+this.pixelOffset_.height)+"px":this.div_.style.top=pixPosition.y+this.pixelOffset_.height+"px",this.isHidden_?this.div_.style.visibility="hidden":this.div_.style.visibility="visible"},InfoBox.prototype.setOptions=function(opt_opts){"undefined"!=typeof opt_opts.boxClass&&(this.boxClass_=opt_opts.boxClass,this.setBoxStyle_()),"undefined"!=typeof opt_opts.boxStyle&&(this.boxStyle_=opt_opts.boxStyle,this.setBoxStyle_()),"undefined"!=typeof opt_opts.content&&this.setContent(opt_opts.content),"undefined"!=typeof opt_opts.disableAutoPan&&(this.disableAutoPan_=opt_opts.disableAutoPan),"undefined"!=typeof opt_opts.maxWidth&&(this.maxWidth_=opt_opts.maxWidth),"undefined"!=typeof opt_opts.pixelOffset&&(this.pixelOffset_=opt_opts.pixelOffset),"undefined"!=typeof opt_opts.alignBottom&&(this.alignBottom_=opt_opts.alignBottom),"undefined"!=typeof opt_opts.position&&this.setPosition(opt_opts.position),"undefined"!=typeof opt_opts.zIndex&&this.setZIndex(opt_opts.zIndex),"undefined"!=typeof opt_opts.closeBoxMargin&&(this.closeBoxMargin_=opt_opts.closeBoxMargin),"undefined"!=typeof opt_opts.closeBoxURL&&(this.closeBoxURL_=opt_opts.closeBoxURL),"undefined"!=typeof opt_opts.infoBoxClearance&&(this.infoBoxClearance_=opt_opts.infoBoxClearance),"undefined"!=typeof opt_opts.isHidden&&(this.isHidden_=opt_opts.isHidden),"undefined"!=typeof opt_opts.visible&&(this.isHidden_=!opt_opts.visible),"undefined"!=typeof opt_opts.enableEventPropagation&&(this.enableEventPropagation_=opt_opts.enableEventPropagation),this.div_&&this.draw()},InfoBox.prototype.setContent=function(content){this.content_=content,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),"undefined"==typeof content.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+content:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(content)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px","undefined"==typeof content.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+content:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(content))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},InfoBox.prototype.setPosition=function(latlng){this.position_=latlng,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},InfoBox.prototype.setZIndex=function(index){this.zIndex_=index,this.div_&&(this.div_.style.zIndex=index),google.maps.event.trigger(this,"zindex_changed")},InfoBox.prototype.setVisible=function(isVisible){this.isHidden_=!isVisible,this.div_&&(this.div_.style.visibility=this.isHidden_?"hidden":"visible")},InfoBox.prototype.getContent=function(){return this.content_},InfoBox.prototype.getPosition=function(){return this.position_},InfoBox.prototype.getZIndex=function(){return this.zIndex_},InfoBox.prototype.getVisible=function(){var isVisible;return isVisible="undefined"==typeof this.getMap()||null===this.getMap()?!1:!this.isHidden_},InfoBox.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},InfoBox.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},InfoBox.prototype.open=function(map,anchor){var me=this;anchor&&(this.position_=anchor.getPosition(),this.moveListener_=google.maps.event.addListener(anchor,"position_changed",function(){me.setPosition(this.getPosition())})),this.setMap(map),this.div_&&this.panBox_()},InfoBox.prototype.close=function(){var i;if(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListeners_){for(i=0;i<this.eventListeners_.length;i++)google.maps.event.removeListener(this.eventListeners_[i]);this.eventListeners_=null}this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)},function(){function DragZoom(map,opt_zoomOpts){var me=this,ov=new google.maps.OverlayView;ov.onAdd=function(){me.init_(map,opt_zoomOpts)},ov.draw=function(){},ov.onRemove=function(){},ov.setMap(map),this.prjov_=ov}var toPixels=function(widthValue){var px;switch(widthValue){case"thin":px="2px";break;case"medium":px="4px";break;case"thick":px="6px";break;default:px=widthValue}return px},getBorderWidths=function(h){var computedStyle,bw={};if(document.defaultView&&document.defaultView.getComputedStyle){if(computedStyle=h.ownerDocument.defaultView.getComputedStyle(h,""))return bw.top=parseInt(computedStyle.borderTopWidth,10)||0,bw.bottom=parseInt(computedStyle.borderBottomWidth,10)||0,bw.left=parseInt(computedStyle.borderLeftWidth,10)||0,bw.right=parseInt(computedStyle.borderRightWidth,10)||0,bw}else if(document.documentElement.currentStyle&&h.currentStyle)return bw.top=parseInt(toPixels(h.currentStyle.borderTopWidth),10)||0,bw.bottom=parseInt(toPixels(h.currentStyle.borderBottomWidth),10)||0,bw.left=parseInt(toPixels(h.currentStyle.borderLeftWidth),10)||0,bw.right=parseInt(toPixels(h.currentStyle.borderRightWidth),10)||0,bw;return bw.top=parseInt(h.style["border-top-width"],10)||0,bw.bottom=parseInt(h.style["border-bottom-width"],10)||0,bw.left=parseInt(h.style["border-left-width"],10)||0,bw.right=parseInt(h.style["border-right-width"],10)||0,bw},scroll={x:0,y:0},getScrollValue=function(e){scroll.x="undefined"!=typeof document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft,scroll.y="undefined"!=typeof document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop};getScrollValue();var getMousePosition=function(e){var posX=0,posY=0;return e=e||window.event,"undefined"!=typeof e.pageX?(posX=e.pageX,posY=e.pageY):"undefined"!=typeof e.clientX&&(posX=e.clientX+scroll.x,posY=e.clientY+scroll.y),{left:posX,top:posY}},getElementPosition=function(h){for(var posX=h.offsetLeft,posY=h.offsetTop,parent=h.offsetParent;null!==parent;){parent!==document.body&&parent!==document.documentElement&&(posX-=parent.scrollLeft,posY-=parent.scrollTop);var m=parent,moffx=m.offsetLeft,moffy=m.offsetTop;if(!moffx&&!moffy&&window.getComputedStyle){var matrix=document.defaultView.getComputedStyle(m,null).MozTransform||document.defaultView.getComputedStyle(m,null).WebkitTransform;if(matrix&&"string"==typeof matrix){var parms=matrix.split(",");moffx+=parseInt(parms[4],10)||0,moffy+=parseInt(parms[5],10)||0}}posX+=moffx,posY+=moffy,parent=parent.offsetParent}return{left:posX,top:posY}},setVals=function(obj,vals){if(obj&&vals)for(var x in vals)vals.hasOwnProperty(x)&&(obj[x]=vals[x]);return obj},setOpacity=function(h,op){"undefined"!=typeof op&&(h.style.opacity=op),"undefined"!=typeof h.style.opacity&&""!==h.style.opacity&&(h.style.filter="alpha(opacity="+100*h.style.opacity+")")};DragZoom.prototype.init_=function(map,opt_zoomOpts){var i,me=this;for(this.map_=map,opt_zoomOpts=opt_zoomOpts||{},this.key_=opt_zoomOpts.key||"shift",this.key_=this.key_.toLowerCase(),this.borderWidths_=getBorderWidths(this.map_.getDiv()),this.veilDiv_=[],i=0;4>i;i++)this.veilDiv_[i]=document.createElement("div"),this.veilDiv_[i].onselectstart=function(){return!1},setVals(this.veilDiv_[i].style,{backgroundColor:"gray",opacity:.25,cursor:"crosshair"}),setVals(this.veilDiv_[i].style,opt_zoomOpts.paneStyle),setVals(this.veilDiv_[i].style,opt_zoomOpts.veilStyle),setVals(this.veilDiv_[i].style,{position:"absolute",overflow:"hidden",display:"none"}),"shift"===this.key_&&(this.veilDiv_[i].style.MozUserSelect="none"),setOpacity(this.veilDiv_[i]),"transparent"===this.veilDiv_[i].style.backgroundColor&&(this.veilDiv_[i].style.backgroundColor="white",setOpacity(this.veilDiv_[i],0)),this.map_.getDiv().appendChild(this.veilDiv_[i]);this.noZoom_=opt_zoomOpts.noZoom||!1,this.visualEnabled_=opt_zoomOpts.visualEnabled||!1,this.visualClass_=opt_zoomOpts.visualClass||"",this.visualPosition_=opt_zoomOpts.visualPosition||google.maps.ControlPosition.LEFT_TOP,this.visualPositionOffset_=opt_zoomOpts.visualPositionOffset||new google.maps.Size(35,0),
this.visualPositionIndex_=opt_zoomOpts.visualPositionIndex||null,this.visualSprite_=opt_zoomOpts.visualSprite||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/mapfiles/ftr/controls/dragzoom_btn.png",this.visualSize_=opt_zoomOpts.visualSize||new google.maps.Size(20,20),this.visualTips_=opt_zoomOpts.visualTips||{},this.visualTips_.off=this.visualTips_.off||"Turn on drag zoom mode",this.visualTips_.on=this.visualTips_.on||"Turn off drag zoom mode",this.boxDiv_=document.createElement("div"),setVals(this.boxDiv_.style,{border:"4px solid #736AFF"}),setVals(this.boxDiv_.style,opt_zoomOpts.boxStyle),setVals(this.boxDiv_.style,{position:"absolute",display:"none"}),setOpacity(this.boxDiv_),this.map_.getDiv().appendChild(this.boxDiv_),this.boxBorderWidths_=getBorderWidths(this.boxDiv_),this.listeners_=[google.maps.event.addDomListener(document,"keydown",function(e){me.onKeyDown_(e)}),google.maps.event.addDomListener(document,"keyup",function(e){me.onKeyUp_(e)}),google.maps.event.addDomListener(this.veilDiv_[0],"mousedown",function(e){me.onMouseDown_(e)}),google.maps.event.addDomListener(this.veilDiv_[1],"mousedown",function(e){me.onMouseDown_(e)}),google.maps.event.addDomListener(this.veilDiv_[2],"mousedown",function(e){me.onMouseDown_(e)}),google.maps.event.addDomListener(this.veilDiv_[3],"mousedown",function(e){me.onMouseDown_(e)}),google.maps.event.addDomListener(document,"mousedown",function(e){me.onMouseDownDocument_(e)}),google.maps.event.addDomListener(document,"mousemove",function(e){me.onMouseMove_(e)}),google.maps.event.addDomListener(document,"mouseup",function(e){me.onMouseUp_(e)}),google.maps.event.addDomListener(window,"scroll",getScrollValue)],this.hotKeyDown_=!1,this.mouseDown_=!1,this.dragging_=!1,this.startPt_=null,this.endPt_=null,this.mapWidth_=null,this.mapHeight_=null,this.mousePosn_=null,this.mapPosn_=null,this.visualEnabled_&&(this.buttonDiv_=this.initControl_(this.visualPositionOffset_),null!==this.visualPositionIndex_&&(this.buttonDiv_.index=this.visualPositionIndex_),this.map_.controls[this.visualPosition_].push(this.buttonDiv_),this.controlIndex_=this.map_.controls[this.visualPosition_].length-1)},DragZoom.prototype.initControl_=function(offset){var control,image,me=this;return control=document.createElement("div"),control.className=this.visualClass_,control.style.position="relative",control.style.overflow="hidden",control.style.height=this.visualSize_.height+"px",control.style.width=this.visualSize_.width+"px",control.title=this.visualTips_.off,image=document.createElement("img"),image.src=this.visualSprite_,image.style.position="absolute",image.style.left=-(2*this.visualSize_.width)+"px",image.style.top="0px",control.appendChild(image),control.onclick=function(e){me.hotKeyDown_=!me.hotKeyDown_,me.hotKeyDown_?(me.buttonDiv_.firstChild.style.left=-(0*me.visualSize_.width)+"px",me.buttonDiv_.title=me.visualTips_.on,me.activatedByControl_=!0,google.maps.event.trigger(me,"activate")):(me.buttonDiv_.firstChild.style.left=-(2*me.visualSize_.width)+"px",me.buttonDiv_.title=me.visualTips_.off,google.maps.event.trigger(me,"deactivate")),me.onMouseMove_(e)},control.onmouseover=function(){me.buttonDiv_.firstChild.style.left=-(1*me.visualSize_.width)+"px"},control.onmouseout=function(){me.hotKeyDown_?(me.buttonDiv_.firstChild.style.left=-(0*me.visualSize_.width)+"px",me.buttonDiv_.title=me.visualTips_.on):(me.buttonDiv_.firstChild.style.left=-(2*me.visualSize_.width)+"px",me.buttonDiv_.title=me.visualTips_.off)},control.ondragstart=function(){return!1},setVals(control.style,{cursor:"pointer",marginTop:offset.height+"px",marginLeft:offset.width+"px"}),control},DragZoom.prototype.isHotKeyDown_=function(e){var isHot;if(e=e||window.event,isHot=e.shiftKey&&"shift"===this.key_||e.altKey&&"alt"===this.key_||e.ctrlKey&&"ctrl"===this.key_,!isHot)switch(e.keyCode){case 16:"shift"===this.key_&&(isHot=!0);break;case 17:"ctrl"===this.key_&&(isHot=!0);break;case 18:"alt"===this.key_&&(isHot=!0)}return isHot},DragZoom.prototype.isMouseOnMap_=function(){var mousePosn=this.mousePosn_;if(mousePosn){var mapPosn=this.mapPosn_,mapDiv=this.map_.getDiv();return mousePosn.left>mapPosn.left&&mousePosn.left<mapPosn.left+mapDiv.offsetWidth&&mousePosn.top>mapPosn.top&&mousePosn.top<mapPosn.top+mapDiv.offsetHeight}return!1},DragZoom.prototype.setVeilVisibility_=function(){var i;if(this.map_&&this.hotKeyDown_&&this.isMouseOnMap_()){var mapDiv=this.map_.getDiv();if(this.mapWidth_=mapDiv.offsetWidth-(this.borderWidths_.left+this.borderWidths_.right),this.mapHeight_=mapDiv.offsetHeight-(this.borderWidths_.top+this.borderWidths_.bottom),this.activatedByControl_){var left=parseInt(this.buttonDiv_.style.left,10)+this.visualPositionOffset_.width,top=parseInt(this.buttonDiv_.style.top,10)+this.visualPositionOffset_.height,width=this.visualSize_.width,height=this.visualSize_.height;for(this.veilDiv_[0].style.top="0px",this.veilDiv_[0].style.left="0px",this.veilDiv_[0].style.width=left+"px",this.veilDiv_[0].style.height=this.mapHeight_+"px",this.veilDiv_[1].style.top="0px",this.veilDiv_[1].style.left=left+width+"px",this.veilDiv_[1].style.width=this.mapWidth_-(left+width)+"px",this.veilDiv_[1].style.height=this.mapHeight_+"px",this.veilDiv_[2].style.top="0px",this.veilDiv_[2].style.left=left+"px",this.veilDiv_[2].style.width=width+"px",this.veilDiv_[2].style.height=top+"px",this.veilDiv_[3].style.top=top+height+"px",this.veilDiv_[3].style.left=left+"px",this.veilDiv_[3].style.width=width+"px",this.veilDiv_[3].style.height=this.mapHeight_-(top+height)+"px",i=0;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.display="block"}else{for(this.veilDiv_[0].style.left="0px",this.veilDiv_[0].style.top="0px",this.veilDiv_[0].style.width=this.mapWidth_+"px",this.veilDiv_[0].style.height=this.mapHeight_+"px",i=1;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.width="0px",this.veilDiv_[i].style.height="0px";for(i=0;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.display="block"}}else for(i=0;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.display="none"},DragZoom.prototype.onKeyDown_=function(e){this.map_&&!this.hotKeyDown_&&this.isHotKeyDown_(e)&&(this.mapPosn_=getElementPosition(this.map_.getDiv()),this.hotKeyDown_=!0,this.activatedByControl_=!1,this.setVeilVisibility_(),google.maps.event.trigger(this,"activate"))},DragZoom.prototype.getMousePoint_=function(e){var mousePosn=getMousePosition(e),p=new google.maps.Point;return p.x=mousePosn.left-this.mapPosn_.left-this.borderWidths_.left,p.y=mousePosn.top-this.mapPosn_.top-this.borderWidths_.top,p.x=Math.min(p.x,this.mapWidth_),p.y=Math.min(p.y,this.mapHeight_),p.x=Math.max(p.x,0),p.y=Math.max(p.y,0),p},DragZoom.prototype.onMouseDown_=function(e){if(this.map_&&this.hotKeyDown_){this.mapPosn_=getElementPosition(this.map_.getDiv()),this.dragging_=!0,this.startPt_=this.endPt_=this.getMousePoint_(e),this.boxDiv_.style.width=this.boxDiv_.style.height="0px";var prj=this.prjov_.getProjection(),latlng=prj.fromContainerPixelToLatLng(this.startPt_);google.maps.event.trigger(this,"dragstart",latlng)}},DragZoom.prototype.onMouseDownDocument_=function(e){this.mouseDown_=!0},DragZoom.prototype.onMouseMove_=function(e){if(this.mousePosn_=getMousePosition(e),this.dragging_){this.endPt_=this.getMousePoint_(e);var left=Math.min(this.startPt_.x,this.endPt_.x),top=Math.min(this.startPt_.y,this.endPt_.y),width=Math.abs(this.startPt_.x-this.endPt_.x),height=Math.abs(this.startPt_.y-this.endPt_.y),boxWidth=Math.max(0,width-(this.boxBorderWidths_.left+this.boxBorderWidths_.right)),boxHeight=Math.max(0,height-(this.boxBorderWidths_.top+this.boxBorderWidths_.bottom));this.veilDiv_[0].style.top="0px",this.veilDiv_[0].style.left="0px",this.veilDiv_[0].style.width=left+"px",this.veilDiv_[0].style.height=this.mapHeight_+"px",this.veilDiv_[1].style.top="0px",this.veilDiv_[1].style.left=left+width+"px",this.veilDiv_[1].style.width=this.mapWidth_-(left+width)+"px",this.veilDiv_[1].style.height=this.mapHeight_+"px",this.veilDiv_[2].style.top="0px",this.veilDiv_[2].style.left=left+"px",this.veilDiv_[2].style.width=width+"px",this.veilDiv_[2].style.height=top+"px",this.veilDiv_[3].style.top=top+height+"px",this.veilDiv_[3].style.left=left+"px",this.veilDiv_[3].style.width=width+"px",this.veilDiv_[3].style.height=this.mapHeight_-(top+height)+"px",this.boxDiv_.style.top=top+"px",this.boxDiv_.style.left=left+"px",this.boxDiv_.style.width=boxWidth+"px",this.boxDiv_.style.height=boxHeight+"px",this.boxDiv_.style.display="block",google.maps.event.trigger(this,"drag",new google.maps.Point(left,top+height),new google.maps.Point(left+width,top),this.prjov_.getProjection())}else this.mouseDown_||(this.mapPosn_=getElementPosition(this.map_.getDiv()),this.setVeilVisibility_())},DragZoom.prototype.onMouseUp_=function(e){var z,me=this;if(this.mouseDown_=!1,this.dragging_){if(this.getMousePoint_(e).x===this.startPt_.x&&this.getMousePoint_(e).y===this.startPt_.y)return void this.onKeyUp_(e);var left=Math.min(this.startPt_.x,this.endPt_.x),top=Math.min(this.startPt_.y,this.endPt_.y),width=Math.abs(this.startPt_.x-this.endPt_.x),height=Math.abs(this.startPt_.y-this.endPt_.y),kGoogleCenteringBug=!0;kGoogleCenteringBug&&(left+=this.borderWidths_.left,top+=this.borderWidths_.top);var prj=this.prjov_.getProjection(),sw=prj.fromContainerPixelToLatLng(new google.maps.Point(left,top+height)),ne=prj.fromContainerPixelToLatLng(new google.maps.Point(left+width,top)),bnds=new google.maps.LatLngBounds(sw,ne);if(this.noZoom_)this.boxDiv_.style.display="none";else{z=this.map_.getZoom(),this.map_.fitBounds(bnds),this.map_.getZoom()<z&&this.map_.setZoom(z);var swPt=prj.fromLatLngToContainerPixel(sw),nePt=prj.fromLatLngToContainerPixel(ne);kGoogleCenteringBug&&(swPt.x-=this.borderWidths_.left,swPt.y-=this.borderWidths_.top,nePt.x-=this.borderWidths_.left,nePt.y-=this.borderWidths_.top),this.boxDiv_.style.left=swPt.x+"px",this.boxDiv_.style.top=nePt.y+"px",this.boxDiv_.style.width=Math.abs(nePt.x-swPt.x)-(this.boxBorderWidths_.left+this.boxBorderWidths_.right)+"px",this.boxDiv_.style.height=Math.abs(nePt.y-swPt.y)-(this.boxBorderWidths_.top+this.boxBorderWidths_.bottom)+"px",setTimeout(function(){me.boxDiv_.style.display="none"},1e3)}this.dragging_=!1,this.onMouseMove_(e),google.maps.event.trigger(this,"dragend",bnds),this.isHotKeyDown_(e)||this.onKeyUp_(e)}},DragZoom.prototype.onKeyUp_=function(e){var i,left,top,width,height,prj,sw,ne,bnds=null;if(this.map_&&this.hotKeyDown_){for(this.hotKeyDown_=!1,this.dragging_&&(this.boxDiv_.style.display="none",this.dragging_=!1,left=Math.min(this.startPt_.x,this.endPt_.x),top=Math.min(this.startPt_.y,this.endPt_.y),width=Math.abs(this.startPt_.x-this.endPt_.x),height=Math.abs(this.startPt_.y-this.endPt_.y),prj=this.prjov_.getProjection(),sw=prj.fromContainerPixelToLatLng(new google.maps.Point(left,top+height)),ne=prj.fromContainerPixelToLatLng(new google.maps.Point(left+width,top)),bnds=new google.maps.LatLngBounds(sw,ne)),i=0;i<this.veilDiv_.length;i++)this.veilDiv_[i].style.display="none";this.visualEnabled_&&(this.buttonDiv_.firstChild.style.left=-(2*this.visualSize_.width)+"px",this.buttonDiv_.title=this.visualTips_.off,this.buttonDiv_.style.display=""),google.maps.event.trigger(this,"deactivate",bnds)}},google.maps.Map.prototype.enableKeyDragZoom=function(opt_zoomOpts){this.dragZoom_=new DragZoom(this,opt_zoomOpts)},google.maps.Map.prototype.disableKeyDragZoom=function(){var i,d=this.dragZoom_;if(d){for(i=0;i<d.listeners_.length;++i)google.maps.event.removeListener(d.listeners_[i]);for(this.getDiv().removeChild(d.boxDiv_),i=0;i<d.veilDiv_.length;i++)this.getDiv().removeChild(d.veilDiv_[i]);d.visualEnabled_&&this.controls[d.visualPosition_].removeAt(d.controlIndex_),d.prjov_.setMap(null),this.dragZoom_=null}},google.maps.Map.prototype.keyDragZoomEnabled=function(){return null!==this.dragZoom_},google.maps.Map.prototype.getDragZoomObject=function(){return this.dragZoom_}}(),ClusterIcon.prototype.onAdd=function(){var cMouseDownInCluster,cDraggingMapByCluster,cClusterIcon=this;this.div_=document.createElement("div"),this.div_.className=this.className_,this.visible_&&this.show(),this.getPanes().overlayMouseTarget.appendChild(this.div_),this.boundsChangedListener_=google.maps.event.addListener(this.getMap(),"bounds_changed",function(){cDraggingMapByCluster=cMouseDownInCluster}),google.maps.event.addDomListener(this.div_,"mousedown",function(){cMouseDownInCluster=!0,cDraggingMapByCluster=!1}),google.maps.event.addDomListener(this.div_,"click",function(e){if(cMouseDownInCluster=!1,!cDraggingMapByCluster){var theBounds,mz,mc=cClusterIcon.cluster_.getMarkerClusterer();google.maps.event.trigger(mc,"click",cClusterIcon.cluster_),google.maps.event.trigger(mc,"clusterclick",cClusterIcon.cluster_),mc.getZoomOnClick()&&(mz=mc.getMaxZoom(),theBounds=cClusterIcon.cluster_.getBounds(),mc.getMap().fitBounds(theBounds),setTimeout(function(){mc.getMap().fitBounds(theBounds),null!==mz&&mc.getMap().getZoom()>mz&&mc.getMap().setZoom(mz+1)},100)),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}}),google.maps.event.addDomListener(this.div_,"mouseover",function(){var mc=cClusterIcon.cluster_.getMarkerClusterer();google.maps.event.trigger(mc,"mouseover",cClusterIcon.cluster_)}),google.maps.event.addDomListener(this.div_,"mouseout",function(){var mc=cClusterIcon.cluster_.getMarkerClusterer();google.maps.event.trigger(mc,"mouseout",cClusterIcon.cluster_)})},ClusterIcon.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),google.maps.event.removeListener(this.boundsChangedListener_),google.maps.event.clearInstanceListeners(this.div_),this.div_.parentNode.removeChild(this.div_),this.div_=null)},ClusterIcon.prototype.draw=function(){if(this.visible_){var pos=this.getPosFromLatLng_(this.center_);this.div_.style.top=pos.y+"px",this.div_.style.left=pos.x+"px"}},ClusterIcon.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},ClusterIcon.prototype.show=function(){if(this.div_){var img="",bp=this.backgroundPosition_.split(" "),spriteH=parseInt(bp[0].trim(),10),spriteV=parseInt(bp[1].trim(),10),pos=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(pos),img="<img src='"+this.url_+"' style='position: absolute; top: "+spriteV+"px; left: "+spriteH+"px; ",this.cluster_.getMarkerClusterer().enableRetinaIcons_||(img+="clip: rect("+-1*spriteV+"px, "+(-1*spriteH+this.width_)+"px, "+(-1*spriteV+this.height_)+"px, "+-1*spriteH+"px);"),img+="'>",this.div_.innerHTML=img+"<div style='position: absolute;top: "+this.anchorText_[0]+"px;left: "+this.anchorText_[1]+"px;color: "+this.textColor_+";font-size: "+this.textSize_+"px;font-family: "+this.fontFamily_+";font-weight: "+this.fontWeight_+";font-style: "+this.fontStyle_+";text-decoration: "+this.textDecoration_+";text-align: center;width: "+this.width_+"px;line-height:"+this.height_+"px;'>"+this.sums_.text+"</div>","undefined"==typeof this.sums_.title||""===this.sums_.title?this.div_.title=this.cluster_.getMarkerClusterer().getTitle():this.div_.title=this.sums_.title,this.div_.style.display=""}this.visible_=!0},ClusterIcon.prototype.useStyle=function(sums){this.sums_=sums;var index=Math.max(0,sums.index-1);index=Math.min(this.styles_.length-1,index);var style=this.styles_[index];this.url_=style.url,this.height_=style.height,this.width_=style.width,this.anchorText_=style.anchorText||[0,0],this.anchorIcon_=style.anchorIcon||[parseInt(this.height_/2,10),parseInt(this.width_/2,10)],this.textColor_=style.textColor||"black",this.textSize_=style.textSize||11,this.textDecoration_=style.textDecoration||"none",this.fontWeight_=style.fontWeight||"bold",this.fontStyle_=style.fontStyle||"normal",this.fontFamily_=style.fontFamily||"Arial,sans-serif",this.backgroundPosition_=style.backgroundPosition||"0 0"},ClusterIcon.prototype.setCenter=function(center){this.center_=center},ClusterIcon.prototype.createCss=function(pos){var style=[];return style.push("cursor: pointer;"),style.push("position: absolute; top: "+pos.y+"px; left: "+pos.x+"px;"),style.push("width: "+this.width_+"px; height: "+this.height_+"px;"),style.join("")},ClusterIcon.prototype.getPosFromLatLng_=function(latlng){var pos=this.getProjection().fromLatLngToDivPixel(latlng);return pos.x-=this.anchorIcon_[1],pos.y-=this.anchorIcon_[0],pos.x=parseInt(pos.x,10),pos.y=parseInt(pos.y,10),pos},Cluster.prototype.getSize=function(){return this.markers_.length},Cluster.prototype.getMarkers=function(){return this.markers_},Cluster.prototype.getCenter=function(){return this.center_},Cluster.prototype.getMap=function(){return this.map_},Cluster.prototype.getMarkerClusterer=function(){return this.markerClusterer_},Cluster.prototype.getBounds=function(){var i,bounds=new google.maps.LatLngBounds(this.center_,this.center_),markers=this.getMarkers();for(i=0;i<markers.length;i++)bounds.extend(markers[i].getPosition());return bounds},Cluster.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=[],delete this.markers_},Cluster.prototype.addMarker=function(marker){var i,mCount,mz;if(this.isMarkerAlreadyAdded_(marker))return!1;if(this.center_){if(this.averageCenter_){var l=this.markers_.length+1,lat=(this.center_.lat()*(l-1)+marker.getPosition().lat())/l,lng=(this.center_.lng()*(l-1)+marker.getPosition().lng())/l;this.center_=new google.maps.LatLng(lat,lng),this.calculateBounds_()}}else this.center_=marker.getPosition(),this.calculateBounds_();if(marker.isAdded=!0,this.markers_.push(marker),mCount=this.markers_.length,mz=this.markerClusterer_.getMaxZoom(),null!==mz&&this.map_.getZoom()>mz)marker.getMap()!==this.map_&&marker.setMap(this.map_);else if(mCount<this.minClusterSize_)marker.getMap()!==this.map_&&marker.setMap(this.map_);else if(mCount===this.minClusterSize_)for(i=0;mCount>i;i++)this.markers_[i].setMap(null);else marker.setMap(null);return this.updateIcon_(),!0},Cluster.prototype.isMarkerInClusterBounds=function(marker){return this.bounds_.contains(marker.getPosition())},Cluster.prototype.calculateBounds_=function(){var bounds=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(bounds)},Cluster.prototype.updateIcon_=function(){var mCount=this.markers_.length,mz=this.markerClusterer_.getMaxZoom();if(null!==mz&&this.map_.getZoom()>mz)return void this.clusterIcon_.hide();if(mCount<this.minClusterSize_)return void this.clusterIcon_.hide();var numStyles=this.markerClusterer_.getStyles().length,sums=this.markerClusterer_.getCalculator()(this.markers_,numStyles);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.useStyle(sums),this.clusterIcon_.show()},Cluster.prototype.isMarkerAlreadyAdded_=function(marker){var i;if(this.markers_.indexOf)return-1!==this.markers_.indexOf(marker);for(i=0;i<this.markers_.length;i++)if(marker===this.markers_[i])return!0;return!1},MarkerClusterer.prototype.onAdd=function(){var cMarkerClusterer=this;this.activeMap_=this.getMap(),this.ready_=!0,this.repaint(),this.listeners_=[google.maps.event.addListener(this.getMap(),"zoom_changed",function(){cMarkerClusterer.resetViewport_(!1),(this.getZoom()===(this.get("minZoom")||0)||this.getZoom()===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")}),google.maps.event.addListener(this.getMap(),"idle",function(){cMarkerClusterer.redraw_()})]},MarkerClusterer.prototype.onRemove=function(){var i;for(i=0;i<this.markers_.length;i++)this.markers_[i].getMap()!==this.activeMap_&&this.markers_[i].setMap(this.activeMap_);for(i=0;i<this.clusters_.length;i++)this.clusters_[i].remove();for(this.clusters_=[],i=0;i<this.listeners_.length;i++)google.maps.event.removeListener(this.listeners_[i]);this.listeners_=[],this.activeMap_=null,this.ready_=!1},MarkerClusterer.prototype.draw=function(){},MarkerClusterer.prototype.setupStyles_=function(){var i,size;if(!(this.styles_.length>0))for(i=0;i<this.imageSizes_.length;i++)size=this.imageSizes_[i],this.styles_.push({url:this.imagePath_+(i+1)+"."+this.imageExtension_,height:size,width:size})},MarkerClusterer.prototype.fitMapToMarkers=function(){var i,markers=this.getMarkers(),bounds=new google.maps.LatLngBounds;for(i=0;i<markers.length;i++)bounds.extend(markers[i].getPosition());this.getMap().fitBounds(bounds)},MarkerClusterer.prototype.getGridSize=function(){return this.gridSize_},MarkerClusterer.prototype.setGridSize=function(gridSize){this.gridSize_=gridSize},MarkerClusterer.prototype.getMinimumClusterSize=function(){return this.minClusterSize_},MarkerClusterer.prototype.setMinimumClusterSize=function(minimumClusterSize){this.minClusterSize_=minimumClusterSize},MarkerClusterer.prototype.getMaxZoom=function(){return this.maxZoom_},MarkerClusterer.prototype.setMaxZoom=function(maxZoom){this.maxZoom_=maxZoom},MarkerClusterer.prototype.getStyles=function(){return this.styles_},MarkerClusterer.prototype.setStyles=function(styles){this.styles_=styles},MarkerClusterer.prototype.getTitle=function(){return this.title_},MarkerClusterer.prototype.setTitle=function(title){this.title_=title},MarkerClusterer.prototype.getZoomOnClick=function(){return this.zoomOnClick_},MarkerClusterer.prototype.setZoomOnClick=function(zoomOnClick){this.zoomOnClick_=zoomOnClick},MarkerClusterer.prototype.getAverageCenter=function(){return this.averageCenter_},MarkerClusterer.prototype.setAverageCenter=function(averageCenter){this.averageCenter_=averageCenter},MarkerClusterer.prototype.getIgnoreHidden=function(){return this.ignoreHidden_},MarkerClusterer.prototype.setIgnoreHidden=function(ignoreHidden){this.ignoreHidden_=ignoreHidden},MarkerClusterer.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons_},MarkerClusterer.prototype.setEnableRetinaIcons=function(enableRetinaIcons){this.enableRetinaIcons_=enableRetinaIcons},MarkerClusterer.prototype.getImageExtension=function(){return this.imageExtension_},MarkerClusterer.prototype.setImageExtension=function(imageExtension){this.imageExtension_=imageExtension},MarkerClusterer.prototype.getImagePath=function(){return this.imagePath_},MarkerClusterer.prototype.setImagePath=function(imagePath){this.imagePath_=imagePath},MarkerClusterer.prototype.getImageSizes=function(){return this.imageSizes_},MarkerClusterer.prototype.setImageSizes=function(imageSizes){this.imageSizes_=imageSizes},MarkerClusterer.prototype.getCalculator=function(){return this.calculator_},MarkerClusterer.prototype.setCalculator=function(calculator){this.calculator_=calculator},MarkerClusterer.prototype.getBatchSizeIE=function(){return this.batchSizeIE_},MarkerClusterer.prototype.setBatchSizeIE=function(batchSizeIE){this.batchSizeIE_=batchSizeIE},MarkerClusterer.prototype.getClusterClass=function(){return this.clusterClass_},MarkerClusterer.prototype.setClusterClass=function(clusterClass){this.clusterClass_=clusterClass},MarkerClusterer.prototype.getMarkers=function(){return this.markers_},MarkerClusterer.prototype.getTotalMarkers=function(){return this.markers_.length},MarkerClusterer.prototype.getClusters=function(){return this.clusters_},MarkerClusterer.prototype.getTotalClusters=function(){return this.clusters_.length},MarkerClusterer.prototype.addMarker=function(marker,opt_nodraw){this.pushMarkerTo_(marker),opt_nodraw||this.redraw_()},MarkerClusterer.prototype.addMarkers=function(markers,opt_nodraw){var key;for(key in markers)markers.hasOwnProperty(key)&&this.pushMarkerTo_(markers[key]);opt_nodraw||this.redraw_()},MarkerClusterer.prototype.pushMarkerTo_=function(marker){if(marker.getDraggable()){var cMarkerClusterer=this;google.maps.event.addListener(marker,"dragend",function(){cMarkerClusterer.ready_&&(this.isAdded=!1,cMarkerClusterer.repaint())})}marker.isAdded=!1,this.markers_.push(marker)},MarkerClusterer.prototype.removeMarker=function(marker,opt_nodraw){var removed=this.removeMarker_(marker);return!opt_nodraw&&removed&&this.repaint(),removed},MarkerClusterer.prototype.removeMarkers=function(markers,opt_nodraw){var i,r,removed=!1;for(i=0;i<markers.length;i++)r=this.removeMarker_(markers[i]),removed=removed||r;return!opt_nodraw&&removed&&this.repaint(),removed},MarkerClusterer.prototype.removeMarker_=function(marker){var i,index=-1;if(this.markers_.indexOf)index=this.markers_.indexOf(marker);else for(i=0;i<this.markers_.length;i++)if(marker===this.markers_[i]){index=i;break}return-1===index?!1:(marker.setMap(null),this.markers_.splice(index,1),!0)},MarkerClusterer.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=[]},MarkerClusterer.prototype.repaint=function(){var oldClusters=this.clusters_.slice();this.clusters_=[],this.resetViewport_(!1),this.redraw_(),setTimeout(function(){var i;for(i=0;i<oldClusters.length;i++)oldClusters[i].remove()},0)},MarkerClusterer.prototype.getExtendedBounds=function(bounds){var projection=this.getProjection(),tr=new google.maps.LatLng(bounds.getNorthEast().lat(),bounds.getNorthEast().lng()),bl=new google.maps.LatLng(bounds.getSouthWest().lat(),bounds.getSouthWest().lng()),trPix=projection.fromLatLngToDivPixel(tr);trPix.x+=this.gridSize_,trPix.y-=this.gridSize_;var blPix=projection.fromLatLngToDivPixel(bl);blPix.x-=this.gridSize_,blPix.y+=this.gridSize_;var ne=projection.fromDivPixelToLatLng(trPix),sw=projection.fromDivPixelToLatLng(blPix);return bounds.extend(ne),bounds.extend(sw),bounds},MarkerClusterer.prototype.redraw_=function(){this.createClusters_(0)},MarkerClusterer.prototype.resetViewport_=function(opt_hide){var i,marker;for(i=0;i<this.clusters_.length;i++)this.clusters_[i].remove();for(this.clusters_=[],i=0;i<this.markers_.length;i++)marker=this.markers_[i],marker.isAdded=!1,opt_hide&&marker.setMap(null)},MarkerClusterer.prototype.distanceBetweenPoints_=function(p1,p2){var R=6371,dLat=(p2.lat()-p1.lat())*Math.PI/180,dLon=(p2.lng()-p1.lng())*Math.PI/180,a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(p1.lat()*Math.PI/180)*Math.cos(p2.lat()*Math.PI/180)*Math.sin(dLon/2)*Math.sin(dLon/2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c;return d},MarkerClusterer.prototype.isMarkerInBounds_=function(marker,bounds){return bounds.contains(marker.getPosition())},MarkerClusterer.prototype.addToClosestCluster_=function(marker){var i,d,cluster,center,distance=4e4,clusterToAddTo=null;for(i=0;i<this.clusters_.length;i++)cluster=this.clusters_[i],center=cluster.getCenter(),center&&(d=this.distanceBetweenPoints_(center,marker.getPosition()),distance>d&&(distance=d,clusterToAddTo=cluster));clusterToAddTo&&clusterToAddTo.isMarkerInClusterBounds(marker)?clusterToAddTo.addMarker(marker):(cluster=new Cluster(this),cluster.addMarker(marker),this.clusters_.push(cluster))},MarkerClusterer.prototype.createClusters_=function(iFirst){var i,marker,mapBounds,cMarkerClusterer=this;if(this.ready_){0===iFirst&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),mapBounds=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625));var bounds=this.getExtendedBounds(mapBounds),iLast=Math.min(iFirst+this.batchSize_,this.markers_.length);for(i=iFirst;iLast>i;i++)marker=this.markers_[i],!marker.isAdded&&this.isMarkerInBounds_(marker,bounds)&&(!this.ignoreHidden_||this.ignoreHidden_&&marker.getVisible())&&this.addToClosestCluster_(marker);iLast<this.markers_.length?this.timerRefStatic=setTimeout(function(){cMarkerClusterer.createClusters_(iLast)},0):(delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this))}},MarkerClusterer.prototype.extend=function(obj1,obj2){return function(object){var property;for(property in object.prototype)this.prototype[property]=object.prototype[property];return this}.apply(obj1,[obj2])},MarkerClusterer.CALCULATOR=function(markers,numStyles){for(var index=0,title="",count=markers.length.toString(),dv=count;0!==dv;)dv=parseInt(dv/10,10),index++;return index=Math.min(index,numStyles),{text:count,index:index,title:title}},MarkerClusterer.BATCH_SIZE=2e3,MarkerClusterer.BATCH_SIZE_IE=500,MarkerClusterer.IMAGE_PATH="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/images/m",MarkerClusterer.IMAGE_EXTENSION="png",MarkerClusterer.IMAGE_SIZES=[53,56,66,78,90],inherits(MarkerLabel_,google.maps.OverlayView),MarkerLabel_.getSharedCross=function(crossURL){var div;return"undefined"==typeof MarkerLabel_.getSharedCross.crossDiv&&(div=document.createElement("img"),div.style.cssText="position: absolute; z-index: 1000002; display: none;",div.style.marginLeft="-8px",div.style.marginTop="-9px",div.src=crossURL,MarkerLabel_.getSharedCross.crossDiv=div),MarkerLabel_.getSharedCross.crossDiv},MarkerLabel_.prototype.onAdd=function(){var cSavedZIndex,cLatOffset,cLngOffset,cIgnoreClick,cRaiseEnabled,cStartPosition,cStartCenter,me=this,cMouseIsDown=!1,cDraggingLabel=!1,cRaiseOffset=20,cDraggingCursor="url("+this.handCursorURL_+")",cAbortEvent=function(e){e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},cStopBounce=function(){me.marker_.setAnimation(null)};this.getPanes().overlayImage.appendChild(this.labelDiv_),this.getPanes().overlayMouseTarget.appendChild(this.eventDiv_),"undefined"==typeof MarkerLabel_.getSharedCross.processed&&(this.getPanes().overlayImage.appendChild(this.crossDiv_),MarkerLabel_.getSharedCross.processed=!0),this.listeners_=[google.maps.event.addDomListener(this.eventDiv_,"mouseover",function(e){(me.marker_.getDraggable()||me.marker_.getClickable())&&(this.style.cursor="pointer",google.maps.event.trigger(me.marker_,"mouseover",e))}),google.maps.event.addDomListener(this.eventDiv_,"mouseout",function(e){!me.marker_.getDraggable()&&!me.marker_.getClickable()||cDraggingLabel||(this.style.cursor=me.marker_.getCursor(),google.maps.event.trigger(me.marker_,"mouseout",e))}),google.maps.event.addDomListener(this.eventDiv_,"mousedown",function(e){cDraggingLabel=!1,me.marker_.getDraggable()&&(cMouseIsDown=!0,this.style.cursor=cDraggingCursor),(me.marker_.getDraggable()||me.marker_.getClickable())&&(google.maps.event.trigger(me.marker_,"mousedown",e),cAbortEvent(e))}),google.maps.event.addDomListener(document,"mouseup",function(mEvent){var position;if(cMouseIsDown&&(cMouseIsDown=!1,me.eventDiv_.style.cursor="pointer",google.maps.event.trigger(me.marker_,"mouseup",mEvent)),cDraggingLabel){if(cRaiseEnabled){position=me.getProjection().fromLatLngToDivPixel(me.marker_.getPosition()),position.y+=cRaiseOffset,me.marker_.setPosition(me.getProjection().fromDivPixelToLatLng(position));try{me.marker_.setAnimation(google.maps.Animation.BOUNCE),setTimeout(cStopBounce,1406)}catch(e){}}me.crossDiv_.style.display="none",me.marker_.setZIndex(cSavedZIndex),cIgnoreClick=!0,cDraggingLabel=!1,mEvent.latLng=me.marker_.getPosition(),google.maps.event.trigger(me.marker_,"dragend",mEvent)}}),google.maps.event.addListener(me.marker_.getMap(),"mousemove",function(mEvent){var position;cMouseIsDown&&(cDraggingLabel?(mEvent.latLng=new google.maps.LatLng(mEvent.latLng.lat()-cLatOffset,mEvent.latLng.lng()-cLngOffset),position=me.getProjection().fromLatLngToDivPixel(mEvent.latLng),cRaiseEnabled&&(me.crossDiv_.style.left=position.x+"px",me.crossDiv_.style.top=position.y+"px",me.crossDiv_.style.display="",position.y-=cRaiseOffset),me.marker_.setPosition(me.getProjection().fromDivPixelToLatLng(position)),cRaiseEnabled&&(me.eventDiv_.style.top=position.y+cRaiseOffset+"px"),google.maps.event.trigger(me.marker_,"drag",mEvent)):(cLatOffset=mEvent.latLng.lat()-me.marker_.getPosition().lat(),cLngOffset=mEvent.latLng.lng()-me.marker_.getPosition().lng(),cSavedZIndex=me.marker_.getZIndex(),cStartPosition=me.marker_.getPosition(),cStartCenter=me.marker_.getMap().getCenter(),cRaiseEnabled=me.marker_.get("raiseOnDrag"),cDraggingLabel=!0,me.marker_.setZIndex(1e6),mEvent.latLng=me.marker_.getPosition(),google.maps.event.trigger(me.marker_,"dragstart",mEvent)));
}),google.maps.event.addDomListener(document,"keydown",function(e){cDraggingLabel&&27===e.keyCode&&(cRaiseEnabled=!1,me.marker_.setPosition(cStartPosition),me.marker_.getMap().setCenter(cStartCenter),google.maps.event.trigger(document,"mouseup",e))}),google.maps.event.addDomListener(this.eventDiv_,"click",function(e){(me.marker_.getDraggable()||me.marker_.getClickable())&&(cIgnoreClick?cIgnoreClick=!1:(google.maps.event.trigger(me.marker_,"click",e),cAbortEvent(e)))}),google.maps.event.addDomListener(this.eventDiv_,"dblclick",function(e){(me.marker_.getDraggable()||me.marker_.getClickable())&&(google.maps.event.trigger(me.marker_,"dblclick",e),cAbortEvent(e))}),google.maps.event.addListener(this.marker_,"dragstart",function(mEvent){cDraggingLabel||(cRaiseEnabled=this.get("raiseOnDrag"))}),google.maps.event.addListener(this.marker_,"drag",function(mEvent){cDraggingLabel||cRaiseEnabled&&(me.setPosition(cRaiseOffset),me.labelDiv_.style.zIndex=1e6+(this.get("labelInBackground")?-1:1))}),google.maps.event.addListener(this.marker_,"dragend",function(mEvent){cDraggingLabel||cRaiseEnabled&&me.setPosition(0)}),google.maps.event.addListener(this.marker_,"position_changed",function(){me.setPosition()}),google.maps.event.addListener(this.marker_,"zindex_changed",function(){me.setZIndex()}),google.maps.event.addListener(this.marker_,"visible_changed",function(){me.setVisible()}),google.maps.event.addListener(this.marker_,"labelvisible_changed",function(){me.setVisible()}),google.maps.event.addListener(this.marker_,"title_changed",function(){me.setTitle()}),google.maps.event.addListener(this.marker_,"labelcontent_changed",function(){me.setContent()}),google.maps.event.addListener(this.marker_,"labelanchor_changed",function(){me.setAnchor()}),google.maps.event.addListener(this.marker_,"labelclass_changed",function(){me.setStyles()}),google.maps.event.addListener(this.marker_,"labelstyle_changed",function(){me.setStyles()})]},MarkerLabel_.prototype.onRemove=function(){var i;for(this.labelDiv_.parentNode.removeChild(this.labelDiv_),this.eventDiv_.parentNode.removeChild(this.eventDiv_),i=0;i<this.listeners_.length;i++)google.maps.event.removeListener(this.listeners_[i])},MarkerLabel_.prototype.draw=function(){this.setContent(),this.setTitle(),this.setStyles()},MarkerLabel_.prototype.setContent=function(){var content=this.marker_.get("labelContent");"undefined"==typeof content.nodeType?(this.labelDiv_.innerHTML=content,this.eventDiv_.innerHTML=this.labelDiv_.innerHTML):(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(content),content=content.cloneNode(!0),this.eventDiv_.innerHTML="",this.eventDiv_.appendChild(content))},MarkerLabel_.prototype.setTitle=function(){this.eventDiv_.title=this.marker_.getTitle()||""},MarkerLabel_.prototype.setStyles=function(){var i,labelStyle;this.labelDiv_.className=this.marker_.get("labelClass"),this.eventDiv_.className=this.labelDiv_.className,this.labelDiv_.style.cssText="",this.eventDiv_.style.cssText="",labelStyle=this.marker_.get("labelStyle");for(i in labelStyle)labelStyle.hasOwnProperty(i)&&(this.labelDiv_.style[i]=labelStyle[i],this.eventDiv_.style[i]=labelStyle[i]);this.setMandatoryStyles()},MarkerLabel_.prototype.setMandatoryStyles=function(){this.labelDiv_.style.position="absolute",this.labelDiv_.style.overflow="hidden","undefined"!=typeof this.labelDiv_.style.opacity&&""!==this.labelDiv_.style.opacity&&(this.labelDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity='+100*this.labelDiv_.style.opacity+')"',this.labelDiv_.style.filter="alpha(opacity="+100*this.labelDiv_.style.opacity+")"),this.eventDiv_.style.position=this.labelDiv_.style.position,this.eventDiv_.style.overflow=this.labelDiv_.style.overflow,this.eventDiv_.style.opacity=.01,this.eventDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity=1)"',this.eventDiv_.style.filter="alpha(opacity=1)",this.setAnchor(),this.setPosition(),this.setVisible()},MarkerLabel_.prototype.setAnchor=function(){var anchor=this.marker_.get("labelAnchor");this.labelDiv_.style.marginLeft=-anchor.x+"px",this.labelDiv_.style.marginTop=-anchor.y+"px",this.eventDiv_.style.marginLeft=-anchor.x+"px",this.eventDiv_.style.marginTop=-anchor.y+"px"},MarkerLabel_.prototype.setPosition=function(yOffset){var position=this.getProjection().fromLatLngToDivPixel(this.marker_.getPosition());"undefined"==typeof yOffset&&(yOffset=0),this.labelDiv_.style.left=Math.round(position.x)+"px",this.labelDiv_.style.top=Math.round(position.y-yOffset)+"px",this.eventDiv_.style.left=this.labelDiv_.style.left,this.eventDiv_.style.top=this.labelDiv_.style.top,this.setZIndex()},MarkerLabel_.prototype.setZIndex=function(){var zAdjust=this.marker_.get("labelInBackground")?-1:1;"undefined"==typeof this.marker_.getZIndex()?(this.labelDiv_.style.zIndex=parseInt(this.labelDiv_.style.top,10)+zAdjust,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex):(this.labelDiv_.style.zIndex=this.marker_.getZIndex()+zAdjust,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex)},MarkerLabel_.prototype.setVisible=function(){this.marker_.get("labelVisible")?this.labelDiv_.style.display=this.marker_.getVisible()?"block":"none":this.labelDiv_.style.display="none",this.eventDiv_.style.display=this.labelDiv_.style.display},inherits(MarkerWithLabel,google.maps.Marker),MarkerWithLabel.prototype.setMap=function(theMap){google.maps.Marker.prototype.setMap.apply(this,arguments),this.label.setMap(theMap)},RichMarker.prototype=new google.maps.OverlayView,window.RichMarker=RichMarker,RichMarker.prototype.getVisible=function(){return this.get("visible")},RichMarker.prototype.getVisible=RichMarker.prototype.getVisible,RichMarker.prototype.setVisible=function(visible){this.set("visible",visible)},RichMarker.prototype.setVisible=RichMarker.prototype.setVisible,RichMarker.prototype.visible_changed=function(){this.ready_&&(this.markerWrapper_.style.display=this.getVisible()?"":"none",this.draw())},RichMarker.prototype.visible_changed=RichMarker.prototype.visible_changed,RichMarker.prototype.setFlat=function(flat){this.set("flat",!!flat)},RichMarker.prototype.setFlat=RichMarker.prototype.setFlat,RichMarker.prototype.getFlat=function(){return this.get("flat")},RichMarker.prototype.getFlat=RichMarker.prototype.getFlat,RichMarker.prototype.getWidth=function(){return this.get("width")},RichMarker.prototype.getWidth=RichMarker.prototype.getWidth,RichMarker.prototype.getHeight=function(){return this.get("height")},RichMarker.prototype.getHeight=RichMarker.prototype.getHeight,RichMarker.prototype.setShadow=function(shadow){this.set("shadow",shadow),this.flat_changed()},RichMarker.prototype.setShadow=RichMarker.prototype.setShadow,RichMarker.prototype.getShadow=function(){return this.get("shadow")},RichMarker.prototype.getShadow=RichMarker.prototype.getShadow,RichMarker.prototype.flat_changed=function(){this.ready_&&(this.markerWrapper_.style.boxShadow=this.markerWrapper_.style.webkitBoxShadow=this.markerWrapper_.style.MozBoxShadow=this.getFlat()?"":this.getShadow())},RichMarker.prototype.flat_changed=RichMarker.prototype.flat_changed,RichMarker.prototype.setZIndex=function(index){this.set("zIndex",index)},RichMarker.prototype.setZIndex=RichMarker.prototype.setZIndex,RichMarker.prototype.getZIndex=function(){return this.get("zIndex")},RichMarker.prototype.getZIndex=RichMarker.prototype.getZIndex,RichMarker.prototype.zIndex_changed=function(){this.getZIndex()&&this.ready_&&(this.markerWrapper_.style.zIndex=this.getZIndex())},RichMarker.prototype.zIndex_changed=RichMarker.prototype.zIndex_changed,RichMarker.prototype.getDraggable=function(){return this.get("draggable")},RichMarker.prototype.getDraggable=RichMarker.prototype.getDraggable,RichMarker.prototype.setDraggable=function(draggable){this.set("draggable",!!draggable)},RichMarker.prototype.setDraggable=RichMarker.prototype.setDraggable,RichMarker.prototype.draggable_changed=function(){this.ready_&&(this.getDraggable()?this.addDragging_(this.markerWrapper_):this.removeDragListeners_())},RichMarker.prototype.draggable_changed=RichMarker.prototype.draggable_changed,RichMarker.prototype.getPosition=function(){return this.get("position")},RichMarker.prototype.getPosition=RichMarker.prototype.getPosition,RichMarker.prototype.setPosition=function(position){this.set("position",position)},RichMarker.prototype.setPosition=RichMarker.prototype.setPosition,RichMarker.prototype.position_changed=function(){this.draw()},RichMarker.prototype.position_changed=RichMarker.prototype.position_changed,RichMarker.prototype.getAnchor=function(){return this.get("anchor")},RichMarker.prototype.getAnchor=RichMarker.prototype.getAnchor,RichMarker.prototype.setAnchor=function(anchor){this.set("anchor",anchor)},RichMarker.prototype.setAnchor=RichMarker.prototype.setAnchor,RichMarker.prototype.anchor_changed=function(){this.draw()},RichMarker.prototype.anchor_changed=RichMarker.prototype.anchor_changed,RichMarker.prototype.htmlToDocumentFragment_=function(htmlString){var tempDiv=document.createElement("DIV");if(tempDiv.innerHTML=htmlString,1==tempDiv.childNodes.length)return tempDiv.removeChild(tempDiv.firstChild);for(var fragment=document.createDocumentFragment();tempDiv.firstChild;)fragment.appendChild(tempDiv.firstChild);return fragment},RichMarker.prototype.removeChildren_=function(node){if(node)for(var child;child=node.firstChild;)node.removeChild(child)},RichMarker.prototype.setContent=function(content){this.set("content",content)},RichMarker.prototype.setContent=RichMarker.prototype.setContent,RichMarker.prototype.getContent=function(){return this.get("content")},RichMarker.prototype.getContent=RichMarker.prototype.getContent,RichMarker.prototype.content_changed=function(){if(this.markerContent_){this.removeChildren_(this.markerContent_);var content=this.getContent();if(content){"string"==typeof content&&(content=content.replace(/^\s*([\S\s]*)\b\s*$/,"$1"),content=this.htmlToDocumentFragment_(content)),this.markerContent_.appendChild(content);for(var image,that=this,images=this.markerContent_.getElementsByTagName("IMG"),i=0;image=images[i];i++)google.maps.event.addDomListener(image,"mousedown",function(e){that.getDraggable()&&(e.preventDefault&&e.preventDefault(),e.returnValue=!1)}),google.maps.event.addDomListener(image,"load",function(){that.draw()});google.maps.event.trigger(this,"domready")}this.ready_&&this.draw()}},RichMarker.prototype.content_changed=RichMarker.prototype.content_changed,RichMarker.prototype.setCursor_=function(whichCursor){if(this.ready_){var cursor="";-1!==navigator.userAgent.indexOf("Gecko/")?("dragging"==whichCursor&&(cursor="-moz-grabbing"),"dragready"==whichCursor&&(cursor="-moz-grab"),"draggable"==whichCursor&&(cursor="pointer")):(("dragging"==whichCursor||"dragready"==whichCursor)&&(cursor="move"),"draggable"==whichCursor&&(cursor="pointer")),this.markerWrapper_.style.cursor!=cursor&&(this.markerWrapper_.style.cursor=cursor)}},RichMarker.prototype.startDrag=function(e){if(this.getDraggable()&&!this.dragging_){this.dragging_=!0;var map=this.getMap();this.mapDraggable_=map.get("draggable"),map.set("draggable",!1),this.mouseX_=e.clientX,this.mouseY_=e.clientY,this.setCursor_("dragready"),this.markerWrapper_.style.MozUserSelect="none",this.markerWrapper_.style.KhtmlUserSelect="none",this.markerWrapper_.style.WebkitUserSelect="none",this.markerWrapper_.unselectable="on",this.markerWrapper_.onselectstart=function(){return!1},this.addDraggingListeners_(),google.maps.event.trigger(this,"dragstart")}},RichMarker.prototype.stopDrag=function(){this.getDraggable()&&this.dragging_&&(this.dragging_=!1,this.getMap().set("draggable",this.mapDraggable_),this.mouseX_=this.mouseY_=this.mapDraggable_=null,this.markerWrapper_.style.MozUserSelect="",this.markerWrapper_.style.KhtmlUserSelect="",this.markerWrapper_.style.WebkitUserSelect="",this.markerWrapper_.unselectable="off",this.markerWrapper_.onselectstart=function(){},this.removeDraggingListeners_(),this.setCursor_("draggable"),google.maps.event.trigger(this,"dragend"),this.draw())},RichMarker.prototype.drag=function(e){if(!this.getDraggable()||!this.dragging_)return void this.stopDrag();var dx=this.mouseX_-e.clientX,dy=this.mouseY_-e.clientY;this.mouseX_=e.clientX,this.mouseY_=e.clientY;var left=parseInt(this.markerWrapper_.style.left,10)-dx,top=parseInt(this.markerWrapper_.style.top,10)-dy;this.markerWrapper_.style.left=left+"px",this.markerWrapper_.style.top=top+"px";var offset=this.getOffset_(),point=new google.maps.Point(left-offset.width,top-offset.height),projection=this.getProjection();this.setPosition(projection.fromDivPixelToLatLng(point)),this.setCursor_("dragging"),google.maps.event.trigger(this,"drag")},RichMarker.prototype.removeDragListeners_=function(){this.draggableListener_&&(google.maps.event.removeListener(this.draggableListener_),delete this.draggableListener_),this.setCursor_("")},RichMarker.prototype.addDragging_=function(node){if(node){var that=this;this.draggableListener_=google.maps.event.addDomListener(node,"mousedown",function(e){that.startDrag(e)}),this.setCursor_("draggable")}},RichMarker.prototype.addDraggingListeners_=function(){var that=this;this.markerWrapper_.setCapture?(this.markerWrapper_.setCapture(!0),this.draggingListeners_=[google.maps.event.addDomListener(this.markerWrapper_,"mousemove",function(e){that.drag(e)},!0),google.maps.event.addDomListener(this.markerWrapper_,"mouseup",function(){that.stopDrag(),that.markerWrapper_.releaseCapture()},!0)]):this.draggingListeners_=[google.maps.event.addDomListener(window,"mousemove",function(e){that.drag(e)},!0),google.maps.event.addDomListener(window,"mouseup",function(){that.stopDrag()},!0)]},RichMarker.prototype.removeDraggingListeners_=function(){if(this.draggingListeners_){for(var listener,i=0;listener=this.draggingListeners_[i];i++)google.maps.event.removeListener(listener);this.draggingListeners_.length=0}},RichMarker.prototype.getOffset_=function(){var anchor=this.getAnchor();if("object"==typeof anchor)return anchor;var offset=new google.maps.Size(0,0);if(!this.markerContent_)return offset;var width=this.markerContent_.offsetWidth,height=this.markerContent_.offsetHeight;switch(anchor){case RichMarkerPosition.TOP_LEFT:break;case RichMarkerPosition.TOP:offset.width=-width/2;break;case RichMarkerPosition.TOP_RIGHT:offset.width=-width;break;case RichMarkerPosition.LEFT:offset.height=-height/2;break;case RichMarkerPosition.MIDDLE:offset.width=-width/2,offset.height=-height/2;break;case RichMarkerPosition.RIGHT:offset.width=-width,offset.height=-height/2;break;case RichMarkerPosition.BOTTOM_LEFT:offset.height=-height;break;case RichMarkerPosition.BOTTOM:offset.width=-width/2,offset.height=-height;break;case RichMarkerPosition.BOTTOM_RIGHT:offset.width=-width,offset.height=-height}return offset},RichMarker.prototype.onAdd=function(){if(this.markerWrapper_||(this.markerWrapper_=document.createElement("DIV"),this.markerWrapper_.style.position="absolute"),this.getZIndex()&&(this.markerWrapper_.style.zIndex=this.getZIndex()),this.markerWrapper_.style.display=this.getVisible()?"":"none",!this.markerContent_){this.markerContent_=document.createElement("DIV"),this.markerWrapper_.appendChild(this.markerContent_);var that=this;google.maps.event.addDomListener(this.markerContent_,"click",function(e){google.maps.event.trigger(that,"click")}),google.maps.event.addDomListener(this.markerContent_,"mouseover",function(e){google.maps.event.trigger(that,"mouseover")}),google.maps.event.addDomListener(this.markerContent_,"mouseout",function(e){google.maps.event.trigger(that,"mouseout")})}this.ready_=!0,this.content_changed(),this.flat_changed(),this.draggable_changed();var panes=this.getPanes();panes&&panes.overlayMouseTarget.appendChild(this.markerWrapper_),google.maps.event.trigger(this,"ready")},RichMarker.prototype.onAdd=RichMarker.prototype.onAdd,RichMarker.prototype.draw=function(){if(this.ready_&&!this.dragging_){var projection=this.getProjection();if(projection){var latLng=this.get("position"),pos=projection.fromLatLngToDivPixel(latLng),offset=this.getOffset_();this.markerWrapper_.style.top=pos.y+offset.height+"px",this.markerWrapper_.style.left=pos.x+offset.width+"px";var height=this.markerContent_.offsetHeight,width=this.markerContent_.offsetWidth;width!=this.get("width")&&this.set("width",width),height!=this.get("height")&&this.set("height",height)}}},RichMarker.prototype.draw=RichMarker.prototype.draw,RichMarker.prototype.onRemove=function(){this.markerWrapper_&&this.markerWrapper_.parentNode&&this.markerWrapper_.parentNode.removeChild(this.markerWrapper_),this.removeDragListeners_()},RichMarker.prototype.onRemove=RichMarker.prototype.onRemove;var RichMarkerPosition={TOP_LEFT:1,TOP:2,TOP_RIGHT:3,LEFT:4,MIDDLE:5,RIGHT:6,BOTTOM_LEFT:7,BOTTOM:8,BOTTOM_RIGHT:9};window.RichMarkerPosition=RichMarkerPosition,window.InfoBox=InfoBox,window.Cluster=Cluster,window.ClusterIcon=ClusterIcon,window.MarkerClusterer=MarkerClusterer,window.MarkerLabel_=MarkerLabel_,window.MarkerWithLabel=MarkerWithLabel})}}),function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){angular.module("uiGmapgoogle-maps.wrapped").service("uiGmapDataStructures",function(){return{Graph:__webpack_require__(1).Graph,Queue:__webpack_require__(1).Queue}})},function(module,exports,__webpack_require__){(function(){module.exports={Graph:__webpack_require__(2),Heap:__webpack_require__(3),LinkedList:__webpack_require__(4),Map:__webpack_require__(5),Queue:__webpack_require__(6),RedBlackTree:__webpack_require__(7),Trie:__webpack_require__(8)}}).call(this)},function(module,exports,__webpack_require__){(function(){var Graph,__hasProp={}.hasOwnProperty;Graph=function(){function Graph(){this._nodes={},this.nodeSize=0,this.edgeSize=0}return Graph.prototype.addNode=function(id){return this._nodes[id]?void 0:(this.nodeSize++,this._nodes[id]={_outEdges:{},_inEdges:{}})},Graph.prototype.getNode=function(id){return this._nodes[id]},Graph.prototype.removeNode=function(id){var inEdgeId,nodeToRemove,outEdgeId,_ref,_ref1;if(nodeToRemove=this._nodes[id]){_ref=nodeToRemove._outEdges;for(outEdgeId in _ref)__hasProp.call(_ref,outEdgeId)&&this.removeEdge(id,outEdgeId);_ref1=nodeToRemove._inEdges;for(inEdgeId in _ref1)__hasProp.call(_ref1,inEdgeId)&&this.removeEdge(inEdgeId,id);return this.nodeSize--,delete this._nodes[id],nodeToRemove}},Graph.prototype.addEdge=function(fromId,toId,weight){var edgeToAdd,fromNode,toNode;return null==weight&&(weight=1),!this.getEdge(fromId,toId)&&(fromNode=this._nodes[fromId],toNode=this._nodes[toId],fromNode&&toNode)?(edgeToAdd={weight:weight},fromNode._outEdges[toId]=edgeToAdd,toNode._inEdges[fromId]=edgeToAdd,this.edgeSize++,edgeToAdd):void 0},Graph.prototype.getEdge=function(fromId,toId){var fromNode,toNode;return fromNode=this._nodes[fromId],toNode=this._nodes[toId],fromNode&&toNode?fromNode._outEdges[toId]:void 0},Graph.prototype.removeEdge=function(fromId,toId){var edgeToDelete,fromNode,toNode;return fromNode=this._nodes[fromId],toNode=this._nodes[toId],(edgeToDelete=this.getEdge(fromId,toId))?(delete fromNode._outEdges[toId],delete toNode._inEdges[fromId],this.edgeSize--,edgeToDelete):void 0},Graph.prototype.getInEdgesOf=function(nodeId){var fromId,inEdges,toNode,_ref;toNode=this._nodes[nodeId],inEdges=[],_ref=null!=toNode?toNode._inEdges:void 0;for(fromId in _ref)__hasProp.call(_ref,fromId)&&inEdges.push(this.getEdge(fromId,nodeId));return inEdges},Graph.prototype.getOutEdgesOf=function(nodeId){var fromNode,outEdges,toId,_ref;fromNode=this._nodes[nodeId],outEdges=[],_ref=null!=fromNode?fromNode._outEdges:void 0;for(toId in _ref)__hasProp.call(_ref,toId)&&outEdges.push(this.getEdge(nodeId,toId));return outEdges},Graph.prototype.getAllEdgesOf=function(nodeId){var i,inEdges,outEdges,selfEdge,_i,_ref,_ref1;if(inEdges=this.getInEdgesOf(nodeId),outEdges=this.getOutEdgesOf(nodeId),0===inEdges.length)return outEdges;for(selfEdge=this.getEdge(nodeId,nodeId),i=_i=0,_ref=inEdges.length;_ref>=0?_ref>_i:_i>_ref;i=_ref>=0?++_i:--_i)if(inEdges[i]===selfEdge){_ref1=[inEdges[inEdges.length-1],inEdges[i]],inEdges[i]=_ref1[0],inEdges[inEdges.length-1]=_ref1[1],inEdges.pop();break}return inEdges.concat(outEdges)},Graph.prototype.forEachNode=function(operation){var nodeId,nodeObject,_ref;_ref=this._nodes;for(nodeId in _ref)__hasProp.call(_ref,nodeId)&&(nodeObject=_ref[nodeId],operation(nodeObject,nodeId))},Graph.prototype.forEachEdge=function(operation){var edgeObject,nodeId,nodeObject,toId,_ref,_ref1;_ref=this._nodes;for(nodeId in _ref)if(__hasProp.call(_ref,nodeId)){nodeObject=_ref[nodeId],_ref1=nodeObject._outEdges;for(toId in _ref1)__hasProp.call(_ref1,toId)&&(edgeObject=_ref1[toId],operation(edgeObject))}},Graph}(),module.exports=Graph}).call(this)},function(module,exports,__webpack_require__){(function(){var Heap,_leftChild,_parent,_rightChild;Heap=function(){function Heap(dataToHeapify){var i,item,_i,_j,_len,_ref;for(null==dataToHeapify&&(dataToHeapify=[]),this._data=[void 0],_i=0,_len=dataToHeapify.length;_len>_i;_i++)item=dataToHeapify[_i],null!=item&&this._data.push(item);if(this._data.length>1)for(i=_j=2,_ref=this._data.length;_ref>=2?_ref>_j:_j>_ref;i=_ref>=2?++_j:--_j)this._upHeap(i);this.size=this._data.length-1}return Heap.prototype.add=function(value){return null!=value?(this._data.push(value),this._upHeap(this._data.length-1),this.size++,value):void 0},Heap.prototype.removeMin=function(){var min;if(1!==this._data.length)return this.size--,2===this._data.length?this._data.pop():(min=this._data[1],this._data[1]=this._data.pop(),this._downHeap(),min)},Heap.prototype.peekMin=function(){return this._data[1]},Heap.prototype._upHeap=function(index){var valueHolder,_ref;for(valueHolder=this._data[index];this._data[index]<this._data[_parent(index)]&&index>1;)_ref=[this._data[_parent(index)],this._data[index]],this._data[index]=_ref[0],this._data[_parent(index)]=_ref[1],index=_parent(index)},Heap.prototype._downHeap=function(){var currentIndex,smallerChildIndex,_ref;for(currentIndex=1;_leftChild(currentIndex<this._data.length)&&(smallerChildIndex=_leftChild(currentIndex),smallerChildIndex<this._data.length-1&&this._data[_rightChild(currentIndex)]<this._data[smallerChildIndex]&&(smallerChildIndex=_rightChild(currentIndex)),this._data[smallerChildIndex]<this._data[currentIndex]);)_ref=[this._data[currentIndex],this._data[smallerChildIndex]],this._data[smallerChildIndex]=_ref[0],this._data[currentIndex]=_ref[1],currentIndex=smallerChildIndex},Heap}(),_parent=function(index){return index>>1},_leftChild=function(index){return index<<1},_rightChild=function(index){return(index<<1)+1},module.exports=Heap}).call(this)},function(module,exports,__webpack_require__){(function(){var LinkedList;LinkedList=function(){function LinkedList(valuesToAdd){var value,_i,_len;for(null==valuesToAdd&&(valuesToAdd=[]),this.head={prev:void 0,value:void 0,next:void 0},this.tail={prev:void 0,value:void 0,next:void 0},this.size=0,_i=0,_len=valuesToAdd.length;_len>_i;_i++)value=valuesToAdd[_i],this.add(value)}return LinkedList.prototype.at=function(position){var currentNode,i,_i,_j,_ref;if(-this.size<=position&&position<this.size){if(position=this._adjust(position),2*position<this.size)for(currentNode=this.head,i=_i=1;position>=_i;i=_i+=1)currentNode=currentNode.next;else for(currentNode=this.tail,i=_j=1,_ref=this.size-position-1;_ref>=_j;i=_j+=1)currentNode=currentNode.prev;return currentNode}},LinkedList.prototype.add=function(value,position){var currentNode,nodeToAdd,_ref,_ref1,_ref2;return null==position&&(position=this.size),-this.size<=position&&position<=this.size?(nodeToAdd={value:value},position=this._adjust(position),0===this.size?this.head=nodeToAdd:0===position?(_ref=[nodeToAdd,this.head,nodeToAdd],this.head.prev=_ref[0],nodeToAdd.next=_ref[1],this.head=_ref[2]):(currentNode=this.at(position-1),_ref1=[currentNode.next,nodeToAdd,nodeToAdd,currentNode],nodeToAdd.next=_ref1[0],null!=(_ref2=currentNode.next)?_ref2.prev=_ref1[1]:void 0,currentNode.next=_ref1[2],nodeToAdd.prev=_ref1[3]),position===this.size&&(this.tail=nodeToAdd),this.size++,value):void 0},LinkedList.prototype.removeAt=function(position){var currentNode,valueToReturn,_ref;return null==position&&(position=this.size-1),-this.size<=position&&position<this.size&&0!==this.size?(position=this._adjust(position),1===this.size?(valueToReturn=this.head.value,this.head.value=this.tail.value=void 0):0===position?(valueToReturn=this.head.value,this.head=this.head.next,this.head.prev=void 0):(currentNode=this.at(position),valueToReturn=currentNode.value,currentNode.prev.next=currentNode.next,null!=(_ref=currentNode.next)&&(_ref.prev=currentNode.prev),position===this.size-1&&(this.tail=currentNode.prev)),this.size--,valueToReturn):void 0},LinkedList.prototype.remove=function(value){var currentNode;if(null!=value){for(currentNode=this.head;currentNode&&currentNode.value!==value;)currentNode=currentNode.next;if(currentNode)return 1===this.size?this.head.value=this.tail.value=void 0:currentNode===this.head?(this.head=this.head.next,this.head.prev=void 0):currentNode===this.tail?(this.tail=this.tail.prev,this.tail.next=void 0):(currentNode.prev.next=currentNode.next,currentNode.next.prev=currentNode.prev),this.size--,value}},LinkedList.prototype.indexOf=function(value,startingPosition){var currentNode,position;if(null==startingPosition&&(startingPosition=0),null==this.head.value&&!this.head.next||startingPosition>=this.size)return-1;for(startingPosition=Math.max(0,this._adjust(startingPosition)),currentNode=this.at(startingPosition),position=startingPosition;currentNode&&currentNode.value!==value;)currentNode=currentNode.next,position++;return position===this.size?-1:position},LinkedList.prototype._adjust=function(position){return 0>position?this.size+position:position},LinkedList}(),module.exports=LinkedList}).call(this)},function(module,exports,__webpack_require__){(function(){var Map,SPECIAL_TYPE_KEY_PREFIX,_extractDataType,_isSpecialType,__hasProp={}.hasOwnProperty;SPECIAL_TYPE_KEY_PREFIX="_mapId_",Map=function(){function Map(objectToMap){var key,value;this._content={},this._itemId=0,this._id=Map._newMapId(),this.size=0;for(key in objectToMap)__hasProp.call(objectToMap,key)&&(value=objectToMap[key],this.set(key,value))}return Map._mapIdTracker=0,Map._newMapId=function(){return this._mapIdTracker++},Map.prototype.hash=function(key,makeHash){var propertyForMap,type;return null==makeHash&&(makeHash=!1),type=_extractDataType(key),_isSpecialType(key)?(propertyForMap=SPECIAL_TYPE_KEY_PREFIX+this._id,makeHash&&!key[propertyForMap]&&(key[propertyForMap]=this._itemId++),propertyForMap+"_"+key[propertyForMap]):type+"_"+key},Map.prototype.set=function(key,value){return this.has(key)||this.size++,this._content[this.hash(key,!0)]=[value,key],value},Map.prototype.get=function(key){var _ref;return null!=(_ref=this._content[this.hash(key)])?_ref[0]:void 0},Map.prototype.has=function(key){return this.hash(key)in this._content},Map.prototype["delete"]=function(key){var hashedKey;return hashedKey=this.hash(key),hashedKey in this._content?(delete this._content[hashedKey],_isSpecialType(key)&&delete key[SPECIAL_TYPE_KEY_PREFIX+this._id],this.size--,!0):!1},Map.prototype.forEach=function(operation){var key,value,_ref;_ref=this._content;for(key in _ref)__hasProp.call(_ref,key)&&(value=_ref[key],operation(value[1],value[0]))},Map}(),_isSpecialType=function(key){var simpleHashableTypes,simpleType,type,_i,_len;for(simpleHashableTypes=["Boolean","Number","String","Undefined","Null","RegExp","Function"],type=_extractDataType(key),_i=0,_len=simpleHashableTypes.length;_len>_i;_i++)if(simpleType=simpleHashableTypes[_i],type===simpleType)return!1;return!0},_extractDataType=function(type){return Object.prototype.toString.apply(type).match(/\[object (.+)\]/)[1]},module.exports=Map}).call(this)},function(module,exports,__webpack_require__){(function(){var Queue;Queue=function(){function Queue(initialArray){null==initialArray&&(initialArray=[]),this._content=initialArray,this._dequeueIndex=0,this.size=this._content.length}return Queue.prototype.enqueue=function(item){return this.size++,this._content.push(item),item},Queue.prototype.dequeue=function(){var itemToDequeue;if(0!==this.size)return this.size--,itemToDequeue=this._content[this._dequeueIndex],this._dequeueIndex++,2*this._dequeueIndex>this._content.length&&(this._content=this._content.slice(this._dequeueIndex),this._dequeueIndex=0),itemToDequeue},Queue.prototype.peek=function(){return this._content[this._dequeueIndex]},Queue}(),module.exports=Queue}).call(this)},function(module,exports,__webpack_require__){(function(){var BLACK,NODE_FOUND,NODE_TOO_BIG,NODE_TOO_SMALL,RED,RedBlackTree,STOP_SEARCHING,_findNode,_grandParentOf,_isLeft,_leftOrRight,_peekMaxNode,_peekMinNode,_siblingOf,_uncleOf;NODE_FOUND=0,NODE_TOO_BIG=1,NODE_TOO_SMALL=2,STOP_SEARCHING=3,RED=1,BLACK=2,RedBlackTree=function(){function RedBlackTree(valuesToAdd){var value,_i,_len;for(null==valuesToAdd&&(valuesToAdd=[]),this._root,this.size=0,_i=0,_len=valuesToAdd.length;_len>_i;_i++)value=valuesToAdd[_i],null!=value&&this.add(value)}return RedBlackTree.prototype.add=function(value){var currentNode,foundNode,nodeToInsert,_ref;if(null!=value){if(this.size++,nodeToInsert={value:value,_color:RED},this._root){if(foundNode=_findNode(this._root,function(node){return value===node.value?NODE_FOUND:value<node.value?node._left?NODE_TOO_BIG:(nodeToInsert._parent=node,node._left=nodeToInsert,STOP_SEARCHING):node._right?NODE_TOO_SMALL:(nodeToInsert._parent=node,node._right=nodeToInsert,STOP_SEARCHING)}),null!=foundNode)return}else this._root=nodeToInsert;for(currentNode=nodeToInsert;;){if(currentNode===this._root){currentNode._color=BLACK;break}if(currentNode._parent._color===BLACK)break;{if((null!=(_ref=_uncleOf(currentNode))?_ref._color:void 0)!==RED){!_isLeft(currentNode)&&_isLeft(currentNode._parent)?(this._rotateLeft(currentNode._parent),currentNode=currentNode._left):_isLeft(currentNode)&&!_isLeft(currentNode._parent)&&(this._rotateRight(currentNode._parent),currentNode=currentNode._right),currentNode._parent._color=BLACK,_grandParentOf(currentNode)._color=RED,_isLeft(currentNode)?this._rotateRight(_grandParentOf(currentNode)):this._rotateLeft(_grandParentOf(currentNode));break}currentNode._parent._color=BLACK,_uncleOf(currentNode)._color=BLACK,_grandParentOf(currentNode)._color=RED,currentNode=_grandParentOf(currentNode)}}return value}},RedBlackTree.prototype.has=function(value){var foundNode;return foundNode=_findNode(this._root,function(node){return value===node.value?NODE_FOUND:value<node.value?NODE_TOO_BIG:NODE_TOO_SMALL}),foundNode?!0:!1},RedBlackTree.prototype.peekMin=function(){var _ref;return null!=(_ref=_peekMinNode(this._root))?_ref.value:void 0},RedBlackTree.prototype.peekMax=function(){var _ref;return null!=(_ref=_peekMaxNode(this._root))?_ref.value:void 0},RedBlackTree.prototype.remove=function(value){var foundNode;return(foundNode=_findNode(this._root,function(node){return value===node.value?NODE_FOUND:value<node.value?NODE_TOO_BIG:NODE_TOO_SMALL}))?(this._removeNode(this._root,foundNode),this.size--,value):void 0},RedBlackTree.prototype.removeMin=function(){var nodeToRemove,valueToReturn;return(nodeToRemove=_peekMinNode(this._root))?(valueToReturn=nodeToRemove.value,this._removeNode(this._root,nodeToRemove),valueToReturn):void 0},RedBlackTree.prototype.removeMax=function(){var nodeToRemove,valueToReturn;return(nodeToRemove=_peekMaxNode(this._root))?(valueToReturn=nodeToRemove.value,this._removeNode(this._root,nodeToRemove),valueToReturn):void 0},RedBlackTree.prototype._removeNode=function(root,node){
var sibling,successor,_ref,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7;if(node._left&&node._right&&(successor=_peekMinNode(node._right),node.value=successor.value,node=successor),successor=node._left||node._right,successor||(successor={color:BLACK,_right:void 0,_left:void 0,isLeaf:!0}),successor._parent=node._parent,null!=(_ref=node._parent)&&(_ref[_leftOrRight(node)]=successor),node._color===BLACK)if(successor._color===RED)successor._color=BLACK,successor._parent||(this._root=successor);else for(;;){if(!successor._parent){successor.isLeaf?this._root=void 0:this._root=successor;break}if(sibling=_siblingOf(successor),(null!=sibling?sibling._color:void 0)===RED&&(successor._parent._color=RED,sibling._color=BLACK,_isLeft(successor)?this._rotateLeft(successor._parent):this._rotateRight(successor._parent)),sibling=_siblingOf(successor),successor._parent._color!==BLACK||sibling&&(sibling._color!==BLACK||sibling._left&&sibling._left._color!==BLACK||sibling._right&&sibling._right._color!==BLACK)){if(!(successor._parent._color!==RED||sibling&&(sibling._color!==BLACK||sibling._left&&(null!=(_ref1=sibling._left)?_ref1._color:void 0)!==BLACK||sibling._right&&(null!=(_ref2=sibling._right)?_ref2._color:void 0)!==BLACK))){null!=sibling&&(sibling._color=RED),successor._parent._color=BLACK;break}if((null!=sibling?sibling._color:void 0)===BLACK){!_isLeft(successor)||sibling._right&&sibling._right._color!==BLACK||(null!=(_ref3=sibling._left)?_ref3._color:void 0)!==RED?_isLeft(successor)||sibling._left&&sibling._left._color!==BLACK||(null!=(_ref5=sibling._right)?_ref5._color:void 0)!==RED||(sibling._color=RED,null!=(_ref6=sibling._right)&&(_ref6._color=BLACK),this._rotateLeft(sibling)):(sibling._color=RED,null!=(_ref4=sibling._left)&&(_ref4._color=BLACK),this._rotateRight(sibling));break}sibling=_siblingOf(successor),sibling._color=successor._parent._color,_isLeft(successor)?(sibling._right._color=BLACK,this._rotateRight(successor._parent)):(sibling._left._color=BLACK,this._rotateLeft(successor._parent))}else null!=sibling&&(sibling._color=RED),successor.isLeaf&&(successor._parent[_leftOrRight(successor)]=void 0),successor=successor._parent}return successor.isLeaf&&null!=(_ref7=successor._parent)?_ref7[_leftOrRight(successor)]=void 0:void 0},RedBlackTree.prototype._rotateLeft=function(node){var _ref,_ref1;return null!=(_ref=node._parent)&&(_ref[_leftOrRight(node)]=node._right),node._right._parent=node._parent,node._parent=node._right,node._right=node._right._left,node._parent._left=node,null!=(_ref1=node._right)&&(_ref1._parent=node),null==node._parent._parent?this._root=node._parent:void 0},RedBlackTree.prototype._rotateRight=function(node){var _ref,_ref1;return null!=(_ref=node._parent)&&(_ref[_leftOrRight(node)]=node._left),node._left._parent=node._parent,node._parent=node._left,node._left=node._left._right,node._parent._right=node,null!=(_ref1=node._left)&&(_ref1._parent=node),null==node._parent._parent?this._root=node._parent:void 0},RedBlackTree}(),_isLeft=function(node){return node===node._parent._left},_leftOrRight=function(node){return _isLeft(node)?"_left":"_right"},_findNode=function(startingNode,comparator){var comparisonResult,currentNode,foundNode;for(currentNode=startingNode,foundNode=void 0;currentNode;){if(comparisonResult=comparator(currentNode),comparisonResult===NODE_FOUND){foundNode=currentNode;break}if(comparisonResult===NODE_TOO_BIG)currentNode=currentNode._left;else if(comparisonResult===NODE_TOO_SMALL)currentNode=currentNode._right;else if(comparisonResult===STOP_SEARCHING)break}return foundNode},_peekMinNode=function(startingNode){return _findNode(startingNode,function(node){return node._left?NODE_TOO_BIG:NODE_FOUND})},_peekMaxNode=function(startingNode){return _findNode(startingNode,function(node){return node._right?NODE_TOO_SMALL:NODE_FOUND})},_grandParentOf=function(node){var _ref;return null!=(_ref=node._parent)?_ref._parent:void 0},_uncleOf=function(node){return _grandParentOf(node)?_isLeft(node._parent)?_grandParentOf(node)._right:_grandParentOf(node)._left:void 0},_siblingOf=function(node){return _isLeft(node)?node._parent._right:node._parent._left},module.exports=RedBlackTree}).call(this)},function(module,exports,__webpack_require__){(function(){var Queue,Trie,WORD_END,_hasAtLeastNChildren,__hasProp={}.hasOwnProperty;Queue=__webpack_require__(6),WORD_END="end",Trie=function(){function Trie(words){var word,_i,_len;for(null==words&&(words=[]),this._root={},this.size=0,_i=0,_len=words.length;_len>_i;_i++)word=words[_i],this.add(word)}return Trie.prototype.add=function(word){var currentNode,letter,_i,_len;if(null!=word){for(this.size++,currentNode=this._root,_i=0,_len=word.length;_len>_i;_i++)letter=word[_i],null==currentNode[letter]&&(currentNode[letter]={}),currentNode=currentNode[letter];return currentNode[WORD_END]=!0,word}},Trie.prototype.has=function(word){var currentNode,letter,_i,_len;if(null==word)return!1;for(currentNode=this._root,_i=0,_len=word.length;_len>_i;_i++){if(letter=word[_i],null==currentNode[letter])return!1;currentNode=currentNode[letter]}return currentNode[WORD_END]?!0:!1},Trie.prototype.longestPrefixOf=function(word){var currentNode,letter,prefix,_i,_len;if(null==word)return"";for(currentNode=this._root,prefix="",_i=0,_len=word.length;_len>_i&&(letter=word[_i],null!=currentNode[letter]);_i++)prefix+=letter,currentNode=currentNode[letter];return prefix},Trie.prototype.wordsWithPrefix=function(prefix){var accumulatedLetters,currentNode,letter,node,queue,subNode,words,_i,_len,_ref;if(null==prefix)return[];for(null!=prefix||(prefix=""),words=[],currentNode=this._root,_i=0,_len=prefix.length;_len>_i;_i++)if(letter=prefix[_i],currentNode=currentNode[letter],null==currentNode)return[];for(queue=new Queue,queue.enqueue([currentNode,""]);0!==queue.size;){_ref=queue.dequeue(),node=_ref[0],accumulatedLetters=_ref[1],node[WORD_END]&&words.push(prefix+accumulatedLetters);for(letter in node)__hasProp.call(node,letter)&&(subNode=node[letter],queue.enqueue([subNode,accumulatedLetters+letter]))}return words},Trie.prototype.remove=function(word){var currentNode,i,letter,prefix,_i,_j,_len,_ref;if(null!=word){for(currentNode=this._root,prefix=[],_i=0,_len=word.length;_len>_i;_i++){if(letter=word[_i],null==currentNode[letter])return;currentNode=currentNode[letter],prefix.push([letter,currentNode])}if(currentNode[WORD_END]){if(this.size--,delete currentNode[WORD_END],_hasAtLeastNChildren(currentNode,1))return word;for(i=_j=_ref=prefix.length-1;(1>=_ref?1>=_j:_j>=1)&&!_hasAtLeastNChildren(prefix[i][1],1);i=1>=_ref?++_j:--_j)delete prefix[i-1][1][prefix[i][0]];return _hasAtLeastNChildren(this._root[prefix[0][0]],1)||delete this._root[prefix[0][0]],word}}},Trie}(),_hasAtLeastNChildren=function(node,n){var child,childCount;if(0===n)return!0;childCount=0;for(child in node)if(__hasProp.call(node,child)&&(childCount++,childCount>=n))return!0;return!1},module.exports=Trie}).call(this)}]),angular.module("uiGmapgoogle-maps.extensions").service("uiGmapExtendMarkerClusterer",["uiGmapLodash","uiGmapPropMap",function(uiGmapLodash,PropMap){return{init:_.once(function(){(function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};window.NgMapCluster=function(_super){function NgMapCluster(opts){NgMapCluster.__super__.constructor.call(this,opts),this.markers_=new PropMap}return __extends(NgMapCluster,_super),NgMapCluster.prototype.addMarker=function(marker){var mCount,mz;if(this.isMarkerAlreadyAdded_(marker)){var oldMarker=this.markers_.get(marker.key);if(oldMarker.getPosition().lat()==marker.getPosition().lat()&&oldMarker.getPosition().lon()==marker.getPosition().lon())return!1}if(this.center_){if(this.averageCenter_){var l=this.markers_.length+1,lat=(this.center_.lat()*(l-1)+marker.getPosition().lat())/l,lng=(this.center_.lng()*(l-1)+marker.getPosition().lng())/l;this.center_=new google.maps.LatLng(lat,lng),this.calculateBounds_()}}else this.center_=marker.getPosition(),this.calculateBounds_();return marker.isAdded=!0,this.markers_.push(marker),mCount=this.markers_.length,mz=this.markerClusterer_.getMaxZoom(),null!==mz&&this.map_.getZoom()>mz?marker.getMap()!==this.map_&&marker.setMap(this.map_):mCount<this.minClusterSize_?marker.getMap()!==this.map_&&marker.setMap(this.map_):mCount===this.minClusterSize_?this.markers_.each(function(m){m.setMap(null)}):marker.setMap(null),!0},NgMapCluster.prototype.isMarkerAlreadyAdded_=function(marker){return uiGmapLodash.isNullOrUndefined(this.markers_.get(marker.key))},NgMapCluster.prototype.getBounds=function(){var bounds=new google.maps.LatLngBounds(this.center_,this.center_);return this.getMarkers().each(function(m){bounds.extend(m.getPosition())}),bounds},NgMapCluster.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=new PropMap,delete this.markers_},NgMapCluster}(Cluster),window.NgMapMarkerClusterer=function(_super){function NgMapMarkerClusterer(map,opt_markers,opt_options){NgMapMarkerClusterer.__super__.constructor.call(this,map,opt_markers,opt_options),this.markers_=new PropMap}return __extends(NgMapMarkerClusterer,_super),NgMapMarkerClusterer.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=new PropMap},NgMapMarkerClusterer.prototype.removeMarker_=function(marker){return this.markers_.get(marker.key)?(marker.setMap(null),this.markers_.remove(marker.key),!0):!1},NgMapMarkerClusterer.prototype.createClusters_=function(iFirst){var i,marker,mapBounds,cMarkerClusterer=this;if(this.ready_){0===iFirst&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),mapBounds=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625));var bounds=this.getExtendedBounds(mapBounds),iLast=Math.min(iFirst+this.batchSize_,this.markers_.length),_ms=this.markers_.values();for(i=iFirst;iLast>i;i++)marker=_ms[i],!marker.isAdded&&this.isMarkerInBounds_(marker,bounds)&&(!this.ignoreHidden_||this.ignoreHidden_&&marker.getVisible())&&this.addToClosestCluster_(marker);if(iLast<this.markers_.length)this.timerRefStatic=setTimeout(function(){cMarkerClusterer.createClusters_(iLast)},0);else{for(i=0;i<this.clusters_.length;i++)this.clusters_[i].updateIcon_();delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this)}}},NgMapMarkerClusterer.prototype.addToClosestCluster_=function(marker){var i,d,cluster,center,distance=4e4,clusterToAddTo=null;for(i=0;i<this.clusters_.length;i++)cluster=this.clusters_[i],center=cluster.getCenter(),center&&(d=this.distanceBetweenPoints_(center,marker.getPosition()),distance>d&&(distance=d,clusterToAddTo=cluster));clusterToAddTo&&clusterToAddTo.isMarkerInClusterBounds(marker)?clusterToAddTo.addMarker(marker):(cluster=new NgMapCluster(this),cluster.addMarker(marker),this.clusters_.push(cluster))},NgMapMarkerClusterer.prototype.redraw_=function(){this.createClusters_(0)},NgMapMarkerClusterer.prototype.resetViewport_=function(opt_hide){var i;for(i=0;i<this.clusters_.length;i++)this.clusters_[i].remove();this.clusters_=[],this.markers_.each(function(marker){marker.isAdded=!1,opt_hide&&marker.setMap(null)})},NgMapMarkerClusterer.prototype.extend=function(obj1,obj2){return function(object){var property;for(property in object.prototype)"constructor"!==property&&(this.prototype[property]=object.prototype[property]);return this}.apply(obj1,[obj2])},ClusterIcon.prototype.show=function(){if(this.div_){var img="",bp=this.backgroundPosition_.split(" "),spriteH=parseInt(bp[0].trim(),10),spriteV=parseInt(bp[1].trim(),10),pos=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(pos),img="<img src='"+this.url_+"' style='position: absolute; top: "+spriteV+"px; left: "+spriteH+"px; ",img+=this.cluster_.getMarkerClusterer().enableRetinaIcons_?"width: "+this.width_+"px;height: "+this.height_+"px;":"clip: rect("+-1*spriteV+"px, "+(-1*spriteH+this.width_)+"px, "+(-1*spriteV+this.height_)+"px, "+-1*spriteH+"px);",img+="'>",this.div_.innerHTML=img+"<div style='position: absolute;top: "+this.anchorText_[0]+"px;left: "+this.anchorText_[1]+"px;color: "+this.textColor_+";font-size: "+this.textSize_+"px;font-family: "+this.fontFamily_+";font-weight: "+this.fontWeight_+";font-style: "+this.fontStyle_+";text-decoration: "+this.textDecoration_+";text-align: center;width: "+this.width_+"px;line-height:"+this.height_+"px;'>"+this.sums_.text+"</div>","undefined"==typeof this.sums_.title||""===this.sums_.title?this.div_.title=this.cluster_.getMarkerClusterer().getTitle():this.div_.title=this.sums_.title,this.div_.style.display=""}this.visible_=!0},NgMapMarkerClusterer}(MarkerClusterer)}).call(this)})}}])}(window,angular),function(angular,undefined){function compressToBase64(input){if(null==input)return"";var chr1,chr2,chr3,enc1,enc2,enc3,enc4,output="",i=0;for(input=compress(input);i<2*input.length;)i%2==0?(chr1=input.charCodeAt(i/2)>>8,chr2=255&input.charCodeAt(i/2),chr3=i/2+1<input.length?input.charCodeAt(i/2+1)>>8:NaN):(chr1=255&input.charCodeAt((i-1)/2),(i+1)/2<input.length?(chr2=input.charCodeAt((i+1)/2)>>8,chr3=255&input.charCodeAt((i+1)/2)):chr2=chr3=NaN),i+=3,enc1=chr1>>2,enc2=(3&chr1)<<4|chr2>>4,enc3=(15&chr2)<<2|chr3>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+base64Characters[enc1]+base64Characters[enc2]+base64Characters[enc3]+base64Characters[enc4];return output}function decompressFromBase64(input){if(null==input)return"";var chr1,chr2,chr3,enc1,enc2,enc3,enc4,output="",ol=0,output_=null,i=0;for(input=input.replace(/[^A-Za-z0-9\+\/=]/g,"");i<input.length;)enc1=base64Characters.indexOf(input[i++]),enc2=base64Characters.indexOf(input[i++]),enc3=base64Characters.indexOf(input[i++]),enc4=base64Characters.indexOf(input[i++]),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,ol%2==0?(output_=chr1<<8,64!=enc3&&(output+=String.fromCharCode(output_|chr2)),64!=enc4&&(output_=chr3<<8)):(output+=String.fromCharCode(output_|chr1),64!=enc3&&(output_=chr2<<8),64!=enc4&&(output+=String.fromCharCode(output_|chr3))),ol+=3;return decompress(output)}function compressToUTF16(input){if(null==input)return"";var i,c,output="",current=0,status=0;for(input=compress(input),i=0;i<input.length;i++)switch(c=input.charCodeAt(i),status){case 0:output+=String.fromCharCode((c>>1)+32),current=(1&c)<<14,status++;break;case 14:output+=String.fromCharCode(current+(c>>15)+32,(32767&c)+32),status=0;break;default:output+=String.fromCharCode(current+(c>>status+1)+32),current=(c&(2<<status)-1)<<14-status,status++}return output+String.fromCharCode(current+32)}function decompressFromUTF16(input){if(null==input)return"";for(var c,output="",current=0,i=0;i<input.length;i++)c=input.charCodeAt(i)-32,0!==(15&i)&&(output+=String.fromCharCode(current|c>>15-(15&i))),current=(c&(1<<15-(15&i))-1)<<(i+1&15);return decompress(output)}function compressToUint8Array(uncompressed){for(var compressed=compress(uncompressed),buf=new Uint8Array(2*compressed.length),i=0,TotalLen=compressed.length;TotalLen>i;i++){var current_value=compressed.charCodeAt(i);buf[2*i]=current_value>>>8,buf[2*i+1]=current_value%256}return buf}function decompressFromUint8Array(compressed){if(null===compressed||compressed===undefined)return decompress(compressed);for(var buf=new Array(compressed.length/2),i=0,TotalLen=buf.length;TotalLen>i;i++)buf[i]=256*compressed[2*i]+compressed[2*i+1];var result="";return buf.forEach(function(c){result+=String.fromCharCode(c)}),decompress(result)}function compressToEncodedURIComponent(uncompressed){return compressToBase64(uncompressed).replace(/=/g,"$").replace(/\//g,"-")}function decompressFromEncodedURIComponent(compressed){return compressed&&(compressed=compressed.replace(/$/g,"=").replace(/-/g,"/")),decompressFromBase64(compressed)}function writeBit(value,data){data.val=data.val<<1|value,15==data.position?(data.position=0,data.string+=String.fromCharCode(data.val),data.val=0):data.position++}function writeBits(numBits,value,data){"string"==typeof value&&(value=value.charCodeAt(0));for(var i=0;numBits>i;i++)writeBit(1&value,data),value>>=1}function produceW(context){context.dictionaryToCreate[context.w]?(context.w.charCodeAt(0)<256?(writeBits(context.numBits,0,context.data),writeBits(8,context.w,context.data)):(writeBits(context.numBits,1,context.data),writeBits(16,context.w,context.data)),decrementEnlargeIn(context),delete context.dictionaryToCreate[context.w]):writeBits(context.numBits,context.dictionary[context.w],context.data),decrementEnlargeIn(context)}function decrementEnlargeIn(context){context.enlargeIn--,0==context.enlargeIn&&(context.enlargeIn=Math.pow(2,context.numBits),context.numBits++)}function compress(uncompressed){if(null===uncompressed||uncompressed===undefined)return"";var i,context={dictionary:{},dictionaryToCreate:{},c:"",wc:"",w:"",enlargeIn:2,dictSize:3,numBits:2,result:"",data:{string:"",val:0,position:0}};for(i=0;i<uncompressed.length;i+=1)context.c=uncompressed.charAt(i),context.dictionary[context.c]||(context.dictionary[context.c]=context.dictSize++,context.dictionaryToCreate[context.c]=!0),context.wc=context.w+context.c,context.dictionary[context.wc]?context.w=context.wc:(produceW(context),context.dictionary[context.wc]=context.dictSize++,context.w=String(context.c));for(""!==context.w&&produceW(context),writeBits(context.numBits,2,context.data);;){if(context.data.val=context.data.val<<1,15==context.data.position){context.data.string+=String.fromCharCode(context.data.val);break}context.data.position++}return context.data.string}function readBit(data){var res=data.val&data.position;return data.position>>=1,0==data.position&&(data.position=32768,data.val=data.string.charCodeAt(data.index++)),res>0?1:0}function readBits(numBits,data){for(var res=0,maxpower=Math.pow(2,numBits),power=1;power!=maxpower;)res|=readBit(data)*power,power<<=1;return res}function decompress(compressed){if(""===compressed)return null;if(null===compressed||compressed===undefined)return"";var next,result,i,w,c,dictionary={},enlargeIn=4,dictSize=4,numBits=3,entry="",errorCount=0,data={string:compressed,val:compressed.charCodeAt(0),position:32768,index:1};for(i=0;3>i;i+=1)dictionary[i]=i;switch(next=readBits(2,data)){case 0:c=String.fromCharCode(readBits(8,data));break;case 1:c=String.fromCharCode(readBits(16,data));break;case 2:return""}for(dictionary[3]=c,w=result=c;;){switch(c=readBits(numBits,data)){case 0:if(errorCount++>1e4)return"Error";c=String.fromCharCode(readBits(8,data)),dictionary[dictSize++]=c,c=dictSize-1,enlargeIn--;break;case 1:c=String.fromCharCode(readBits(16,data)),dictionary[dictSize++]=c,c=dictSize-1,enlargeIn--;break;case 2:return result}if(0==enlargeIn&&(enlargeIn=Math.pow(2,numBits),numBits++),dictionary[c])entry=dictionary[c];else{if(c!==dictSize)return null;entry=w+w.charAt(0)}result+=entry,dictionary[dictSize++]=w+entry.charAt(0),enlargeIn--,w=entry,0==enlargeIn&&(enlargeIn=Math.pow(2,numBits),numBits++)}}var base64Characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";angular.module("lz-string",[]).factory("LZString",function(){return{compressToBase64:compressToBase64,decompressFromBase64:decompressFromBase64,compressToUTF16:compressToUTF16,decompressFromUTF16:decompressFromUTF16,compressToUint8Array:compressToUint8Array,decompressFromUint8Array:decompressFromUint8Array,compressToEncodedURIComponent:compressToEncodedURIComponent,decompressFromEncodedURIComponent:decompressFromEncodedURIComponent,compress:compress,decompress:decompress}})}(angular),angular.module("record_components",["profile_components"]).factory("record_factory",function($http){return{get_record:function(id){var promise=$http.get(base_url+"registry_object/get/"+id+"/core").then(function(response){return response.data});return promise},stat:function(id){var promise=$http.get(base_url+"registry_object/stat/"+id).then(function(response){return response.data});return promise},add_stat:function(id,type,value){var data={type:type,value:value},promise=$http.post(base_url+"registry_object/add_stat/"+id,{data:data}).then(function(response){return response.data});return promise}}}).controller("moveCtrl",function($scope,$log,$modalInstance,id,profile_factory,record_factory){$scope.base_url=base_url,$scope.id=id,angular.isArray($scope.id)?$scope.records=$scope.id:record_factory.get_record($scope.id).then(function(data){$scope.record=data}),$scope.empty=!1,angular.isArray($scope.id)&&0==$scope.id.length&&($scope.empty=!0),$scope.id&&!angular.isArray($scope.id)&&profile_factory.check_is_bookmarked($scope.id).then(function(data){"OK"==data.status?$scope.bookmarked=!0:$scope.bookmarked=!1}),$scope.fetch=function(){$scope.folders={},profile_factory.get_user().then(function(data){"ERROR"==data.status?$scope.loggedin=!1:($scope.loggedin=!0,$scope.user=data,$scope.folders=profile_factory.get_user_folders($scope.user))})},$scope.moveToFolder=function(folder){if($scope.record){var records=[];records.push({id:$scope.record.core.id,slug:$scope.record.core.slug,group:$scope.record.core.group,title:$scope.record.core.title,type:$scope.record.core.type,"class":$scope.record.core["class"],folder:folder,saved_time:parseInt((new Date).getTime()/1e3),last_viewed:parseInt((new Date).getTime()/1e3)})}else if($scope.records){var records=$scope.records;angular.forEach($scope.records,function(record){record.selected=!1,record.folder=folder,record.last_viewed=parseInt((new Date).getTime()/1e3)})}if(records){var action="modify";$scope.bookmarked||(action="add"),profile_factory.modify_user_data("saved_record",action,records).then(function(data){"OK"==data.status?($scope.success_msg="Records successfully saved",$scope.fetch()):($scope.error_msg="An error has occured while saving "+records.length+" to folder "+folder,$log.debug(data))})}},$scope.unBookmark=function(id){var records=[];records.push({id:id}),profile_factory.modify_user_data("saved_record","delete",records).then(function(data){"OK"==data.status&&$modalInstance.close()})},$scope.inFolder=function(id,folder){var ret=!1;return $scope.user&&angular.forEach($scope.user.user_data.saved_record,function(rec){rec.id==id&&folder==rec.folder&&(ret=!0)}),ret},$scope.inRecordsFolder=function(records,folder){var ret=!0;return angular.forEach(records,function(r){r.folder!=folder&&(ret=!1)}),ret},$scope.dismiss=function(){$modalInstance.dismiss()},$scope.getCurrentURL=function(){return encodeURIComponent(window.location.href)},$scope.fetch()}).controller("exportCtrl",function($scope,$log,$modalInstance,id,record_factory){$scope.id=id,$scope.empty=!1,angular.isArray($scope.id)&&0==$scope.id.length&&($scope.empty=!0),angular.isArray($scope.id)?$scope.records=$scope.id:record_factory.get_record($scope.id).then(function(data){$scope.record=data}),$scope["export"]=function(type){var id=0,link="";if($scope.record)id=$scope.record.id;else if($scope.records){var ids=[];angular.forEach($scope.records,function(record){ids.push(record.id)}),id=ids.join("-")}return"endnote"==type?link=registry_url+"registry_object/exportToEndnote/"+id+".ris?foo="+Math.floor(Date.now()/1e3):"endnote_web"==type&&(link="http://www.myendnoteweb.com/?func=directExport&partnerName=ResearchDataAustralia&dataIdentifier=1&dataRequestUrl="+registry_url+"registry_object/exportToEndnote/"+id+".ris?foo="+Math.floor(Date.now()/1e3)),link},$scope.dismiss=function(){$modalInstance.dismiss()}}).controller("saveSearchCtrl",function($scope,$log,$modalInstance,saved_search_data,profile_factory){$scope.data=saved_search_data,$scope.base_url=base_url,$scope.saveSearch=function(){ngdata=[],ngdata.push($scope.data),profile_factory.add_user_data("saved_search",ngdata).then(function(data){"OK"==data.status?$scope.success_msg="Save Search has been successful":($scope.error_msg="An error has occured while saving this search",$log.debug(data))})},profile_factory.get_user().then(function(data){"ERROR"==data.status?$scope.loggedin=!1:($scope.loggedin=!0,$scope.user=data)}),$scope.dismiss=function(){$modalInstance.dismiss()},$scope.getCurrentURL=function(){return encodeURIComponent(window.location.href)}}),angular.module("profile_components",[]).factory("profile_factory",function($http){return{check_is_bookmarked:function(id){return $http.get(base_url+"profile/is_bookmarked/"+id).then(function(response){return response.data})},add_user_data:function(type,data){var promise=$http.post(base_url+"profile/modify_user_data/"+type+"/add",{data:data}).then(function(response){return response.data});return promise},modify_user_data:function(type,action,data){var promise=$http.post(base_url+"profile/modify_user_data/"+type+"/"+action,{data:data}).then(function(response){return response.data});return promise},get_user:function(){var promise=$http.get(base_url+"profile/current_user").then(function(response){return response.data});return promise},get_specific_user:function(roleid){var promise=$http.get(base_url+"profile/get_specific_user/?identifier="+roleid).then(function(response){return response.data});return promise},get_user_folders:function(user){return folders={},folders.all=0,user.user_data&&user.user_data.saved_record&&(folders.all=Object.keys(user.user_data.saved_record).length,angular.forEach(user.user_data.saved_record,function(record){record.folder&&(void 0==folders[record.folder]?folders[record.folder]=1:folders[record.folder]=folders[record.folder]+1)})),folders},get_user_available_actions:function(){var actions={saved_record_group:["move","delete","export"],saved_record:["open","move","delete","export"],saved_search_group:["refresh","delete"],saved_search:["refresh","delete"]};return actions}}});var app=angular.module("app",["ngRoute","ngSanitize","portal-filters","ui.bootstrap","ui.utils","profile_components","record_components","queryBuilder","lz-string","angular-loading-bar","uiGmapgoogle-maps"]);app.config(function($interpolateProvider,$locationProvider,$logProvider){$interpolateProvider.startSymbol("[["),$interpolateProvider.endSymbol("]]"),$locationProvider.hashPrefix("!"),$logProvider.debugEnabled(!0)}),app.config(function(uiGmapGoogleMapApiProvider){uiGmapGoogleMapApiProvider.configure({v:"3.17",libraries:"weather,drawing,geometry,visualization"})}),angular.module("portal-filters",[]).filter("filter_name",function(){return function(text){switch(text){case"q":return"All Fields";case"cq":return"Advanced Query";case"title":return"Title";case"identifier":return"Identifier";case"related_people":return"Related People";case"related_organisations":return"Related Organisations";case"description":return"Description";case"subject":return"Subject";case"access_rights":return"Access";case"group":return"Data Provider";case"license_class":return"Licence";case"type":return"Type";case"subject_vocab_uri":return"Subject Vocabulary URI";case"anzsrc-for":return"Subjects ANZSRC-FOR";case"anzsrc-seo":return"Subjects ANZSRC-SEO";case"year_from":return"Time Period (from)";case"year_to":return"Time Period (to)";case"funding_scheme":return"Funding Scheme";case"funding_from":return"Funding From";case"funding_to":return"Funding To";case"funders":return"Funder";case"administering_institution":return"Managing Institution";case"institution":return"Institution";case"activity_status":return"Status";case"researcher":return"Researcher";case"related_party_one_id":return"Related Researcher";case"scot":return"Schools of Online Thesaurus";case"pont":return"Powerhouse Museum Object Name Thesaurus";case"psychit":return"Thesaurus of psychological index terms";case"anzsrc":return"ANZSRC";case"apt":return"Australian Pictorial Thesaurus";case"gcmd":return"GCMD Keyword";case"lcsh":return"LCSH";case"keywords":return"Keyword";case"refine":return"Keyword";case"subject_value_resolved":return"Subject";case"commencement_to":return"Commencement To";case"commencement_from":return"Commencement From";case"completion_to":return"Completion To";case"completion_from":return"Completion From";case"spatial":return"Location";default:return text}}}).filter("highlightreadable",function(){return function(text){switch(text){case"identifier_value_search":return"Identifier";case"related_party_one_search":return"Related People";case"related_party_multi_search":return"Related Organisations";case"group_search":return"Data Provider";case"related_info_search":return"Related Data";case"related_activity_search":return"Related Project or Grant";case"related_service_search":return"Related Tool or Service";case"related_info_search":return"Related Resource";case"subject_value_resolved_search":return"Subject";case"description_value":return"Description";case"date_to":return"Dates";case"date_to":return"Dates";case"date_from":return"Coverage";case"citation_info_search":return"Citation ";default:return text}}}).filter("socialreadable",function(){return function(text){switch(text){case"AUTHENTICATION_SOCIAL_FACEBOOK":return"Facebook";case"AUTHENTICATION_SOCIAL_TWITTER":return"Twitter";case"AUTHENTICATION_SOCIAL_GOOGLE":return"Google";case"AUTHENTICATION_SOCIAL_LINKEDIN":return"LinkedIn"}}}).filter("filter_value",function($sce){return function(text){if(angular.isArray(text)){var html="<ul>";return angular.forEach(text,function(content){html+="<li>"+content+"</li>"}),html+="</ul>",$sce.trustAsHtml(html)}return $sce.trustAsHtml(text)}}).filter("toTitleCase",function($log){return function(str){return str.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})}}).filter("getLabelFor",function($log){return function(value,filter){var ret="";return angular.forEach(filter,function(f){f.value==value&&(ret=f.label)}),ret}}).filter("truncate",function(){return function(text,length,end){return text?(isNaN(length)&&(length=10),void 0===end&&(end="..."),text.length<=length||text.length-end.length<=length?text:String(text).substring(0,length-end.length)+end):void 0}}).filter("text",["$sce",function($sce){return function(text){var tmp=document.createElement("DIV");return tmp.innerHTML=text,tmp.textContent||tmp.innerText||""}}]).filter("extractSentence",function($log){return function(text){var sentences=text.split(/(.*?(?:\.|\?|!))(?: |$)/g);if(sentences){if(sentences.length>0)for(i=0;i<sentences.length;i++)if(sentences[i].indexOf("&lt;b&gt")>-1){var first=sentences[i].trim().charAt(0),last=sentences[i].trim().slice(-1);return first===first.toLowerCase()&&first!==first.toUpperCase()&&(sentences[i]="..."+sentences[i]),"."!=last&&(sentences[i]=sentences[i]+"..."),sentences[i]}var first=sentences[0].trim().charAt(0),last=sentences[0].trim().slice(-1);return first===first.toLowerCase()&&first!==first.toUpperCase()&&(sentences[0]="..."+sentences[0]),"."!=last&&(sentences[0]=sentences[0]+"..."),sentences[0]}var first=text.trim().charAt(0),last=text.trim().slice(-1);return first===first.toLowerCase()&&first!==first.toUpperCase()&&(text="..."+text),"."!=last&&(text+="..."),text}}).filter("trustAsHtml",["$sce",function($sce){return function(text){var decoded=$("<div/>").html(text).text();return $sce.trustAsHtml(decoded)}}]).filter("timeago",function(){return function(time,local,raw){if(!time)return"never";if(local||(local=Date.now()),angular.isDate(time))time=time.getTime();else if("string"==typeof time){var s=time,bits=s.split(/\D/),date=new Date(bits[0],--bits[1],bits[2],bits[3],bits[4]);time=date.getTime()}if(angular.isDate(local)?local=local.getTime():"string"==typeof local&&(local=new Date(local).getTime()),"number"==typeof time&&"number"==typeof local&&!isNaN(time)&&!isNaN(local)){var offset=Math.abs((local-time)/1e3),span=[],MINUTE=60,HOUR=3600,DAY=86400,WEEK=604800,YEAR=31556926,DECADE=315569260;return span=MINUTE>=offset?["",raw?"now":parseInt(offset)+" seconds"]:60*MINUTE>offset?[Math.round(Math.abs(offset/MINUTE)),"min"]:24*HOUR>offset?[Math.round(Math.abs(offset/HOUR)),"hr"]:7*DAY>offset?[Math.round(Math.abs(offset/DAY)),"day"]:52*WEEK>offset?[Math.round(Math.abs(offset/WEEK)),"week"]:10*YEAR>offset?[Math.round(Math.abs(offset/YEAR)),"year"]:100*DECADE>offset?[Math.round(Math.abs(offset/DECADE)),"decade"]:isNaN(offset)?[""]:["","a long time"],
span[1]+=0===span[0]||span[0]>1?"s":"",span=span.join(" "),raw===!0?span:local>=time&&!isNaN(time)?span+" ago":"in "+span}}}).filter("orderObjectBy",function($log){return function(items,field,reverse){var filtered=[];return angular.forEach(items,function(item){filtered.push(item)}),filtered.sort(function(a,b){var asort="string"==typeof a[field]?a[field].toLowerCase():a[field],bsort="string"==typeof b[field]?b[field].toLowerCase():b[field];return asort>bsort?1:-1}),reverse&&filtered.reverse(),filtered}}).filter("sortObjectBy",function($log){return function(items,field,reverse){var sortArray=["open","conditional","restricted","open licence","non-commercial licence","non-derivative licence","restrictive licence","no licence","other","unknown"],filtered=[];return sortArray.forEach(function(element){angular.forEach(items,function(item){item.name==element&&filtered.push(item)})}),filtered}}),app.controller("QueryBuilderCtrl",function($scope,$log,LZString){function htmlEntities(str){return String(str).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function computed(group){if(!group||0==group.rules.length)return"";for(var str="",i=0;i<group.rules.length;i++)""!=group.rules[i].data&&void 0!==group.rules[i]&&(i>0&&(str+=" "+group.operator+" "),str+=group.rules[i].group?computed(group.rules[i].group):"-"==group.rules[i].condition?group.rules[i].data.indexOf(" ")>-1?"-"+group.rules[i].field+":("+group.rules[i].data+")":"-"+group.rules[i].field+":"+group.rules[i].data:group.rules[i].data.indexOf(" ")>-1?group.rules[i].field+""+htmlEntities(group.rules[i].condition)+"("+group.rules[i].data+")":group.rules[i].field+""+htmlEntities(group.rules[i].condition)+group.rules[i].data);return str+""}var data='{"group":{"root": true, "operator":"AND","rules":[{"group":{"operator":"AND","rules":[{"condition":":","field":"_text_","data":"","$$hashKey":"064"},{"condition":":","field":"_text_","data":""}]},"$$hashKey":"05Z"}]}}';$scope.json=null,$scope.filter=JSON.parse(data),$scope.$on("query",function(e,data){$scope.filter=$scope.parse(data)}),$scope.$on("cq",function(e,cqdata){cqdata?$scope.filter=JSON.parse(LZString.decompressFromEncodedURIComponent(cqdata)):$scope.filter=JSON.parse(data)}),$scope.$on("clearSearch",function(e){$scope.filter=JSON.parse(data)}),$scope.parse=function(data){0==data.query.indexOf("(")&&(data.query=data.query.substr(1),data.query=data.query.substr(0,data.query.length-1));var ndata={};return ndata.group={operator:"AND",rules:[]},ndata},$scope.convertType=function(type){switch(type){case"q":return"_text_"}return type},$scope.$watch("filter",function(newValue){$scope.json=JSON.stringify(newValue,null,0),$scope.output=computed(newValue.group),"()"!=$scope.output&&""!=$scope.output&&"(())"!=$scope.output?($scope.$emit("changePreFilter",{type:"cq",value:LZString.compressToEncodedURIComponent($scope.json),execute:!1}),$scope.$emit("changePreQuery",$scope.output)):$scope.$emit("changePreQuery","")},!0)});var queryBuilder=angular.module("queryBuilder",[]);queryBuilder.directive("queryBuilder",["$compile",function($compile,$log,search_factory){return{restrict:"E",scope:{group:"="},templateUrl:base_url+"assets/registry_object/templates/querybuilder.html",compile:function(element,attrs){var content,directive;return content=element.contents().remove(),function(scope,element,attrs){scope.operators=[{name:"AND"},{name:"OR"}],scope.fields=[{name:"_text_",display:"All Fields"},{name:"title_search",display:"Title"},{name:"identifier_value_search",display:"Identifier"},{name:"related_party_one_search",display:"Related People"},{name:"related_party_multi_search",display:"Related Organisation"},{name:"description_value",display:"Description"}],scope.conditions=[{name:":",display:"Contains"},{name:"-",display:"Excludes"}],scope.addCondition=function(){scope.group.rules.push({condition:":",field:"_text_",data:""})},scope.removeCondition=function(index){scope.group.rules.splice(index,1)},scope.addGroup=function(){scope.group.rules.push({group:{operator:"AND",rules:[{condition:":",field:"_text_",data:""}]}})},scope.removeGroup=function(){"group"in scope.$parent&&scope.$parent.group.rules.splice(scope.$parent.$index,1)},directive||(directive=$compile(content)),element.append(directive(scope,function($compile){return $compile}))}}}}]),queryBuilder.filter("getDisplayFor",function($log){return function(value,filter){var ret="";return angular.forEach(filter,function(f){f.name==value&&(ret=f.display)}),ret}}),app.directive("facetSearch",function($http,$log){return{templateUrl:base_url+"assets/registry_object/templates/facetSearch.html",scope:{facets:"=",type:"@"},link:function(scope){scope.$watch("facets",function(newv){newv&&(scope.facet=!1,angular.forEach(newv,function(content,index){scope.facet=content.name==scope.type?content:scope.facet}))}),scope.tipfor=function(text){return text.length>=30?text:"not long enough"},scope.tip=function(){var text="";return"access_rights"==scope.facet.name&&(text="<strong>Open</strong>: Data is publicly accessible online.<br />",text+="<strong>Conditional</strong>: Data is publicly accessible subject to certain conditions. For example:",text+="<ul><li>a fee applies</li><li>the data is only accessible at a specific physical location</li></ul>",text+="<strong>Restricted</strong>: Data access is limited.  For example.<br />",text+="<ul><li>following an embargo period;</li><li>to a particular group of users;</li><li>where formal permission is granted.</li></ul>",text+="<strong>Other</strong>: No value or user defined custom value."),"license_class"==scope.facet.name&&(text="<strong>Open Licence</strong>: A licence bearing broad permissions that may include a requirement to attribute the source, or share-alike (or both), requiring a derivative work to be licensed on the same or similar terms as the reused material.<br />",text+="<strong>Non-commercial Licence</strong>: As for the Open Licence but also restricting reuse only for non-commercial purposes.<br />",text+="<strong>Non-derivative Licence</strong>: As for the Open Licence but also prohibits adaptation of the material, and in the second case also restricts reuse only for non-commercial purposes.<br />",text+="<strong>Restrictive Licence</strong>: A licence preventing reuse of material unless certain restrictive conditions are satisfied. Note licence restrictions, and contact.<br />",text+="<strong>No Licence</strong>: All rights to reuse, communicate, publish or reproduce the material are reserved, with the exception of specific rights contained within the Copyright Act 1968 or similar laws.  Contact the copyright holder for permission to reuse this material.<br />",text+="<strong>Other</strong>: No value or user defined custom value."),"administering_institution"==scope.facet.name&&(text="Please note that adding a Managing Institution filter to your search will restrict your search to only those grants and projects in Research Data Australia which have the managing institution recorded."),"funders"==scope.facet.name&&(text="Please note that adding a funder filter to your search will restrict your search to only those grants and projects in Research Data Australia which have the funder recorded."),"funding_scheme"==scope.facet.name&&(text="Please note that adding a funding scheme filter to your search will restrict your search to only those grants and projects in Research Data Australia which contain funding scheme information."),text},scope.filterExists=scope.$parent.filterExists,scope.isFacet=scope.$parent.isFacet,scope.toggleFilter=scope.$parent.toggleFilter,scope.advanced=function(active){scope.$emit("advanced",active)},scope.hashChange=scope.$parent.hashChange}}}),app.directive("facetinfo",function($log){return{template:'<i class="fa fa-info" tip="{{info}}" ng-if="info"></i>',scope:{infotype:"=",infovalue:"="},transclude:!0,link:function(scope){var values={access_rights:{open:"Data is publicly accessible online.",conditional:"Data is publicly accessible subject to certain conditions. For example: <br/>- a fee applies<br/>- the data is only accessible at a specific physical location.",restricted:"Data access is limited. For example: <br/>- following an embargo period<br/>- to a particular group of users<br/>- where formal permission is granted.",other:"no value or user defined custom value"},license_class:{"open licence":"A licence bearing broad permissions that may include a requirement to attribute the source, or share-alike (or both), requiring a derivative work to be licensed on the same or similar terms as the reused material.","non-commercial licence":"As for the Open Licence but also restricting reuse only for non-commercial purposes.","non-derivative licence":"As for the Open Licence but also prohibits adaptation of the material, and in the second case also restricts reuse only for non-commercial purposes.","restrictive licence":"A licence preventing reuse of material unless certain restrictive conditions are satisfied. Note licence restrictions, and contact","no licence":"All rights to reuse, communicate, publish or reproduce the material are reserved, with the exception of specific rights contained within the Copyright Act 1968 or similar laws.  Contact the copyright holder for permission to reuse this material.",other:"no value or user defined custom value"}};values[scope.infotype]&&values[scope.infotype][scope.infovalue]&&(scope.info=values[scope.infotype][scope.infovalue])}}}),app.directive("resolve",function($http,$log,vocab_factory){return{template:'<ul class="listy no-bottom"><li ng-repeat="item in result"><a href="" ng-click="toggleFilter(vocab, item.notation, true)">{{item.label | toTitleCase | truncate:30}} <small><i class="fa fa-remove" tip="Remove Item"></i></small></a></li></ul>',scope:{subjects:"=subjects",vocab:"=",prefilter:"@"},transclude:!0,link:function(scope){scope.result=[],scope.$watch("subjects",function(newv){newv&&(scope.result=[],vocab_factory.resolveSubjects(scope.vocab,scope.subjects).then(function(data){angular.forEach(data,function(label,notation){scope.result.push({notation:notation,label:label})})}))}),scope.toggleFilter=function(type,value,execute){scope.prefilter?scope.$emit("togglePreFilter",{type:type,value:value,execute:execute}):scope.$emit("toggleFilter",{type:type,value:value,execute:execute})}}}}),app.directive("resolveRo",function($log,$http,record_factory){return{template:'<span tip="{{title}}">{{title}}</span>',scope:{roid:"="},transclude:!0,link:function(scope){scope.title=scope.roid,record_factory.get_record(scope.roid).then(function(data){data.core&&data.core.title&&(scope.title=data.core.title)})}}}),app.directive("classicon",function($log){return{template:'<i class="{{class}}"></i>',scope:{fclass:"="},transclude:!0,link:function(scope,element){scope.$watch("fclass",function(){"collection"==scope.fclass?scope["class"]="fa fa-folder-open":"service"==scope.fclass?scope["class"]="fa fa-wrench":"party"==scope.fclass?scope["class"]="fa fa-user":"activity"==scope.fclass&&(scope["class"]="fa fa-flask")})}}}),app.directive("mappreview",function($log,uiGmapGoogleMapApi){return{template:'<a href="" ng-click="advanced(\'spatial\')"><img src="{{static_img_src}}"/></a><div></div>',scope:{sbox:"=",centres:"=",polygons:"=",draw:"="},transclude:!0,link:function(scope,element){uiGmapGoogleMapApi.then(function(){function stringToLatLng(str){var word=str.split(",");if(word[0]&&word[1])var lat=word[1],lon=word[0];else var word=str.split(" "),lat=word[1],lon=word[0];var coord=new google.maps.LatLng(parseFloat(lat),parseFloat(lon));return coord}function getBoundsZoomLevel(bounds,mapDim){function latRad(lat){var sin=Math.sin(lat*Math.PI/180),radX2=Math.log((1+sin)/(1-sin))/2;return Math.max(Math.min(radX2,Math.PI),-Math.PI)/2}function zoom(mapPx,worldPx,fraction){return Math.floor(Math.log(mapPx/worldPx/fraction)/Math.LN2)}var WORLD_DIM={height:256,width:256},ZOOM_MAX=21,ne=bounds.getNorthEast(),sw=bounds.getSouthWest(),latFraction=(latRad(ne.lat())-latRad(sw.lat()))/Math.PI,lngDiff=ne.lng()-sw.lng(),lngFraction=(0>lngDiff?lngDiff+360:lngDiff)/360,latZoom=zoom(mapDim.height,WORLD_DIM.height,latFraction),lngZoom=zoom(mapDim.width,WORLD_DIM.width,lngFraction);return Math.min(latZoom,lngZoom,ZOOM_MAX)}if(element&&"map"==scope.draw){var myOptions={zoom:4,center:new google.maps.LatLng(-25.397,133.644),disableDefaultUI:!0,panControl:!0,zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!1,overviewMapControl:!1,scrollwheel:!1,mapTypeId:google.maps.MapTypeId.ROADMAP};$(element).height("200px"),map=new google.maps.Map(element[0],myOptions);var bounds=new google.maps.LatLngBounds;angular.forEach(scope.centres,function(centre){$log.debug("centre",stringToLatLng(centre).toString());new google.maps.Marker({map:map,position:stringToLatLng(centre),draggable:!1,raiseOnDrag:!1,visible:!0})}),angular.forEach(scope.polygons,function(polygon){if($log.debug("polygon",polygon),split=polygon.split(" "),split.length>1)mapContainsOnlyMarkers=!1,coords=[],$.each(split,function(){coord=stringToLatLng(this),coords.push(coord),bounds.extend(coord)}),poly=new google.maps.Polygon({paths:coords,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35}),poly.setMap(map);else{new google.maps.Marker({map:map,position:stringToLatLng(polygon),draggable:!1,raiseOnDrag:!1,visible:!0});bounds.extend(stringToLatLng(polygon))}}),map.fitBounds(bounds),google.maps.event.addListenerOnce(map,"bounds_changed",function(){$log.debug("bound change zoom",map.getZoom())})}else if(element&&"static"==scope.draw){scope.static_img_src="https://maps.googleapis.com/maps/api/staticmap?center=-32.75,144.75&zoom=8&size=328x200&maptype=roadmap&markers=color:red%7C|-32.75,144.75&path=color:0xFFFF0033|fillcolor:0xFFFF0033|weight:5|-32.5,145|-33,145|-33,144.5|-32.5,144.5|-32.5,145";var src="https://maps.googleapis.com/maps/api/staticmap?maptype=roadmap&size=328x200";if(scope.centres&&scope.centres.length>0){var lat,lon;scope.centres[0];angular.forEach(scope.centres,function(centre){var coord=stringToLatLng(centre);lat=coord.lat(),lon=coord.lng()}),src+="&center="+lat+","+lon}var markers=[],bounds=new google.maps.LatLngBounds,polys=[];angular.forEach(scope.polygons,function(polygon){if(split=polygon.split(" "),split.length>1)mapContainsOnlyMarkers=!1,coords=[],$.each(split,function(){coord=stringToLatLng(this),coords.push(coord),bounds.extend(coord)}),poly=new google.maps.Polygon({paths:coords}),polys.push(google.maps.geometry.encoding.encodePath(poly.getPath()));else{var coord=stringToLatLng(polygon);markers.push(coord.lat()+","+coord.lng()),bounds.extend(coord)}}),markers.length>0&&angular.forEach(markers,function(marker){src+="&markers=color:red%7C|"+marker}),polys.length>0&&angular.forEach(polys,function(poly){src+="&path=color:0xFF0000|fillcolor:0xFF000045|weight:2|enc:"+poly});var mapDim={height:200,width:328};src+="&zoom="+getBoundsZoomLevel(bounds,mapDim),scope.static_img_src=src}}),scope.advanced=function(active){scope.$emit("advanced",active)}}}}),app.directive("focusMe",function($timeout,$parse){return{link:function(scope,element,attrs){var model=$parse(attrs.focusMe);scope.$watch(model,function(value){value===!0&&$timeout(function(){element[0].focus()})})}}}),app.factory("vocab_factory",function($http,$log){return{tree:{},subjects:{},get:function(term,filters,vocab){var url="";return term&&(url="?uri="+term),$http.post(base_url+"registry_object/vocab/"+vocab+"/"+url,{filters:filters}).then(function(response){return response.data})},isSelected:function(item,filters){if(!filters.subject_vocab_uri){if(filters.subject){var found=!1;return angular.forEach(this.subjects[filters.subject],function(uri){uri!=item.uri||found||(found=!0)}),found}if(filters["anzsrc-for"]){var found=!1;return filters["anzsrc-for"]==item.notation?found=!0:angular.isArray(filters["anzsrc-for"])?angular.forEach(filters["anzsrc-for"],function(code){code!=item.notation&&0!=item.notation.indexOf(code)||found||(found=!0)}):0==item.notation.indexOf(filters["anzsrc-for"])&&(found=!0),found}if(filters["anzsrc-seo"]){var found=!1;return filters["anzsrc-seo"]==item.notation?found=!0:angular.isArray(filters["anzsrc-seo"])?angular.forEach(filters["anzsrc-seo"],function(code){code!=item.notation&&0!=item.notation.indexOf(code)||found||(found=!0)}):0==item.notation.indexOf(filters["anzsrc-seo"])&&(found=!0),found}return!1}return decodeURIComponent(filters.subject_vocab_uri)==item.uri?!0:void(angular.isArray(filters.subject_vocab_uri)&&angular.forEach(filters.subject_vocab_uri,function(content,index){return content==item.uri?!0:void 0}))},getSubjects:function(){return $http.get(base_url+"registry_object/getSubjects").then(function(response){return response.data})},resolveSubjects:function(vocab,subjects){return $http.post(base_url+"registry_object/resolveSubjects/"+vocab,{data:subjects}).then(function(response){return response.data})}}}),function(){"use strict";function searchController($scope,$log,$modal,search_factory,vocab_factory,uiGmapGoogleMapApi){if($scope.sf=search_factory,$scope.base_url=base_url,$scope.isArray=angular.isArray,$("#ro_id").length){var search_class=$("#ro_class").val();search_factory.update_class(search_class)}$scope.advancedSearchOpen=!1,$scope.class_choices=$scope.sf.class_choices,$scope.vocab="anzsrc-for",$scope.vocab_choices=$scope.sf.vocab_choices,$scope.$watch(function(){return location.hash},function(){var hash=location.hash?location.href.split("#")[1]:"",refer_q=$("#refer_q");hash=refer_q.length?refer_q.val():hash,$scope.filters=search_factory.ingest(hash),angular.copy($scope.filters,$scope.prefilters),$scope.sync(),$scope.filters.cq&&$scope.$broadcast("cq",$scope.filters.cq),($scope.onBrowsePage()||$scope.onSearchPage())&&$scope.search()}),$scope.$on("toggleFilter",function(e,data){$scope.toggleFilter(data.type,data.value,data.execute)}),$scope.$on("togglePreFilter",function(e,data){$scope.togglePreFilter(data.type,data.value,data.execute)}),$scope.$on("advanced",function(e,data){$scope.advanced(data)}),$scope.$on("changeFilter",function(e,data){$scope.changeFilter(data.type,data.value,data.execute)}),$scope.$on("changePreFilter",function(e,data){$scope.prefilters[data.type]=data.value}),$scope.$on("changeQuery",function(e,data){$scope.query=data,$scope.filters.q=data,search_factory.update("query",data),search_factory.update("filters",$scope.filters)}),$scope.$on("changePreQuery",function(e,data){$scope.prefilters.q=data}),$scope.$watch("query",function(newv,oldv){newv!=oldv&&("q"==$scope.search_type?$scope.filters.q=newv:$scope.search_type&&($scope.filters[$scope.search_type]=newv))}),$scope.setSearchType=function(value){$scope.search_type=value},$scope.$watch("search_type",function(newv,oldv){newv&&(delete $scope.filters.q,delete $scope.filters[oldv],$scope.filters[newv]=$scope.query)}),$scope.getLabelFor=function(filter,value){$scope[filter]&&angular.forEach($scope[filter],function(f){return f.value==value?f.label:void 0})},$scope.hasFilter=function(){var has_filter=!1;return angular.forEach($scope.filters,function(val,index){"class"!=index&&"rows"!=index&&"sort"!=index&&""!=val&&(has_filter=!0)}),""!=$scope.query&&(has_filter=!0),has_filter},$scope.filterExists=function(filter){var ret=!1;return $scope.filters[filter]&&(ret=!0),ret},$scope.clearSearch=function(){$scope.query="",search_factory.reset(),$scope.$broadcast("clearSearch"),$scope.sync(),$scope.hashChange(),$("input[name=q]").focus()},$scope.isLoading=function(){return!!(location.href.indexOf("search")>-1&&$scope.loading)},$scope.newSearch=function(query){""!=query&&void 0!=query&&($scope.query=query,$scope.filters.sort="score desc"),$scope.filters.p=1,$scope.hashChange()},$scope.switchToSearch=function(){search_factory.update("filters",$scope.filters);var hash=search_factory.filters_to_hash(search_factory.filters);location.href=base_url+"search/#!/"+hash},$scope.hashChange=function(){"q"==$scope.search_type?$scope.filters.q=$scope.query:$scope.filters[$scope.search_type]=$scope.query,search_factory.update("filters",$scope.filters);var hash=search_factory.filters_to_hash(search_factory.filters);$scope.onSearchPage()?(location.hash="!/"+hash,$(window).scrollTop(0)):$scope.onBrowsePage()?location.hash="!/"+hash:(location.href=base_url+"search/#!/"+hash,$(window).scrollTop(0))},$scope.onSearchPage=function(){var ret=!1;return 0==location.href.indexOf(base_url+"search")&&(ret=!0),ret},$scope.onBrowsePage=function(){var ret=!1;return 0==location.href.indexOf(base_url+"subjects")&&(ret=!0),ret},$scope.search=function(){$scope.loading=!0,"undefined"!=typeof urchin_id&&"undefined"!=typeof ga&&""!=urchin_id&&$scope.filters.q&&""!=$scope.filters.q&&void 0!==$scope.filters.q&&ga("send","pageview","/search_results.php?q="+$scope.filters.q),$scope.onBrowsePage()||$scope.onSearchPage()?search_factory.search($scope.filters).then(function(data){$scope.loading=!1,$scope.fuzzy=data.fuzzy_result,search_factory.update("result",data),search_factory.update("facets",search_factory.construct_facets(data)),$scope.onSearchPage()?$scope.sync():$scope.onBrowsePage()&&$scope.syncSubjectBrowse(),$scope.$broadcast("search_complete"),$scope.populateCenters($scope.result.response.docs)}):$scope.loading=!1},$scope.addKeyWord=function(extra_keywords){$scope.toggleFilter("refine",extra_keywords,!0),$scope.extra_keywords=""},$scope.syncSubjectBrowse=function(){if($scope.filters=search_factory.filters,$scope.query=search_factory.query,$scope.search_type=search_factory.search_type,$scope.result=search_factory.result,$scope.facets=search_factory.facets,$scope.pp=search_factory.pp,$scope.sort=search_factory.sort,$scope.result){$scope.page={cur:$scope.filters.p?parseInt($scope.filters.p):1,rows:$scope.filters.rows?parseInt($scope.filters.rows):15,range:3,pages:[]},$scope.page.end=Math.ceil($scope.result.response.numFound/$scope.page.rows);for(var x=$scope.page.cur-$scope.page.range;x<$scope.page.cur+$scope.page.range+1;x++)x>0&&x<=$scope.page.end&&$scope.page.pages.push(x)}},$scope.sync=function(){if($scope.filters=search_factory.filters,$scope.query=search_factory.query,$scope.search_type=search_factory.search_type,$scope.result=search_factory.result,$scope.facets=search_factory.facets,$scope.pp=search_factory.pp,$scope.sort=search_factory.sort,$scope.advanced_fields=search_factory.advanced_fields,"activity"==$scope.filters["class"]&&($scope.advanced_fields=search_factory.advanced_fields_activity,$scope.sort=search_factory.activity_sort),"activity"==$scope.filters["class"]?$scope.advanced_fields=search_factory.advanced_fields_activity:"collection"==$scope.filters["class"]?$scope.advanced_fields=search_factory.advanced_fields:"party"==$scope.filters["class"]?$scope.advanced_fields=search_factory.advanced_fields_party:"service"==$scope.filters["class"]&&($scope.advanced_fields=search_factory.advanced_fields_service),$scope.result){$scope.page={cur:$scope.filters.p?parseInt($scope.filters.p):1,rows:$scope.filters.rows?parseInt($scope.filters.rows):15,range:3,pages:[]},$scope.page.end=Math.ceil($scope.result.response.numFound/$scope.page.rows);for(var x=$scope.page.cur-$scope.page.range;x<$scope.page.cur+$scope.page.range+1;x++)x>0&&x<=$scope.page.end&&$scope.page.pages.push(x);$scope.temporal_range=search_factory.temporal_range($scope.result),$scope.earliest_year=$scope.temporal_range[0],$scope.latest_year=$scope.temporal_range[$scope.temporal_range.length-1]}if($scope.result){var matchingdoc=[];angular.forEach($scope.result.response.docs,function(doc){doc.matching_identifier_count&&matchingdoc.push(doc)}),angular.forEach(matchingdoc,function(doc){doc.hide||search_factory.get_matching_records(doc.id).then(function(data){doc&&!doc.hide&&(doc.identifiermatch=data.message.identifiermatch,doc&&!doc.hide&&angular.forEach(doc.identifiermatch,function(idd){$scope.hidedoc(idd.registry_object_id)}))})})}$scope.hidedoc=function(id){$scope.result&&angular.forEach($scope.result.response.docs,function(doc){doc.id!=id||doc.hide||(doc.hide=!0)})},($scope.onBrowsePage()||$scope.onSearchPage())&&$scope.vocabInit()},$scope.getHighlight=function(id){return $scope.result.highlighting&&!$.isEmptyObject($scope.result.highlighting[id])?$scope.result.highlighting[id]:!1},$scope.showFilter=function(filter_name,mode){mode&&"undefined"!=mode||(mode="normal");var show=!0;return("cq"==filter_name||"rows"==filter_name||"sort"==filter_name||"p"==filter_name||"class"==filter_name)&&(show=!1),""==$scope.filters[filter_name]&&"normal"==mode&&(show=!1),""==$scope.prefilters[filter_name]&&"advanced"==mode&&(show=!1),show},$scope.toggleFilter=function(type,value,execute){$scope.filters.p=1,$scope.filters[type]?$scope.filters[type]==value?$scope.clearFilter(type,value):-1==$scope.filters[type].indexOf(value)?$scope.addFilter(type,value,!1):$scope.clearFilter(type,value,!1):$scope.addFilter(type,value),$scope.onBrowsePage()?$scope.search():execute&&$scope.hashChange()},$scope.toggleSubject=function(item){angular.forEach($scope.vocab_tree,function(i){-1==item.notation.indexOf(i.notation)&&(i.showsubtree=!1)}),item.subtree?item.showsubtree=!item.showsubtree:($scope.getSubTree(item),item.showsubtree=!0),$scope.filters["anzsrc-for"]!=item.notation&&(delete $scope.filters["anzsrc-for"],$scope.filters["anzsrc-for"]=item.notation,$scope.filters.p=1,$scope.search())},$scope.clearSubjectFilter=function(type,value){if("object"==typeof $scope.filters[type]){var index=$scope.filters[type].indexOf(value);$scope.filters[type].splice(index,1)}},$scope.addSubjectFilter=function(type,value){if($scope.filters[type])if("string"==typeof $scope.filters[type]){var old=$scope.filters[type];$scope.filters[type]=[],$scope.filters[type].push(old),$scope.filters[type].push(value)}else"object"==typeof $scope.filters[type]&&$scope.filters[type].push(value);else $scope.filters[type]=value},$scope.isSubjectSelected=function(notation){var found=!1;return $scope.filters["anzsrc-for"]&&angular.isArray($scope.filters["anzsrc-for"])&&angular.forEach($scope.filters["anzsrc-for"],function(code){found||code!=notation||(found=!0)}),found},$scope.isSubjectParentSelected=function(notation){var found=!1;return $scope.filters["anzsrc-for"]&&angular.isArray($scope.filters["anzsrc-for"])&&angular.forEach($scope.filters["anzsrc-for"],function(code){0==indexOf(code,notation)&&(console.log("found it"),found=!0)}),found},$scope.toggleAccessRights=function(){$scope.filters.access_rights?delete $scope.filters.access_rights:$scope.filters.access_rights="open",$scope.onSearchPage()&&$scope.hashChange()},$scope.addFilter=function(type,value){if($scope.filters[type])if("string"==typeof $scope.filters[type]){var old=$scope.filters[type];$scope.filters[type]=[],$scope.filters[type].push(old),$scope.filters[type].push(value)}else"object"==typeof $scope.filters[type]&&$scope.filters[type].push(value);else $scope.filters[type]=value},$scope.clearFilter=function(type,value,execute){if("object"!=typeof $scope.filters[type])"q"==type?($scope.query="",search_factory.update("query",""),$scope.filters.q="",delete $scope.filters.cq,$scope.$broadcast("cq")):("description"==type||"title"==type||"identifier"==type||"related_people"==type||"related_organisations"==type||"institution"==type||"researcher"==type)&&($scope.query="",search_factory.update("query",""),delete $scope.filters[type],delete $scope.filters.q),delete $scope.filters[type];else if("object"==typeof $scope.filters[type]){var index=$scope.filters[type].indexOf(value);$scope.filters[type].splice(index,1)}execute&&$scope.hashChange()},$scope.isFacet=function(type,value){return $scope.filters[type]?"string"==typeof $scope.filters[type]&&$scope.filters[type]==value?!0:"object"==typeof $scope.filters[type]?-1!=$scope.filters[type].indexOf(value):!1:!1},$scope.showFacet=function(facet){var allowed=[];return allowed="collection"==$scope.filters["class"]?["subjects","group","access_rights","license_class","temporal","spatial"]:"activity"==$scope.filters["class"]?["type","activity_status","subjects","administering_institution","funders","funding_scheme","commencement_to","commencement_from","completion_to","completion_from","funding_amount"]:["type","subjects","group"],allowed.indexOf(facet)>-1},$scope.isPrefilterFacet=function(type,value){return $scope.prefilters[type]?"string"==typeof $scope.prefilters[type]&&$scope.prefilters[type]==value?!0:"object"==typeof $scope.prefilters[type]?-1!=$scope.prefilters[type].indexOf(value):!1:!1},$scope.changeFilter=function(type,value,execute){$scope.filters[type]=value,execute===!0&&$scope.hashChange()},$scope["goto"]=function(x){$scope.filters.p=""+x,$scope.hashChange(),$scope.selected=[],$scope.selectState="selectAll",$("html, body").animate({scrollTop:0},500)},$scope.selected=[],$scope.selectState="selectAll",$scope.toggleResult=function(ro){var exist=!1;$.each($scope.selected,function(i,k){k&&ro.id==k.id&&($scope.selected.splice(i,1),exist=!0)}),exist||$scope.selected.push(ro),$scope.selected.length!=$scope.result.response.docs.length&&($scope.selectState="deselectSelected"),0==$scope.selected.length&&($scope.selectState="selectAll")},$scope.isSelected=function(ro){var ret=!1;return angular.forEach($scope.selected,function(x){ret=ro.id==x.id?!0:ret}),ret},$scope.toggleResults=function(){"selectAll"==$scope.selectState?($.each($scope.result.response.docs,function(){this.select=!0,$scope.selected.push(this)}),$scope.selectState="deselectAll"):("deselectAll"==$scope.selectState||"deselectSelected"==$scope.selectState)&&($scope.selected=[],$.each($scope.result.response.docs,function(){this.select=!1}),$scope.selectState="selectAll")},$scope.add_user_data=function(type){var modalInstance=null;"saved_record"==type?modalInstance=$modal.open({templateUrl:base_url+"assets/registry_object/templates/moveModal.html",controller:"moveCtrl",windowClass:"modal-center",resolve:{id:function(){var selected=[];return angular.forEach($scope.selected,function(i){selected.push({id:i.id,title:i.title,slug:i.slug,group:i.group,"class":$scope.filters["class"],type:i.type,saved_time:parseInt((new Date).getTime()/1e3)})}),selected}}}):"saved_search"==type?modalInstance=$modal.open({templateUrl:base_url+"assets/registry_object/templates/saveSearchModal.html",controller:"saveSearchCtrl",windowClass:"modal-center",resolve:{saved_search_data:function(){return{id:Math.random().toString(36).substring(7),query_title:"",query_string:$scope.sf.filters_to_hash($scope.filters),num_found:$scope.result.response.numFound,num_found_since_last_check:0,num_found_since_saved:0,saved_time:parseInt((new Date).getTime()/1e3),refresh_time:parseInt((new Date).getTime()/1e3),last_ran:parseInt((new Date).getTime()/1e3)}}}}):"export"==type&&(modalInstance=$modal.open({templateUrl:base_url+"assets/registry_object/templates/exportModal.html",controller:"exportCtrl",windowClass:"modal-center",resolve:{id:function(){return $scope.selected}}})),modalInstance.result.then(function(){},function(){})},$scope.prefilters={},$scope.advanced=function(active){angular.copy($scope.filters,$scope.prefilters),active&&"close"!=active?($scope.selectAdvancedField(active),$("#advanced_search").modal("show"),$scope.advancedSearchOpen=!0):"close"==active?($("#advanced_search").modal("hide"),$scope.advancedSearchOpen=!1):($scope.selectAdvancedField("terms"),$("#advanced_search").modal("show"),$scope.advancedSearchOpen=!0),$scope.presearch()},$scope.presearch=function(){search_factory.search_no_record($scope.prefilters).then(function(data){$scope.preresult=data,$scope.prefacets=search_factory.construct_facets($scope.preresult,$scope.prefilters["class"]),$scope.populateCenters($scope.preresult.response.docs),vocab_factory.get(!1,$scope.prefilters,$scope.vocab).then(function(data){$scope.vocab_tree_tmp=data})})},$scope.selectAdvancedField=function(name){angular.forEach($scope.advanced_fields,function(f){f.active=f.name==name}),$scope.prefilters2={},angular.copy($scope.prefilters,$scope.prefilters2),delete $scope.prefilters2[name],search_factory.search_no_record($scope.prefilters2).then(function(data){
$scope.prefacets2=search_factory.construct_facets(data,$scope.prefilters["class"])}),$scope.presearch()},$scope.$watch("prefilters.class",function(newv){var tmp_filter={};tmp_filter["class"]=newv,"activity"==newv?($scope.advanced_fields=search_factory.advanced_fields_activity,$scope.advancedSearchOpen&&search_factory.search_no_record($scope.prefilters).then(function(data){$scope.temporal_range=search_factory.temporal_range(data)})):"collection"==newv?($scope.advanced_fields=search_factory.advanced_fields,$scope.advancedSearchOpen&&search_factory.search_no_record($scope.prefilters).then(function(data){$scope.temporal_range=search_factory.temporal_range(data)})):"party"==newv?$scope.advanced_fields=search_factory.advanced_fields_party:"service"==newv&&($scope.advanced_fields=search_factory.advanced_fields_service),$scope.advancedSearchOpen&&($scope.presearch(),$scope.cleanPrefilters())}),$scope.cleanPrefilters=function(){var cleanOut=["year_from","year_to","group","subject","access_rights","license_class","temporal","spatial","type","group","activity_status","administering_institution","date_range","funders","funding_scheme","funding_amount"];angular.forEach(cleanOut,function(f){delete $scope.prefilters[f]})},$scope.cleanfiltersForSubjectBrowse=function(){$scope.prefilters={},angular.forEach($scope.filters,function(f){"anzsrc-for"!=f&&delete $scope.filters[f]})},$scope.advancedSearch=function(){$scope.filters={},angular.copy($scope.prefilters,$scope.filters),$scope.prefilters.q?($scope.query=$scope.prefilters.q,$scope.filters.sort="score desc"):($scope.query="",$scope.filters.q=""),$scope.filters.p=1,$scope.hashChange(),$("#advanced_search").modal("hide")},$scope.togglePreFilter=function(type,value,execute){$scope.prefilters[type]?$scope.prefilters[type]==value?$scope.clearPreFilter(type,value):-1==$scope.prefilters[type].indexOf(value)?$scope.addPreFilter(type,value):$scope.clearPreFilter(type,value):$scope.addPreFilter(type,value),execute&&$scope.presearch()},$scope.addPreFilter=function(type,value){if($scope.prefilters[type])if("string"==typeof $scope.prefilters[type]){var old=$scope.prefilters[type];$scope.prefilters[type]=[],$scope.prefilters[type].push(old),$scope.prefilters[type].push(value)}else"object"==typeof $scope.prefilters[type]&&$scope.prefilters[type].push(value);else $scope.prefilters[type]=value},$scope.clearPreFilter=function(type,value,execute){if("object"!=typeof $scope.prefilters[type])"q"==type&&($scope.q=""),delete $scope.prefilters[type],$scope.prefilters.cq="",$scope.$broadcast("clearSearch");else if("object"==typeof $scope.prefilters[type]){var index=$scope.prefilters[type].indexOf(value);$scope.prefilters[type].splice(index,1)}execute&&$scope.presearch()},$scope.isAdvancedSearchActive=function(type){var result=!1;if($scope.advanced_fields.length)for(var i=0;i<$scope.advanced_fields.length;i++)if($scope.advanced_fields[i].name==type&&$scope.advanced_fields[i].active)return result=!0,!0;return result},$scope.clearSubject=function(){var fields_array=["anzsrc-for","anzsrc-seo","anzsrc","keywords","scot","pont","psychit","apt","gcmd","lcsh"];angular.forEach(fields_array,function(ss){delete $scope.prefilters[ss]}),$scope.presearch()},$scope.sizeofField=function(type){var ret=0,fields_array=[];if("subject"==type&&(fields_array=["anzsrc-for","anzsrc-seo","anzsrc","keywords","scot","pont","psychit","apt","gcmd","lcsh"],angular.forEach(fields_array,function(ss){ret=$scope.prefilters[ss]?1:ret})),"temporal"==type&&(fields_array=["year_from","year_to"],angular.forEach(fields_array,function(ss){ret=$scope.prefilters[ss]?1:ret})),"date_range"==type&&(fields_array=["commence_from","commence_to","completed_from","completed_to"],angular.forEach(fields_array,function(ss){ret=$scope.prefilters[ss]?1:ret})),"funding_amount"==type&&(fields_array=["funding_from","funding_to"],angular.forEach(fields_array,function(ss){ret=$scope.prefilters[ss]?1:ret})),"terms"==type&&$scope.prefilters.q&&""!=$scope.prefilters.q&&(ret=1),$scope.prefilters[type]){if("object"!=typeof $scope.prefilters[type])ret=1;else if("object"==typeof $scope.prefilters[type])return $scope.prefilters[type].length}else if("review"==type){if($scope.preresult&&$scope.preresult.response)return $scope.preresult.response.numFound;ret=0}return ret},$scope.$watch("vocab",function(newv,oldv){newv!=oldv&&$scope.isAdvancedSearchActive("subject")&&($scope.loading_subjects=!0,vocab_factory.get(!1,$scope.filters,$scope.vocab).then(function(data){$scope.vocab_tree_tmp=data,$scope.loading_subjects=!1}))}),$scope.setVocab=function(v){$scope.vocab=v},$scope.vocabInit=function(){$scope.vocab="anzsrc-for",$scope.onSearchPage()&&vocab_factory.get(!1,$scope.filters,$scope.vocab).then(function(data){$scope.vocab_tree=data,$scope.vocab_tree_tmp=$scope.vocab_tree,$scope.openBranches()}),$scope.onBrowsePage()&&vocab_factory.get(!1,$scope.filters,$scope.vocab).then(function(data){$scope.vocab_tree=data,$scope.openBranches()})},$scope.openBranches=function(){angular.forEach($scope.vocab_tree,function(item){($scope.isVocabSelected(item)||$scope.isVocabParentSelected(item))&&($scope.getSubTree(item),item.showsubtree=!0)})},$scope.getSubTree=function(item){item.showsubtree=!item.showsubtree,item.subtree||"anzsrc-for"!=$scope.vocab&&"anzsrc-seo"!=$scope.vocab||vocab_factory.get(item.uri,$scope.filters,$scope.vocab).then(function(data){item.subtree=data})},$scope.isVocabSelected=function(item,filters){filters||(filters=$scope.filters);var found=vocab_factory.isSelected(item,filters);return found&&(item.pos=1),found},$scope.isVocabParentSelected=function(item){var found=!1;if($scope.filters.subject){var subjects=vocab_factory.subjects;angular.forEach(subjects[$scope.filters.subject],function(uri){-1==uri.indexOf(item.uri)||found||uri==item.uri||(found=!0)})}else $scope.filters["anzsrc-for"]?angular.isArray($scope.filters["anzsrc-for"])?angular.forEach($scope.filters["anzsrc-for"],function(code){0!=code.indexOf(item.notation)||found||code==item.notation||(found=!0)}):0!=$scope.filters["anzsrc-for"].indexOf(item.notation)||found||$scope.filters["anzsrc-for"]==item.notation||(found=!0):$scope.filters["anzsrc-seo"]&&(angular.isArray($scope.filters["anzsrc-seo"])?angular.forEach($scope.filters["anzsrc-seo"],function(code){0!=code.indexOf(item.notation)||found||code==item.notation||(found=!0)}):0!=$scope.filters["anzsrc-seo"].indexOf(item.notation)||found||$scope.filters["anzsrc-seo"]==item.notation||(found=!0));return found&&(item.pos=1),found},$scope.clearMap=function(){$scope.searchBox.setMap(null),$scope.searchBox=null,delete $scope.filters.spatial,$scope.centres=[]},uiGmapGoogleMapApi.then(function(){function bindDrawingManager(map){var polyOption={fillColor:"#ffff00",fillOpacity:.4,strokeWeight:1,clickable:!1,editable:!1,zIndex:1};$scope.drawingManager=new google.maps.drawing.DrawingManager({drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.TOP_CENTER,drawingModes:[google.maps.drawing.OverlayType.RECTANGLE]},circleOptions:polyOption,rectangleOptions:polyOption,polygonOptions:polyOption,polylineOptions:polyOption}),$scope.drawingManager.setMap(map),google.maps.event.addListener($scope.drawingManager,"overlaycomplete",function(e){if(e.type==google.maps.drawing.OverlayType.RECTANGLE){$scope.drawingManager.setDrawingMode(null),$scope.searchBox&&($scope.searchBox.setMap(null),$scope.searchBox=null),$scope.searchBox=e.overlay;var bnds=$scope.searchBox.getBounds(),north=bnds.getNorthEast().lat().toFixed(6),east=bnds.getNorthEast().lng().toFixed(6),south=bnds.getSouthWest().lat().toFixed(6),west=bnds.getSouthWest().lng().toFixed(6);$scope.prefilters.spatial=west+" "+south+" "+east+" "+north,$scope.centres=[],$scope.presearch()}})}$scope.map={center:{latitude:-25.397,longitude:133.644},zoom:4,bounds:{},options:{disableDefaultUI:!1,panControl:!0,navigationControl:!1,scrollwheel:!0,scaleControl:!0},events:{tilesloaded:function(map){$scope.$apply(function(){$scope.mapInstance=map})},bounds_changed:function(map){$scope.$apply(function(){$scope.mapInstance=map})},click:function(map){$scope.$apply(function(){$scope.mapInstance=map})}}},$scope.$watch("mapInstance",function(newv,oldv){if(newv&&!angular.equals(newv,oldv)&&(bindDrawingManager(newv),$scope.filters.spatial)){var wsenArray=$scope.filters.spatial.split(" "),sw=new google.maps.LatLng(wsenArray[1],wsenArray[0]),ne=new google.maps.LatLng(wsenArray[3],wsenArray[2]),rBounds=new google.maps.LatLngBounds(sw,ne);$scope.searchBox&&($scope.searchBox.setMap(null),$scope.searchBox=null),$scope.searchBox=new google.maps.Rectangle({fillColor:"#ffff00",fillOpacity:.4,strokeWeight:1,clickable:!1,editable:!1,zIndex:1,bounds:rBounds}),$scope.searchBox.setMap($scope.mapInstance)}newv&&google.maps.event.trigger($scope.mapInstance,"resize")})}),$scope.centres=[],$scope.populateCenters=function(results){angular.forEach(results,function(doc){if(doc.spatial_coverage_centres){var pair=doc.spatial_coverage_centres[0];if(pair){var split=pair.split(" ");if(1==split.length&&(split=pair.split(",")),split.length>1&&0!=split[0]&&0!=split[1]){var lon=split[0],lat=split[1];lon&&lat&&$scope.centres.push({id:doc.id,title:doc.title,longitude:lon,latitude:lat,showw:!0,onClick:function(){doc.showw=!doc.showw}})}}}}),$scope.mapInstance&&google.maps.event.trigger($scope.mapInstance,"resize")}}angular.module("app").controller("searchCtrl",searchController)}(),function(){"use strict";function searchFactory($http,$log){return{status:"idle",filters:[],query:"",search_type:"q",result:null,facets:null,pp:[{value:15,label:"Show 15"},{value:30,label:"Show 30"},{value:60,label:"Show 60"},{value:100,label:"Show 100"}],search_types:[{value:"q",label:"All Fields"},{value:"title",label:"Title"},{value:"description",label:"Description"},{value:"identifier",label:"Identifier"},{value:"related_people",label:"Related People"},{value:"related_organisations",label:"Related Organisations"}],vocab_choices:[{value:"anzsrc-for",label:"ANZSRC FOR"},{value:"anzsrc-seo",label:"ANZSRC SEO"},{value:"anzsrc",label:"ANZSRC"},{value:"keywords",label:"Keywords"},{value:"scot",label:"School of Online Thesaurus"},{value:"pont",label:"Powerhouse Museum Object Name Thesaurus"},{value:"psychit",label:"Thesaurus of Psychological Index Terms"},{value:"apt",label:"Australian Pictorial Thesaurus"},{value:"lcsh",label:"LCSH"},{value:"gcmd",label:"Global Change Master Directory Keywords"}],search_types_activities:[{value:"q",label:"All Fields"},{value:"title",label:"Title"},{value:"description",label:"Description"},{value:"identifier",label:"Identifier"},{value:"institution",label:"Institution"},{value:"researcher",label:"Researcher"}],available_search_type:["q","title","identifier","related_people","related_organisations","description"],class_choices:[{value:"collection",label:"Data"},{value:"party",label:"People and Organisation"},{value:"service",label:"Services and Tools"},{value:"activity",label:"Grants and Projects"}],default_filters:{rows:15,sort:"list_title_sort asc","class":"collection"},sort:[{value:"score desc",label:"Relevance"},{value:"list_title_sort asc",label:"Title A-Z"},{value:"list_title_sort desc",label:"Title Z-A"},{value:"record_created_timestamp desc",label:'Date Added  <i class="fa fa-sort-amount-desc"></i>'}],activity_sort:[{value:"score desc",label:"Relevance"},{value:"list_title_sort asc",label:"Title A-Z"},{value:"list_title_sort desc",label:"Title Z-A"},{value:"earliest_year asc",label:'Commencement <i class="fa fa-sort-amount-asc"></i>'},{value:"earliest_year desc",label:'Commencement <i class="fa fa-sort-amount-desc"></i>'},{value:"latest_year asc",label:'Completion <i class="fa fa-sort-amount-asc"></i>'},{value:"latest_year desc",label:'Completion <i class="fa fa-sort-amount-desc"></i>'},{value:"funding_amount asc",label:'Funding Amount <i class="fa fa-sort-amount-asc"></i>'},{value:"funding_amount desc",label:'Funding Amount <i class="fa fa-sort-amount-desc"></i>'}],advanced_fields:[{name:"terms",display:"Search Terms",active:!0},{name:"subject",display:"Subject"},{name:"group",display:"Data Provider"},{name:"access_rights",display:"Access"},{name:"license_class",display:"Licence"},{name:"temporal",display:"Time Period"},{name:"spatial",display:"Location"},{name:"review",display:"Review"},{name:"help",display:'<i class="fa fa-question-circle"></i> Help'}],advanced_fields_party:[{name:"terms",display:"Search Terms",active:!0},{name:"type",display:"Type"},{name:"subject",display:"Subject"},{name:"group",display:"Data Provider"},{name:"review",display:"Review"},{name:"help",display:'<i class="fa fa-question-circle"></i> Help'}],advanced_fields_service:[{name:"terms",display:"Search Terms",active:!0},{name:"type",display:"Type"},{name:"subject",display:"Subject"},{name:"group",display:"Data Provider"},{name:"review",display:"Review"},{name:"help",display:'<i class="fa fa-question-circle"></i> Help'}],advanced_fields_activity:[{name:"terms",display:"Search Terms",active:!0},{name:"type",display:"Type"},{name:"activity_status",display:"Status"},{name:"subject",display:"Subject"},{name:"administering_institution",display:"Managing Institution"},{name:"date_range",display:"Date Range"},{name:"funders",display:"Funder"},{name:"funding_scheme",display:"Funding Scheme"},{name:"funding_amount",display:"Funding Amount"},{name:"review",display:"Review"},{name:"help",display:'<i class="fa fa-question-circle"></i> Help'}],collection_facet_order:["group","access_rights","license_class","type"],activity_facet_order:["type","activity_status","funding_scheme","administering_institution","funders"],ingest:function(hash){this.filters=this.filters_from_hash(hash),this.filters.q&&(this.query=this.filters.q);var that=this;return"activity"!=that.filters["class"]?angular.forEach(this.search_types,function(x){var term=x.value;that.filters.hasOwnProperty(term)&&(that.query=that.filters[term],that.search_type=term)}):angular.forEach(this.search_types_activities,function(x){var term=x.value;that.filters.hasOwnProperty(term)&&(that.query=that.filters[term],that.search_type=term)}),this.filters},reset:function(){var prev_class=this.filters["class"];this.filters={q:"","class":prev_class},this.search_type="q",this.query=""},update:function(which,what){this[which]=what},update_class:function(what){this.default_filters["class"]=what},search:function(filters){return filters=this.cleanFilters(filters),$http.post(base_url+"registry_object/filter",{filters:filters}).then(function(response){return response.data.response&&0==response.data.responseHeader.status?response.data:($log.debug(response),!1)})},cleanFilters:function(filters){return angular.forEach(filters,function(value,index){""==value&&delete filters[index]}),filters},search_no_record:function(filters){return $http.post(base_url+"registry_object/filter/true",{filters:filters}).then(function(response){return response.data})},construct_facets:function(result,sclass){var facets=[];result.error&&console.log(result),angular.forEach(result.facet_counts.facet_fields,function(item,index){facets[index]=[];for(var i=0;i<result.facet_counts.facet_fields[index].length;i+=2){var fa={name:result.facet_counts.facet_fields[index][i],value:result.facet_counts.facet_fields[index][i+1]};facets[index].push(fa)}});var order=this.collection_facet_order;"activity"==this.filters["class"]&&(order=this.activity_facet_order),"collection"==sclass?order=this.collection_facet_order:"activity"==sclass&&(order=this.activity_facet_order);var orderedfacets=[];return angular.forEach(order,function(item){orderedfacets.push({name:item,value:facets[item]})}),orderedfacets},temporal_range:function(result){var i,range=[],earliest_year=!1,latest_year=!1,earliest_array=result.facet_counts.facet_fields.earliest_year,latest_array=result.facet_counts.facet_fields.latest_year;for(i=0;i<earliest_array.length-1;i+=2)earliest_year&&parseInt(earliest_array[i])<earliest_year?earliest_year=parseInt(earliest_array[i]):earliest_year&&""!=earliest_year||(earliest_year=parseInt(earliest_array[i]));for(i=0;i<latest_array.length-1;i+=2)latest_year&&parseInt(latest_array[i])>latest_year?latest_year=parseInt(latest_array[i]):latest_year||(latest_year=parseInt(latest_array[i]));if(earliest_year&&latest_year)for(i=parseInt(earliest_year);i<parseInt(latest_year)+1;i++)range.push(i);return range},filters_from_hash:function(hash){var xp=hash.split("/"),filters={};return $.each(xp,function(){var t=this.split("="),term=t[0],value=t[1];if(("rows"==term||"year_from"==term||"year_to"==term&&""!=value.trim())&&(value=parseInt(value)),("funding_from"==term||"funding_to"==term)&&(value=decodeURIComponent(value),value=Number(value.replace(/[^0-9\.-]+/g,""))),"subject_value_resolved"==term&&(value=decodeURIComponent(value)),term&&value&&""!=term&&""!=value)if(filters[term])if("string"==typeof filters[term]){var old=filters[term];filters[term]=[],filters[term].push(old),filters[term].push(decodeURIComponent(value))}else"object"==typeof filters[term]&&filters[term].push(decodeURIComponent(value));else filters[term]=decodeURIComponent(value)}),angular.forEach(this.default_filters,function(content,type){filters[type]||(filters[type]=content)}),location.href.indexOf("grants")>-1&&(filters["class"]="activity"),"activity"==filters["class"]&&location.href.indexOf("search")>-1?$("#banner-image").css("background-image","url('"+base_url+"assets/core/images/activity_banner.jpg')"):location.href.indexOf("search")>-1&&$("#banner-image").css("background-image","url('"+base_url+"assets/core/images/collection_banner.jpg')"),filters},filters_to_hash:function(filters){var hash="";return $.each(filters,function(i,k){"object"!=typeof k?hash+=i+"="+encodeURIComponent(k)+"/":"object"==typeof k&&$.each(k,function(){hash+=i+"="+encodeURIComponent(this)+"/"})}),hash},get_matching_records:function(id){return $http.get(registry_url+"services/api/registry_objects/"+id+"/identifiermatch").then(function(response){return response.data})}}}angular.module("app").factory("search_factory",searchFactory)}();